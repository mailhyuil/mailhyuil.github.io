# db 동시성 제어 lock 비관적 락 & 낙관적 락

## optimistic lock (낙관적 락)

> 충돌이 거의 발생하지 않을 거라고 낙관적으로 생각할 때 사용
>
> > 트랜잭션 상황에서 시작 시 데이터 버전과 끝나는 시점의 데이터 버전이 다른 경우 실패처리
> >
> > > 데이터베이스의 자원을 더 적게 사용하기 때문에 비용이 적게 든다.
> > >
> > > > Application Level에서 구현한다.
> > > >
> > > > > 그러나 충돌이 많이 발생한다면 성능이 저하됨
> > > > >
> > > > > > 롤백 처리를 자체 구현해야 되는 단점
> > > > > >
> > > > > > > 충돌이 발생하면 사용자에게 재시도를 요청하거나 하는 처리 로직이 필요

## pessimistic lock (비관적 락)

> 충돌이 자주 발생할 거라고 비관적으로 생각할 때 사용
>
> > 실제로 다른 트랜잭션이 접근하지 못하도록 락을 걸어놓는다.
> >
> > > 공유락(shared lock, 읽기락), 배타락(exclusive lock, 쓰기락)
> > >
> > > > 데드락이 일어날 가능성이 있고 성능 저하가 있다.
> > > >
> > > > 트랜잭션이 충돌이 자주 발생할 것으로 예상될 때 사용
> > > >
> > > > > 일반 쿼리보다 트랜잭션 쿼리가 속도는 더 빠르다.
