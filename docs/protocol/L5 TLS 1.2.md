# TLS 1.2

> 대칭키 암호화 사용
>
> > 어떤 암호화 방식을 사용할지 서로 협의하는 과정이 필요함
> >
> > > 2 round trip

```sh
# TCP 3-way handshake
SYN
SYN/ACK
ACK
# TLS Handshake (키교환)
Client Hello
Server Hello
Client Fin
Server Fin
# Data Transfer
GET
200 OK
```

# TLS 핸드셰이크

![](/img/ssl.png)

1. Client hello

   > 클라이언트가 서버에게 연락합니다. 브라우저 검색창에 도메인을 입력하는 것으로 보면 됩니다. 이때 클라이언트는 자신의 브라우저가 지원할 수 있는 암호화 방식(Cipher Suite)을 먼저 제시합니다. 그리고 랜덤 데이터를 생성하여 추가로 전송합니다.

2. Server hello

   > 서버가 클라이언트에게 연락합니다. 서버는 클라이언트가 제시한 암호화 방식 중 하나를 선정하여 알려줍니다. 또한, 서버 자신의 인증서를 전달합니다. 이 인증서에는 서버의 공개 키가 포함되어 있습니다. 클라이언트와 마찬가지로 서버 측에서 생성한 랜덤 데이터 또한 전달합니다.

3. Client key exchange

   > 클라이언트는 미리 주고받은 자신과 서버의 랜덤 데이터를 참고하여 서버와 암호화 통신을 할 때 사용할 키를 생성한 후 서버에게 전달합니다. 이때 키는 서버로부터 받은 공개키로 암호화되어 보내집니다.

4. Finished
   > 마지막으로 핸드셰이크 과정이 정상적으로 마무리되면, 클라이언트와 서버 모두 “finished” 메시지를 보냅니다. 그 후부턴 클라이언트가 생성한 키를 이용하여 암호화된 데이터를 주고받게 됩니다.
