# algorithm Rollback

## 순서 보장

> 수행한 순서의 반대로 수행

```txt
1. 유저 생성
2. 포인트 100 지급
3. 이메일 전송

# rollback
1. 이메일 전송 취소
2. 포인트 100 차감
3. 유저 삭제
```

## 멱등성 (idempotency)

> 여러번 롤백이 수행되어도 결과가 같아야 함

## 롤백 실패 시 대응 (error handling)

> DLQ, retry, deadlock..

## 상태 저장

> 되돌린다는 건 되돌릴 기준이 되는 이전 상태가 필요하다는 것
>
> > 이전 상태를 저장해놔야 되돌릴 수 있음
> >
> > snapshot, 트랜잭션 로그 테이블, 이벤트 소싱 등을 통해서 상태를 저장
