"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["501670"],{20360:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>o,toc:()=>d,default:()=>u,metadata:()=>t,assets:()=>c,contentTitle:()=>a});var t=JSON.parse('{"id":"how to implement/\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604","title":"\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604","description":"\uC790\uB3D9 \uB85C\uADF8\uC778 \uCCB4\uD06C\uBC15\uC2A4\uB97C \uCCB4\uD06C \uC5EC\uBD80\uB97C boolean\uC73C\uB85C \uBC1B\uC74C","source":"@site/docs/how to implement/\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604.md","sourceDirName":"how to implement","slug":"/how to implement/\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604","permalink":"/docs/how to implement/\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\uC784\uC2DC \uC800\uC7A5","permalink":"/docs/how to implement/\uC784\uC2DC \uC800\uC7A5"},"next":{"title":"\uC870\uD68C\uC218","permalink":"/docs/how to implement/\uC870\uD68C\uC218"}}'),s=r(447259),i=r(255511);let o={},a="\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604",c={},d=[{value:"prisma",id:"prisma",level:2},{value:"AuthService",id:"authservice",level:2},{value:"AuthGuard",id:"authguard",level:2}];function l(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\uC790\uB3D9-\uB85C\uADF8\uC778-\uC138\uC158-\uAD6C\uD604",children:"\uC790\uB3D9 \uB85C\uADF8\uC778 \uC138\uC158 \uAD6C\uD604"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC790\uB3D9 \uB85C\uADF8\uC778 \uCCB4\uD06C\uBC15\uC2A4\uB97C \uCCB4\uD06C \uC5EC\uBD80\uB97C boolean\uC73C\uB85C \uBC1B\uC74C"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC0AC\uC6A9\uC790 \uB85C\uADF8\uC778\uC774 \uC131\uACF5\uD558\uBA74 \uC790\uB3D9 \uB85C\uADF8\uC778 \uCCB4\uD06C \uC5EC\uBD80\uB97C \uD655\uC778\uD558\uC5EC \uC138\uC158\uC5D0 \uC0AC\uC6A9\uC790 \uC815\uBCF4\uB97C \uC800\uC7A5"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC138\uC158\uAC12, \uCFE0\uD0A4 \uB9CC\uB8CC\uC2DC\uAC04\uC744 \uCFE0\uD0A4\uC5D0 \uB2F4\uC544\uC11C \uD074\uB77C\uC774\uC5B8\uD2B8\uC5D0 \uC804\uB2EC \uBC0F DB\uC5D0 \uC800\uC7A5"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uD074\uB77C\uC774\uC5B8\uD2B8\uB294 \uCFE0\uD0A4\uB97C \uB85C\uCEEC\uC5D0 \uC800\uC7A5"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC0AC\uC6A9\uC790\uAC00 \uB2E4\uC74C\uC5D0 \uD398\uC774\uC9C0\uC5D0 \uC811\uC18D\uD558\uBA74, \uB85C\uCEEC\uC5D0 \uC800\uC7A5\uB41C \uCFE0\uD0A4\uB97C \uC11C\uBC84\uC5D0 \uC804\uB2EC"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC11C\uBC84\uC5D0\uC11C \uC138\uC158\uAC12\uC73C\uB85C \uC720\uC800\uB97C \uC870\uD68C\uD558\uC5EC \uC874\uC7AC\uD558\uBA74 \uB85C\uADF8\uC778 \uCC98\uB9AC"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prisma",children:"prisma"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-prisma",children:"model User {\r\n    id String @id @default(uuid())\r\n    email String @unique\r\n    password String\r\n    name String\r\n\r\n    sessionId String? @unique\r\n\r\n    createdAt DateTime @default(now())\r\n    updatedAt DateTime @updatedAt\r\n    deletedAt DateTime?\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"authservice",children:"AuthService"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export class AuthService {\r\n  constructor(private readonly prisma: PrismaService) {}\r\n  login(data: LoginDto, session: Record<string, any>) {\r\n    const user = this.findByUsername(data.username);\r\n\r\n    /// \uC790\uB3D9 \uB85C\uADF8\uC778 \uC124\uC815\r\n    if (data.autoLogin) {\r\n      session.user = user; // \uC138\uC158\uC5D0 \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC800\uC7A5\r\n      session.cookie.maxAge = 604800000; // \uCFE0\uD0A4 \uB9CC\uB8CC \uC2DC\uAC04 \uC124\uC815 (\uC608: 7\uC77C)\r\n      // DB\uC5D0 \uC138\uC158 \uC815\uBCF4 \uC800\uC7A5\r\n      this.prisma.user.update({\r\n        where: { id: user.id },\r\n        data: { sessionId: session.id },\r\n      });\r\n    }\r\n\r\n    return user;\r\n  }\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"authguard",children:"AuthGuard"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'@Injectable()\r\nexport class AuthGuard implements CanActivate {\r\n  constructor(private readonly authService: AuthService, private readonly jwtService: JwtService) {}\r\n  async canActivate(context: ExecutionContext) {\r\n    const request = context.switchToHttp().getRequest();\r\n    const sessionId = request.cookies["SESSIONID"];\r\n    if (sessionId) {\r\n      const user = await this.authService.findBySessionId(sessionId);\r\n      if (user) {\r\n        request.user = user;\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n}\n'})})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},255511:function(e,n,r){r.d(n,{R:()=>o,x:()=>a});var t=r(596363);let s={},i=t.createContext(s);function o(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);