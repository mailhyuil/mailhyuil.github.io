"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["309475"],{269485:function(n,e,a){a.r(e),a.d(e,{frontMatter:()=>s,toc:()=>d,default:()=>h,metadata:()=>r,assets:()=>l,contentTitle:()=>i});var r=JSON.parse('{"id":"ai langchain/langchain LangGraph graph - workflow","title":"langchain LangGraph graph (workflow)","description":"addNode","source":"@site/docs/ai langchain/langchain LangGraph graph - workflow.md","sourceDirName":"ai langchain","slug":"/ai langchain/langchain LangGraph graph - workflow","permalink":"/docs/ai langchain/langchain LangGraph graph - workflow","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"langchain LangGraph custom agent","permalink":"/docs/ai langchain/langchain LangGraph custom agent"},"next":{"title":"langchain LangGraph","permalink":"/docs/ai langchain/langchain LangGraph"}}'),o=a(447259),t=a(255511);let s={},i="langchain LangGraph graph (workflow)",l={},d=[{value:"addNode",id:"addnode",level:2},{value:"addEdge",id:"addedge",level:2},{value:"addConditionalEdges",id:"addconditionaledges",level:2},{value:"define a new graph",id:"define-a-new-graph",level:2},{value:"use the graph",id:"use-the-graph",level:2}];function c(n){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"langchain-langgraph-graph-workflow",children:"langchain LangGraph graph (workflow)"})}),"\n",(0,o.jsx)(e.h2,{id:"addnode",children:"addNode"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uB178\uB4DC \uD568\uC218 \uCD94\uAC00"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uD2B9\uC218\uD55C \uC561\uC158\uC744 \uC218\uD589\uD558\uAC70\uB098 (tool), \uBAA8\uB378\uC744 \uD638\uCD9C\uD558\uB294 \uD568\uC218\uB97C \uC815\uC758"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"addedge",children:"addEdge"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uC5E3\uC9C0 \uCD94\uAC00"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uC5E3\uC9C0\uB294 \uB178\uB4DC \uAC04\uC758 \uC5F0\uACB0\uC744 \uB098\uD0C0\uB0B4\uBA70, \uB178\uB4DC \uAC04\uC758 \uC774\uB3D9\uC744 \uC81C\uC5B4"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"'agent', 'tools', '__start__', '__end__' \uB4F1\uC758 \uAC12\uC744 \uC0AC\uC6A9\uD574\uC11C \uD2B9\uC815 \uB178\uB4DC\uB85C \uC774\uB3D9"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.code,{children:'import {START, END} from "@langchain/langgraph";'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"addconditionaledges",children:"addConditionalEdges"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uC870\uAC74\uBD80 \uC5E3\uC9C0 \uD568\uC218 \uCD94\uAC00"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uD568\uC218\uB97C \uD1B5\uD574 \uC870\uAC74\uC744 \uB9CC\uC871\uD558\uB294 \uACBD\uC6B0 \uC5E3\uC9C0 \uAC12\uC744 \uBC18\uD658\uD558\uC5EC \uD2B9\uC815 \uB178\uB4DC\uB85C \uC774\uB3D9"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"define-a-new-graph",children:"define a new graph"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:'import { ToolNode } from "@langchain/langgraph/prebuilt";\r\nimport { tool } from "@langchain/core/tools";\r\nimport { ChatOpenAI } from "@langchain/openai";\r\nimport { HumanMessage, AIMessage } from "@langchain/core/messages";\r\nimport { StateGraph, MessagesAnnotation } from "@langchain/langgraph";\r\n\r\nconst sayHi = tool(\r\n  ({ name }: { name: string }): void => {\r\n    console.log(`Hi, ${name}!`);\r\n  },\r\n  {\r\n    name: "sayHi",\r\n    description: "say Hi with user\'s name if provided",\r\n    // input schema\r\n    schema: z.object({\r\n      name: z.string(),\r\n    }),\r\n  },\r\n);\r\n\r\nconst sayGoodbye = tool(\r\n  ({ name }: { name: string }): void => {\r\n    console.log(`Hi, ${name}!`);\r\n  },\r\n  {\r\n    name: "sayGoodbye",\r\n    description: "say goodbye with user\'s name if provided",\r\n    // input schema\r\n    schema: z.object({\r\n      name: z.string(),\r\n    }),\r\n  },\r\n);\r\n\r\n// Define the tools for the agent to use\r\nconst tools = [sayHi, sayGoodbye];\r\nconst toolNode = new ToolNode(tools);\r\n\r\n// Create a model and give it access to the tools\r\nconst model = new ChatOpenAI({\r\n  model: "gpt-4o-mini",\r\n  temperature: 0,\r\n}).bindTools(tools);\r\n\r\n// \uACC4\uC18D\uD560\uC9C0 \uB9D0\uC9C0 \uACB0\uC815\uD558\uB294 \uD568\uC218 \uC815\uC758\r\nfunction shouldContinue({ messages }: typeof MessagesAnnotation.State) {\r\n  const lastMessage = messages[messages.length - 1] as AIMessage;\r\n  // \uB3C4\uAD6C \uD638\uCD9C\uC774 \uC788\uC73C\uBA74 "tools" \uB178\uB4DC\uB85C \uB77C\uC6B0\uD305\r\n  if (lastMessage.tool_calls?.length) {\r\n    return "tools";\r\n  }\r\n  // \uADF8\uB807\uC9C0 \uC54A\uC73C\uBA74 \uD2B9\uC218\uD55C "__end__" \uB178\uB4DC\uB97C \uC0AC\uC6A9\uD558\uC5EC \uBA48\uCDA4\r\n  return "__end__";\r\n}\r\n\r\n// \uBAA8\uB378\uC744 \uD638\uCD9C\uD558\uB294 \uD568\uC218 \uC815\uC758\r\nasync function callModel(state: typeof MessagesAnnotation.State) {\r\n  const response = await model.invoke(state.messages);\r\n  // \uAE30\uC874 \uBAA9\uB85D\uC5D0 \uCD94\uAC00\uB418\uAE30 \uB54C\uBB38\uC5D0 \uBAA9\uB85D\uC744 \uBC18\uD658\r\n  return { messages: [response] };\r\n}\r\n\r\n// Define a new graph\r\nconst workflow = new StateGraph(MessagesAnnotation)\r\n  .addNode("agent", callModel)\r\n  .addEdge("__start__", "agent") // __start__ is a special name for the entrypoint\r\n  .addNode("tools", toolNode)\r\n  .addEdge("tools", "agent")\r\n  .addConditionalEdges("agent", shouldContinue);\r\n\r\n// Finally, we compile it into a LangChain Runnable.\r\nconst app = workflow.compile();\n'})}),"\n",(0,o.jsx)(e.h2,{id:"use-the-graph",children:"use the graph"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:'// \uCCAB\uBC88\uC9F8 \uC0AC\uC6A9\uC790 \uBA54\uC2DC\uC9C0\uB97C \uC2E4\uD589 \uCCAB\uBC88\uC9F8 \uB178\uB4DC\uB85C \uC774\uB3D9\r\nconst finalState = await app.invoke({\r\n  messages: [new HumanMessage("Hi, My name is John")],\r\n});\r\n\r\nconsole.log(finalState.messages[finalState.messages.length - 1].content);\r\n// Hi, John!\r\n\r\n// \uB2E4\uC74C \uC0AC\uC6A9\uC790 \uBA54\uC2DC\uC9C0\uAC00 \uC624\uBA74 \uC774\uC804 \uC0C1\uD0DC\uB97C \uAE30\uC5B5\uD574\uB450\uACE0 \uC788\uB2E4\uAC00 \uADF8 \uB2E4\uC74C \uB178\uB4DC\uB85C \uC774\uB3D9\r\nconst nextState = await app.invoke({\r\n  // Including the messages from the previous run gives the LLM context.\r\n  // This way it knows we\'re asking about the weather in NY\r\n  messages: [...finalState.messages, new HumanMessage("Goodbye")],\r\n});\r\n\r\nconsole.log(nextState.messages[nextState.messages.length - 1].content);\r\n// Goodbye, John!\n'})})]})}function h(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(c,{...n})}):c(n)}},255511:function(n,e,a){a.d(e,{R:()=>s,x:()=>i});var r=a(596363);let o={},t=r.createContext(o);function s(n){let e=r.useContext(t);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);