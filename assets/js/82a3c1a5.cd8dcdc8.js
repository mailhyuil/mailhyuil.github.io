"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["137952"],{148608:function(r,e,n){n.r(e),n.d(e,{frontMatter:()=>a,toc:()=>l,default:()=>m,metadata:()=>o,assets:()=>i,contentTitle:()=>d});var o=JSON.parse('{"id":"nodejs/commander ts-morph","title":"commander ts-morph","description":"commander ts-morph","source":"@site/docs/nodejs/commander ts-morph.md","sourceDirName":"nodejs","slug":"/nodejs/commander ts-morph","permalink":"/docs/nodejs/commander ts-morph","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"commander Dir + File \uC0DD\uC131","permalink":"/docs/nodejs/commander Dir + File \uC0DD\uC131"},"next":{"title":"commander","permalink":"/docs/nodejs/commander"}}'),t=n(447259),s=n(255511);let a={},d,i={},l=[{value:"commander ts-morph",id:"commander-ts-morph",level:2},{value:"install",id:"install",level:2},{value:"usage",id:"usage",level:2}];function c(r){let e={code:"code",h2:"h2",pre:"pre",...(0,s.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"commander-ts-morph",children:"commander ts-morph"}),"\n",(0,t.jsx)(e.h2,{id:"install",children:"install"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"npm i -D commander\r\nnpm i -D ts-morph\n"})}),"\n",(0,t.jsx)(e.h2,{id:"usage",children:"usage"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'const { execSync } = require("child_process");\r\nconst fs = require("fs");\r\nconst path = require("path");\r\nconst { Command } = require("commander");\r\nconst { Project, SyntaxKind } = require("ts-morph");\r\nconst program = new Command();\r\n\r\nprogram\r\n  .version("1.0.0")\r\n  .description("Custom NestJS project initializer")\r\n  .action(() => {\r\n    const newModuleName = "DiscoveryModule";\r\n    // ts-morph project \uC124\uC815\r\n    const project = new Project();\r\n    const appModulePath = path.join(__dirname, "guards/app.module.ts");\r\n\r\n    // \uD504\uB85C\uC81D\uD2B8\uC5D0 app.module.ts \uD30C\uC77C \uCD94\uAC00\r\n    const sourceFile = project.addSourceFileAtPath(appModulePath);\r\n\r\n    // AppModule \uD074\uB798\uC2A4 \uC120\uC5B8 \uCC3E\uAE30\r\n    const appModuleClass = sourceFile.getClass("AppModule");\r\n    if (!appModuleClass) {\r\n      throw new Error("AppModule class not found");\r\n    }\r\n\r\n    // AppModule \uB370\uCF54\uB808\uC774\uD130 \uCC3E\uAE30\r\n    const decorator = appModuleClass.getDecorator("Module");\r\n    if (!decorator) {\r\n      throw new Error("Module decorator not found");\r\n    }\r\n\r\n    // \uB370\uCF54\uB808\uC774\uD130\uC758 \uC778\uC218(\uAC1D\uCCB4 \uB9AC\uD130\uB7F4) \uAC00\uC838\uC624\uAE30\r\n    const decoratorArgument = decorator.getArguments()[0];\r\n    if (!decoratorArgument || !decoratorArgument.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      throw new Error("Module decorator argument is not an object literal");\r\n    }\r\n\r\n    const importsProperty = decoratorArgument.asKindOrThrow(SyntaxKind.ObjectLiteralExpression).getProperty("imports");\r\n\r\n    if (importsProperty && importsProperty.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const importsArray = importsProperty.getInitializerIfKindOrThrow(SyntaxKind.ArrayLiteralExpression);\r\n\r\n      // \uC911\uBCF5 \uC5EC\uBD80 \uCCB4\uD06C\r\n      const isModuleAlreadyImported = importsArray.getElements().some((el: any) => el.getText() === newModuleName);\r\n\r\n      if (!isModuleAlreadyImported) {\r\n        importsArray.addElement(newModuleName);\r\n        sourceFile.addImportDeclaration({\r\n          namedImports: [newModuleName],\r\n          moduleSpecifier: "./path/to/your-module", // \uC2E4\uC81C \uBAA8\uB4C8 \uACBD\uB85C\uB85C \uBC14\uAFB8\uC138\uC694\r\n        });\r\n\r\n        console.log(`${newModuleName} has been added to imports array.`);\r\n      } else {\r\n        console.log(`${newModuleName} is already in the imports array.`);\r\n      }\r\n    } else {\r\n      console.error("Imports array not found or not properly formatted.");\r\n    }\r\n\r\n    // \uBCC0\uACBD \uC0AC\uD56D \uC800\uC7A5\r\n    sourceFile.saveSync();\r\n  });\r\n\r\nprogram.parse();\n'})})]})}function m(r={}){let{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,t.jsx)(e,{...r,children:(0,t.jsx)(c,{...r})}):c(r)}},255511:function(r,e,n){n.d(e,{R:()=>a,x:()=>d});var o=n(596363);let t={},s=o.createContext(t);function a(r){let e=o.useContext(s);return o.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function d(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:a(r.components),o.createElement(s.Provider,{value:e},r.children)}}}]);