"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[838313],{529087:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>a});var t=r(596363);const s={},o=t.createContext(s);function c(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(o.Provider,{value:n},e.children)}},645810:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>i});const t=JSON.parse('{"id":"nodejs/nodejs race condition mutex & semaphore","title":"nodejs Mutex & Semaphore","description":"\uc5ec\ub7ec \uc2a4\ub808\ub4dc \ub610\ub294 \ud504\ub85c\uc138\uc2a4\uac00 \uacf5\uc720 \uc790\uc6d0\uc5d0 \uc811\uadfc\ud560 \ub54c, \ub3d9\uc2dc\uc5d0 \uc811\uadfc\ud558\ub294 \uac83\uc744 \ub9c9\uae30 \uc704\ud55c \ubc29\ubc95","source":"@site/docs/nodejs/nodejs race condition mutex & semaphore.md","sourceDirName":"nodejs","slug":"/nodejs/nodejs race condition mutex & semaphore","permalink":"/docs/nodejs/nodejs race condition mutex & semaphore","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nodejs race condition example","permalink":"/docs/nodejs/nodejs race condition example"},"next":{"title":"mutex vs distributed-lock","permalink":"/docs/nodejs/nodejs race condition mutex vs distributed-lock"}}');var s=r(447259),o=r(529087);const c={},a="nodejs Mutex & Semaphore",l={},i=[{value:"install",id:"install",level:2},{value:"mutex.js",id:"mutexjs",level:2},{value:"usage",id:"usage",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"nodejs-mutex--semaphore",children:"nodejs Mutex & Semaphore"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc5ec\ub7ec \uc2a4\ub808\ub4dc \ub610\ub294 \ud504\ub85c\uc138\uc2a4\uac00 \uacf5\uc720 \uc790\uc6d0\uc5d0 \uc811\uadfc\ud560 \ub54c, \ub3d9\uc2dc\uc5d0 \uc811\uadfc\ud558\ub294 \uac83\uc744 \ub9c9\uae30 \uc704\ud55c \ubc29\ubc95"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc790\ub8cc\uad6c\uc870\uc758 \uc77c\uc885\uc774\ub2e4!"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"install",children:"install"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"npm i async-mutex\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mutexjs",children:"mutex.js"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const _awaitUnlock = async (mutex) => {\r\n  // \uc7a0\uae08 \uc0c1\ud0dc\uac00 \uc544\ub2d8 -> \uc989\uc2dc resolve\r\n  if (!mutex._locked) {\r\n    return Promise.resolve();\r\n  }\r\n  return new Promise((resolve) => {\r\n    // 0.1\ucd08 \ud6c4\uc5d0 \ub2e4\uc2dc \ud655\uc778\r\n    setTimeout(() => {\r\n      _awaitUnlock(mutex).then(() => resolve());\r\n    }, 100);\r\n  });\r\n};\r\n\r\nclass Mutex {\r\n  constructor() {\r\n    this._locked = false;\r\n  }\r\n\r\n  async lock() {\r\n    // \uc7a0\uae08 \uc0c1\ud0dc\uac00 \ud480\ub9b4 \ub54c \uae4c\uc9c0 \ub300\uae30\r\n    await _awaitUnlock(this);\r\n    this._locked = true;\r\n  }\r\n\r\n  // \uc7a0\uae08 \ud574\uc81c\ub294 \ubcc4\ub3c4\uc758 \uc81c\uc57d\uc744 \uc8fc\uc9c0 \uc54a\uc74c.\r\n  release() {\r\n    this._locked = false;\r\n  }\r\n}\r\n\r\nexport default Mutex;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const mutex = new Mutex();\r\n\r\nconst parallelLogic = async () => {\r\n  await mutex.lock(); // \uc5ec\uae30\uc11c mutex\uac00 \uc720\ud734 \uc0c1\ud0dc\uc77c \ub54c \uae4c\uc9c0 \ub300\uae30\ud558\uba70, \uc720\ud734 \uc0c1\ud0dc\uac00 \ub418\uba74 \uc7a0\uae08\uc744 \uac78\uace0 \uc9c4\ud589\ud55c\ub2e4.\r\n  try {\r\n    // ..\ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1..\r\n  } finally {\r\n    mutex.release(); // \ubc18\ub4dc\uc2dc \uc2e4\ud589\ud55c\ub2e4. \uadf8\ub807\uc9c0 \uc54a\uc73c\uba74 Dead-lock \ubc1c\uc0dd\ud568.\r\n  }\r\n};\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);