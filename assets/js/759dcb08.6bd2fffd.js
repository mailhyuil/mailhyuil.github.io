"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[675207],{529087:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var s=r(596363);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},880390:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"db-postgres/pgvector","title":"pgvector","description":"postgres settings","source":"@site/docs/db-postgres/pgvector.md","sourceDirName":"db-postgres","slug":"/db-postgres/pgvector","permalink":"/docs/db-postgres/pgvector","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"DB PostgreSQL","permalink":"/docs/category/db-postgresql"},"next":{"title":"postgres FTS (Full Text Search)","permalink":"/docs/db-postgres/postgres FTS - Full Text Search"}}');var t=r(447259),i=r(529087);const o={},d="pgvector",c={},l=[{value:"postgres settings",id:"postgres-settings",level:2},{value:"init.sql",id:"initsql",level:2},{value:"INSERT",id:"insert",level:2},{value:"SELECT",id:"select",level:2},{value:"INDEX",id:"index",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"pgvector",children:"pgvector"})}),"\n",(0,t.jsx)(n.h2,{id:"postgres-settings",children:"postgres settings"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"services:\r\n  db:\r\n    image: pgvector/pgvector:pg16\r\n    container_name: postgres\r\n    ports:\r\n      - 5432:5432\r\n    restart: always\r\n    environment:\r\n      - POSTGRES_DB=mydb\r\n      - POSTGRES_USER=postgres\r\n      - POSTGRES_PASSWORD=postgres\r\n    volumes:\r\n      - pgdata:/var/lib/postgresql/data\r\n      - ./postgres/init.sql:/docker-entrypoint-initdb.d/init.sql\n"})}),"\n",(0,t.jsx)(n.h2,{id:"initsql",children:"init.sql"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE chatbot_vector (\r\n    id SERIAL PRIMARY KEY,\r\n    content TEXT, -- \ud14d\uc2a4\ud2b8 \ub370\uc774\ud130 \uc800\uc7a5\r\n    metadata JSONB, -- \uba54\ud0c0\ub370\uc774\ud130 \uc800\uc7a5\r\n    embedding vector(1536)  -- vector \ub370\uc774\ud130 \uc800\uc7a5, OpenAI\uc758 text-embedding-ada-002 \ubaa8\ub378 \uae30\uc900\r\n    --------------------------------\r\n    -- \ucd94\uac00\uc801\uc778 \ub370\uc774\ud130 \uc800\uc7a5 (RDBMS \uc6a9)\r\n    -- username TEXT,\r\n    -- created_at TIMESTAMP DEFAULT NOW()\r\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"insert",children:"INSERT"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"INSERT INTO users (embedding) VALUES ('[0.1, 0.2, 0.3, ..., 0.9]');\n"})}),"\n",(0,t.jsx)(n.h2,{id:"select",children:"SELECT"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- <-> (L2(\uc720\ud074\ub9ac\ub4dc) \uac70\ub9ac): \uac12\uc774 \uc791\uc744\uc218\ub85d \uc720\uc0ac (\ub450 \ubca1\ud130 \uc0ac\uc774\uc758 \uc9c1\uc120 \uac70\ub9ac)\r\n-- \uc774\ubbf8\uc9c0 \uac80\uc0c9, \uacf5\uac04 \uae30\ubc18 \ucd94\ucc9c, \ubca1\ud130 \ud06c\uae30\uc640 \ubc29\ud5a5 \ubaa8\ub450 \uace0\ub824\r\nSELECT * FROM users ORDER BY embedding <-> '[0.1, 0.2, 0.3, ..., 0.9]' LIMIT 5;\r\n-- <=> (\ucf54\uc0ac\uc778 \uac70\ub9ac): \uac12\uc774 \uc791\uc744\uc218\ub85d \uc720\uc0ac (\ub450 \ubca1\ud130\uc758 \ubc29\ud5a5(\uac01\ub3c4)\uc744 \uae30\ubc18\uc73c\ub85c \uc720\uc0ac\ub3c4\ub97c \uce21\uc815)\r\n-- \ubb38\uc11c \uac80\uc0c9, NLP, \ucd94\ucc9c \uc2dc\uc2a4\ud15c (\ubca1\ud130 \ubc29\ud5a5\uc774 \uc911\uc694\ud55c \uacbd\uc6b0)\r\nSELECT * FROM users ORDER BY embedding <=> '[0.1, 0.2, 0.3, ..., 0.9]' LIMIT 5;\r\n-- <#> (\ub0b4\uc801): \uac12\uc774 \ud074\uc218\ub85d \uc720\uc0ac (\ub450 \ubca1\ud130\uc758 \ud06c\uae30\uc640 \ubc29\ud5a5\uc744 \uace0\ub824\ud558\uc5ec \uacc4\uc0b0\ud558\ub294 \uac12.)\r\n-- \uac80\uc0c9 \ub7ad\ud0b9, \ucd94\ucc9c \uc2dc\uc2a4\ud15c, \ubca1\ud130 \ud06c\uae30\uac00 \uc911\uc694\ud55c \uacbd\uc6b0\r\nSELECT * FROM users ORDER BY embedding <#> '[0.1, 0.2, 0.3, ..., 0.9]' LIMIT 5;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"index",children:"INDEX"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- HNSW(\uacc4\uce35\uc801 \ud0d0\uc0c9 \uac00\ub2a5\ud55c \uc791\uc740 \uc138\uacc4)\r\nCREATE INDEX ON users USING hnsw (embedding);\r\n-- DiskANN(DiskANN) \uadfc\uc0ac\ud55c \uc778\uc811 \ub514\uc2a4\ud06c\r\nCREATE INDEX ON users USING diskann (embedding);\n"})})]})}function g(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);