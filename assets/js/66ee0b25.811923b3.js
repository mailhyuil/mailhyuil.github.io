"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[769024],{529087:(e,n,l)=>{l.d(n,{R:()=>i,x:()=>a});var r=l(596363);const o={},c=r.createContext(o);function i(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(c.Provider,{value:n},e.children)}},718879:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>k,frontMatter:()=>i,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"cloud/keycloak","title":"keycloak","description":"SSO \uad6c\ud604\uc744 \uc704\ud55c API","source":"@site/docs/cloud/keycloak.md","sourceDirName":"cloud","slug":"/cloud/keycloak","permalink":"/docs/cloud/keycloak","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"jsdelivr cdn","permalink":"/docs/cloud/jsdelivr cdn"},"next":{"title":"ngrok","permalink":"/docs/cloud/ngrok"}}');var o=l(447259),c=l(529087);const i={},a="keycloak",s={},t=[{value:"docker-keycloak",id:"docker-keycloak",level:2},{value:"keycloak console",id:"keycloak-console",level:2},{value:"dependency",id:"dependency",level:2},{value:"application.properties",id:"applicationproperties",level:2},{value:"keycloak config in application.properties resolving",id:"keycloak-config-in-applicationproperties-resolving",level:2},{value:"logout",id:"logout",level:2},{value:"SPI (Service Provider Interface)",id:"spi-service-provider-interface",level:2},{value:"DB \uc5f0\ub3d9",id:"db-\uc5f0\ub3d9",level:3}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"keycloak",children:"keycloak"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"SSO \uad6c\ud604\uc744 \uc704\ud55c API"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"docker-keycloak",children:"docker-keycloak"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"pull & run"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker run --name keycloak -d -p 8080:8080 -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin jboss/keycloak:latest\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:"addUser"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker exec keycloak /opt/jboss/keycloak/bin/add-user-keycloak.sh -u <USERNAME> -p <PASSWORD>\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsx)(n.li,{children:"restart"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker restart keycloak\n"})}),"\n",(0,o.jsx)(n.h2,{id:"keycloak-console",children:"keycloak console"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"realm \uc0dd\uc131"}),"\n",(0,o.jsx)(n.li,{children:"clients \uc0dd\uc131 -> Valid Redirect = \uc2a4\ud504\ub9c1\ubd80\ud2b8url/*"}),"\n",(0,o.jsx)(n.li,{children:"roles -> role \uc0dd\uc131 (e.g. user)"}),"\n",(0,o.jsx)(n.li,{children:"Manage Users -> user\uc0dd\uc131 -> Role Mappings\uc5d0\uc11c role \ucd94\uac00"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"dependency",children:"dependency"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:"<dependency>\r\n\t<groupId>org.keycloak</groupId>\r\n\t<artifactId>keycloak-spring-boot-starter</artifactId>\r\n\t<version>16.1.1</version>\r\n</dependency>\n"})}),"\n",(0,o.jsx)(n.h2,{id:"applicationproperties",children:"application.properties"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"keycloak.auth-server-url=http://localhost:8080/auth\r\nkeycloak.realm=springboot-test\r\nkeycloak.resource=login-app\r\nkeycloak.public-client=true\r\nkeycloak.security-constraints[0].authRoles[0]=user\r\nkeycloak.security-constraints[0].securityCollections[0].patterns[0]=/main/*\r\nkeycloak.principal-attribute=preferred_username\n"})}),"\n",(0,o.jsx)(n.h2,{id:"keycloak-config-in-applicationproperties-resolving",children:"keycloak config in application.properties resolving"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"@Configuration\r\npublic class KeycloakConfig {\r\n\t@Bean\r\n\tpublic KeycloakConfigResolver KeycloakConfigResolver() {\r\n\t\treturn new KeycloakSpringBootConfigResolver();\r\n\t}\r\n\r\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"logout",children:"logout"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",children:'<a href="http://localhost:8080/auth/realms/springboot-test/protocol/openid-connect/logout?redirect_uri=http://localhost:8081/">logout</a>\n'})}),"\n",(0,o.jsx)(n.h2,{id:"spi-service-provider-interface",children:"SPI (Service Provider Interface)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:"<dependency>\r\n    <groupId>org.keycloak</groupId>\r\n    <artifactId>keycloak-server-spi</artifactId>\r\n    <version>16.1.1</version>\r\n</dependency>\n"})}),"\n",(0,o.jsx)(n.h3,{id:"db-\uc5f0\ub3d9",children:"DB \uc5f0\ub3d9"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker run --name db-keycloak -p 8080:8080 -e DB_VENDOR=mssql -e DB_USER=tia -e DB_PASSWORD=kkk123#### -e DB_ADDR=activeblackbox.co.kr -e DB_PORT=21433 -e DB_DATABASE=PANTOS -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin jboss/keycloak\n"})})]})}function k(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);