"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[153239],{335372:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"nodejs/nodejs race condition example","title":"nodejs race condition example","description":"nodejs\ub294 \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8(cpu)\ub97c \uc2f1\uae00 \uc2a4\ub808\ub4dc\uc5d0\uc11c \ub3cc\ub9ac\uae30 \ub54c\ubb38\uc5d0 \uc5f0\uc0b0\uc73c\ub85c \uc778\ud55c race condition \ubc84\uadf8\ub294 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4.","source":"@site/docs/nodejs/nodejs race condition example.md","sourceDirName":"nodejs","slug":"/nodejs/nodejs race condition example","permalink":"/docs/nodejs/nodejs race condition example","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nodejs profiling","permalink":"/docs/nodejs/nodejs profiling"},"next":{"title":"nodejs Mutex & Semaphore","permalink":"/docs/nodejs/nodejs race condition mutex & semaphore"}}');var s=t(447259),o=t(529087);const a={},i="nodejs race condition example",l={},c=[{value:"problem",id:"problem",level:2},{value:"solution1",id:"solution1",level:2},{value:"solution2",id:"solution2",level:2},{value:"install",id:"install",level:3}];function d(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"nodejs-race-condition-example",children:"nodejs race condition example"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"nodejs\ub294 \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8(cpu)\ub97c \uc2f1\uae00 \uc2a4\ub808\ub4dc\uc5d0\uc11c \ub3cc\ub9ac\uae30 \ub54c\ubb38\uc5d0 \uc5f0\uc0b0\uc73c\ub85c \uc778\ud55c race condition \ubc84\uadf8\ub294 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4."}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"\ud558\uc9c0\ub9cc \ube44\ub3d9\uae30 task(I/O)\ub97c \ubc31\uadf8\ub77c\uc6b4\ub4dc \uba40\ud2f0 \uc2a4\ub808\ub4dc\uc5d0\uc11c \ub3cc\ub9ac\uae30 \ub54c\ubb38\uc5d0 \uc21c\uc11c\ub85c \uc778\ud55c race condition \ubc84\uadf8\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"problem",children:"problem"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'async function task1() {\r\n  console.log("task1 start");\r\n  await delay(1500);\r\n  console.log("task1 end");\r\n}\r\n\r\nasync function task2() {\r\n  console.log("task2 start");\r\n  await delay(1000);\r\n  console.log("task2 end");\r\n}\r\n\r\nfunction delay(ms: number) {\r\n  return new Promise<void>((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nasync function main() {\r\n  const temp1 = task1();\r\n  const temp2 = task2();\r\n  await temp1;\r\n  await temp2;\r\n}\r\nmain();\r\n\r\n// task1 start\r\n// task2 start\r\n// task2 end\r\n// task1 end\n'})}),"\n",(0,s.jsx)(e.h2,{id:"solution1",children:"solution1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:"async function main() {\r\n  await task1();\r\n  await task2();\r\n}\r\n// task1 start\r\n// task1 end\r\n// task2 start\r\n// task2 end\n"})}),"\n",(0,s.jsx)(e.h2,{id:"solution2",children:"solution2"}),"\n",(0,s.jsx)(e.h3,{id:"install",children:"install"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:"npm i async-mutex\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'import { Mutex } from "async-mutex";\r\n\r\nconst mutex = new Mutex();\r\n\r\nasync function task1() {\r\n  const release = await mutex.acquire();\r\n  try {\r\n    console.log("task1 start");\r\n    await delay(1500);\r\n    console.log("task1 end");\r\n  } finally {\r\n    release();\r\n  }\r\n}\r\n\r\nasync function task2() {\r\n  const release = await mutex.acquire();\r\n  try {\r\n    console.log("task2 start");\r\n    await delay(1000);\r\n    console.log("task2 end");\r\n  } finally {\r\n    release();\r\n  }\r\n}\r\n\r\nfunction delay(ms: number) {\r\n  return new Promise<void>((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nasync function main() {\r\n  const temp1 = task1();\r\n  const temp2 = task2();\r\n  await temp1;\r\n  await temp2;\r\n}\r\nmain();\r\n// task1 start\r\n// task1 end\r\n// task2 start\r\n// task2 end\n'})})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},529087:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>i});var r=t(596363);const s={},o=r.createContext(s);function a(n){const e=r.useContext(o);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),r.createElement(o.Provider,{value:e},n.children)}}}]);