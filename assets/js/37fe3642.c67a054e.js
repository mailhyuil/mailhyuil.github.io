"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["872560"],{785910:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>i,toc:()=>c,default:()=>d,metadata:()=>t,assets:()=>o,contentTitle:()=>l});var t=JSON.parse('{"id":"nestjs/nest email @react-email","title":"nest email @react-email","description":"install","source":"@site/docs/nestjs/nest email @react-email.md","sourceDirName":"nestjs","slug":"/nestjs/nest email @react-email","permalink":"/docs/nestjs/nest email @react-email","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nest dotenv","permalink":"/docs/nestjs/nest dotenv"},"next":{"title":"nest mailer nestmailer","permalink":"/docs/nestjs/nest email nestmailer"}}'),s=r(447259),a=r(255511);let i={},l="nest email @react-email",o={},c=[{value:"install",id:"install",level:2},{value:"tsconfig.json",id:"tsconfigjson",level:2},{value:"email.template.tsx",id:"emailtemplatetsx",level:2},{value:"email.service.ts",id:"emailservicets",level:2}];function m(e){let n={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"nest-email-react-email",children:"nest email @react-email"})}),"\n",(0,s.jsx)(n.h2,{id:"install",children:"install"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"npm i -D @types/react\r\nnpm i react-email\r\nnpm i @react-email/components\n"})}),"\n",(0,s.jsx)(n.h2,{id:"tsconfigjson",children:"tsconfig.json"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'  "compilerOptions": {\r\n    "jsx": "react-jsx"\r\n  },\n'})}),"\n",(0,s.jsx)(n.h2,{id:"emailtemplatetsx",children:"email.template.tsx"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import {\r\n  Body,\r\n  Container,\r\n  Head,\r\n  Heading,\r\n  Hr,\r\n  Html,\r\n  Preview,\r\n  Section,\r\n  Tailwind,\r\n  Text,\r\n  Link,\r\n} from "@react-email/components";\r\nimport * as React from "react";\r\n\r\nexport const EmailAuthEmail = ({ password }): React.ReactElement => {\r\n  return (\r\n    <Html lang="ko">\r\n      <Head />\r\n      <Preview>\uC774\uBA54\uC77C \uC778\uC99D \uC548\uB0B4</Preview>\r\n      <Tailwind>\r\n        <Body className="mx-auto my-auto font-sans bg-white text-neutral-900">\r\n          <Container>\r\n            <Hr />\r\n            <Heading> \uC774\uBA54\uC77C \uC778\uC99D \uC548\uB0B4</Heading>\r\n            <Text>\uC548\uB155\uD558\uC138\uC694. oooo\uC785\uB2C8\uB2E4.</Text>\r\n            <Text>\uC774\uBA54\uC77C \uC778\uC99D\uC744 \uC704\uD574 \uC544\uB798 \uB9C1\uD06C\uB97C \uD074\uB9AD\uD574\uC8FC\uC138\uC694</Text>\r\n            <Hr />\r\n            <Section className="bg-neutral-100">\r\n              <Link className="text-xl font-extrabold text-center" href={url}>\r\n                \uC778\uC99D\uD558\uAE30\r\n              </Link>\r\n            </Section>\r\n          </Container>\r\n        </Body>\r\n      </Tailwind>\r\n    </Html>\r\n  );\r\n};\n'})}),"\n",(0,s.jsx)(n.h2,{id:"emailservicets",children:"email.service.ts"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { HttpService } from "@nestjs/axios";\r\nimport { EmailAuthEmail } from "./email-auth.template";\r\nimport { Injectable, Logger } from "@nestjs/common";\r\nimport { render } from "@react-email/render";\r\n\r\n@Injectable()\r\nexport class EmailService {\r\n  logger = new Logger(EmailService.name);\r\n  constructor(private readonly httpService: HttpService) {}\r\n  async sendEmail({ email, password }: { email: string; password: string }) {\r\n    this.logger.log(`Send email with password ${password}`);\r\n    const endpoint = process.env["NHN_CLOUD_EMAIL_ENDPOINT"];\r\n    const appKey = process.env["NHN_CLOUD_EMAIL_APP_KEY"];\r\n    const secretKey = process.env["NHN_CLOUD_EMAIL_SECRET_KEY"];\r\n    const baseUrl = `${endpoint}/appKeys/${appKey}`;\r\n    const headers = {\r\n      "Content-Type": "application/json;charset=UTF-8",\r\n      "X-Secret-Key": secretKey,\r\n    };\r\n\r\n    const data = {\r\n      senderAddress: "help@lepisode.team",\r\n      receiverList: [{ receiveMailAddr: email, receiveType: "MRT0" }],\r\n      title: `\uC0AC\uC774\uB2C8\uC9C0 \uD1B5\uD569 \uAD00\uB9AC \uC2DC\uC2A4\uD15C \uC774\uBA54\uC77C \uC778\uC99D \uC548\uB0B4`,\r\n      body: render(EmailAuthEmail({ password })),\r\n    };\r\n\r\n    return new Promise<void>((resolve, reject) => {\r\n      this.httpService\r\n        .post(`${baseUrl}/sender/mail`, data, {\r\n          headers,\r\n        })\r\n        .subscribe({\r\n          next: res => {\r\n            if (res.data.header.isSuccessful) {\r\n              console.log(`\u2705 \uC778\uC99D\uC6A9 \uC774\uBA54\uC77C \uBC1C\uC1A1\uC5D0 \uC131\uACF5\uD588\uC2B5\uB2C8\uB2E4.`);\r\n              resolve();\r\n            } else {\r\n              console.error(`\u26D4\uFE0F \uC778\uC99D\uC6A9 \uC774\uBA54\uC77C \uBC1C\uC1A1\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.`, res.data.header.resultMessage);\r\n              reject(res.data.header.resultMessage);\r\n            }\r\n          },\r\n        });\r\n    });\r\n  }\r\n}\n'})})]})}function d(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},255511:function(e,n,r){r.d(n,{R:()=>i,x:()=>l});var t=r(596363);let s={},a=t.createContext(s);function i(e){let n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);