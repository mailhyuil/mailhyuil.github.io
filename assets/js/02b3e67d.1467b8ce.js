"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[874092],{529087:(r,e,n)=>{n.d(e,{R:()=>o,x:()=>i});var a=n(596363);const t={},s=a.createContext(t);function o(r){const e=a.useContext(s);return a.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function i(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:o(r.components),a.createElement(s.Provider,{value:e},r.children)}},863230:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"spring/Spring MVC + JPA","title":"SpringMVC + JPA","description":"- pom.xml \uc5d0 \ucd94\uac00","source":"@site/docs/spring/Spring MVC + JPA.md","sourceDirName":"spring","slug":"/spring/Spring MVC + JPA","permalink":"/docs/spring/Spring MVC + JPA","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"spring-data","permalink":"/docs/spring/Spring Data"},"next":{"title":"Spring Reactor (\uc2a4\ud504\ub9c1 \ub9ac\uc561\ud130)","permalink":"/docs/spring/Spring Reactor"}}');var t=n(447259),s=n(529087);const o={},i="SpringMVC + JPA",c={},l=[];function p(r){const e={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",pre:"pre",ul:"ul",...(0,s.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"springmvc--jpa",children:"SpringMVC + JPA"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"pom.xml \uc5d0 \ucd94\uac00"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:"\x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-orm --\x3e\r\n<dependency>\r\n    <groupId>org.springframework</groupId>\r\n    <artifactId>spring-orm</artifactId>\r\n    <version>${org.springframework-version}</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/org.apache.commons/commons-dbcp2 --\x3e\r\n<dependency>\r\n    <groupId>org.apache.commons</groupId>\r\n    <artifactId>commons-dbcp2</artifactId>\r\n    <version>2.9.0</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-entitymanager --\x3e\r\n<dependency>\r\n    <groupId>org.hibernate</groupId>\r\n    <artifactId>hibernate-entitymanager</artifactId>\r\n    <version>5.6.10.Final</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/com.oracle.database.jdbc/ojdbc8 --\x3e\r\n<dependency>\r\n    <groupId>com.oracle.database.jdbc</groupId>\r\n    <artifactId>ojdbc8</artifactId>\r\n    <version>21.6.0.0.1</version>\r\n</dependency>\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"servlet-context \uc5d0 \ucd94\uac00"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<tx:annotation-driven/>\r\n\r\n<bean id="dataSource" class="org.apache.commons.dbcp2.BasicDataSource">\r\n    <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver"/>\r\n    <property name="url" value="jdbc:oracle:thin:@localhost:1521:xe"/>\r\n    <property name="username" value="USER1"/>\r\n    <property name="password" value="12341234"/>\r\n</bean>\r\n\r\n<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">\r\n    <property name="dataSource" ref="dataSource"/>\r\n</bean>\r\n\r\n\x3c!-- JPA \uc608\uc678\ub97c \uc2a4\ud504\ub9c1 \uc608\uc678\ub85c \ubcc0\ud658 --\x3e\r\n<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/>\r\n\r\n<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">\r\n    <property name="dataSource" ref="dataSource"/>\r\n    <property name="packagesToScan" value="com.sb.school.domain"/> \x3c!-- @Entity \ud0d0\uc0c9 \uc2dc\uc791 \uc704\uce58 --\x3e\r\n    <property name="jpaVendorAdapter">\r\n        \x3c!-- \ud558\uc774\ubc84\ub124\uc774\ud2b8 \uad6c\ud604\uccb4 \uc0ac\uc6a9 --\x3e\r\n        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>\r\n    </property>\r\n    <property name="jpaProperties"> \x3c!-- \ud558\uc774\ubc84\ub124\uc774\ud2b8 \uc0c1\uc138 \uc124\uc815 --\x3e\r\n        <props>\r\n            <prop key="hibernate.dialect">org.hibernate.dialect.OracleDialect</prop> \x3c!-- \ubc29\uc5b8 --\x3e\r\n            <prop key="hibernate.show_sql">true</prop>                   \x3c!-- SQL \ubcf4\uae30 --\x3e\r\n            <prop key="hibernate.format_sql">true</prop>                 \x3c!-- SQL \uc815\ub82c\ud574\uc11c \ubcf4\uae30 --\x3e\r\n            <prop key="hibernate.use_sql_comments">true</prop>           \x3c!-- SQL \ucf54\uba58\ud2b8 \ubcf4\uae30 --\x3e\r\n            <prop key="hibernate.id.new_generator_mappings">true</prop>  \x3c!-- \uc0c8 \ubc84\uc804\uc758 ID \uc0dd\uc131 \uc635\uc158 --\x3e\r\n            <prop key="hibernate.hbm2ddl.auto">create</prop>             \x3c!-- DDL \uc790\ub3d9 \uc0dd\uc131 --\x3e\r\n        </props>\r\n    </property>\r\n</bean>\r\n\r\n<default-servlet-handler/>\r\n\r\n<interceptors>\r\n    <beans:bean class="org.springframework.orm.jpa.support.OpenEntityManagerInViewInterceptor">\r\n        <beans:property name="entityManagerFactory" ref="entityManagerFactory" />\r\n    </beans:bean>\r\n</interceptors>\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"domain (vo)"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Entity\r\n@Table(name = "TBL_USER")\r\npublic class User {\r\n    @Id\r\n    @Column(name = "USERNAME")\r\n\tprivate String username;\r\n\tprivate String password;\r\n\tprivate String name;\r\n\tprivate String role;\r\n\tprivate String email;\r\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"repository (dao)"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"@Repository\r\npublic class UserRepository {\r\n\r\n    @PersistenceContext\r\n    EntityManager em;\r\n\r\n    public void save(User user) {\r\n    \tem.persist(user);\r\n    }\r\n\r\n    public User findById(String username) {\r\n    \treturn em.find(User.class, username);\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"service"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"@Service\r\npublic class UserService {\r\n\t@Autowired\r\n\tprivate UserRepository userRepository;\r\n\r\n\t@Transactional // transaction \ucc98\ub9ac \uc548\ud558\uba74 \uc5d0\ub7ec\r\n    public String join(User user) {\r\n        userRepository.save(user);\r\n        return user.getUsername();\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h1,{id:"jpql",children:"JPQL"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'\tQuery query1 = em.createQuery("select u from User u where u.username = :username", User.class);\r\n\tquery1.setParameter("username", "sb"); // \uc120\ud0dd\uc774 \uc544\ub2cc \ud544\uc218\r\n\tSystem.out.println("result1 : " + query1.getSingleResult());\r\n\r\n//\tQuery query2 = em.createQuery("select u from User u", User.class);\r\n//\tSystem.out.println("result2 : " + query2.getResultList());\n'})}),"\n",(0,t.jsx)(e.h1,{id:"querydsl",children:"QueryDSL"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"pom.xml"}),"\n"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"dependency \ucd94\uac00"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:"\x3c!-- https://mvnrepository.com/artifact/com.querydsl/querydsl-jpa --\x3e\r\n<dependency>\r\n    <groupId>com.querydsl</groupId>\r\n    <artifactId>querydsl-jpa</artifactId>\r\n    <version>5.0.0</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/com.querydsl/querydsl-apt --\x3e\r\n<dependency>\r\n    <groupId>com.querydsl</groupId>\r\n    <artifactId>querydsl-apt</artifactId>\r\n    <version>5.0.0</version>\r\n</dependency>\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"plugin \ucd94\uac00"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:"<plugin>\r\n    <groupId>com.mysema.maven</groupId>\r\n    <artifactId>apt-maven-plugin</artifactId>\r\n    <version>1.1.3</version>\r\n    <executions>\r\n        <execution>\r\n            <goals>\r\n                <goal>process</goal>\r\n            </goals>\r\n            <configuration>\r\n                <outputDirectory>target/generated-sources/java</outputDirectory>\r\n                <processor>com.querydsl.apt.jpa.JPAAnnotationProcessor</processor>\r\n            </configuration>\r\n        </execution>\r\n    </executions>\r\n</plugin>\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"build.gradle"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-groovy",children:'buildscript { // \ub9e8\uc704\uc5d0 \uc704\uce58\r\n    dependencies {\r\n        classpath("gradle.plugin.com.ewerk.gradle.plugins:querydsl-plugin:1.0.10")\r\n    }\r\n}\r\n\r\napply plugin: "com.ewerk.gradle.plugins.querydsl"\r\n\r\ndependencies {\r\n    //querydsl \ucd94\uac00\r\n    implementation \'com.querydsl:querydsl-jpa\'\r\n    //querydsl \ucd94\uac00\r\n    implementation \'com.querydsl:querydsl-apt\'\r\n}\r\n\r\ndef querydslDir = "$buildDir/generated/querydsl"\r\n\r\nquerydsl {\r\n    library = "com.querydsl:querydsl-apt"\r\n    jpa = true\r\n    querydslSourcesDir = querydslDir\r\n}\r\n\r\nsourceSets {\r\n    main {\r\n        java {\r\n            srcDirs = [\'src/main/java\', querydslDir]\r\n        }\r\n    }\r\n}\r\n\r\ncompileQuerydsl{\r\n    options.annotationProcessorPath = configurations.querydsl\r\n}\r\n\r\nconfigurations {\r\n    querydsl.extendsFrom compileClasspath\r\n}\n'})}),"\n",(0,t.jsxs)(e.ol,{start:"2",children:["\n",(0,t.jsx)(e.li,{children:"\uae30\ubcf8 \ubb38\ubc95"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'//\tJPAQuery<EntityManager> query = new JPAQuery<>(em);\r\n    JPAQueryFactory queryFactory = new JPAQueryFactory(em);\r\n\r\n//\tQUser user = new QUser("u");\r\n\tQUser user = QUser.user;\r\n\r\n\tUser foundUser = (User) queryFactory\r\n//\t\t\t\t  .selectFrom(qUser) // select + from\r\n\t\t\t\t  .from(user)\r\n\t\t\t\t  .where(user.username.eq("sb"))\r\n\t\t\t\t  .orderBy(user.username.desc())\r\n\t\t\t\t  .fetchOne();\r\n\r\n\tSystem.out.println("result : " + foundUser);\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"java config (QueryDSL-JPAQueryFactory)"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"@PersistenceContext\r\nprivate EntityManager entityManager;\r\n\r\n@Bean\r\npublic JPAQueryFactory jpaQueryFactory() {\r\n    return new JPAQueryFactory(entityManager);\r\n}\n"})})]})}function d(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,t.jsx)(e,{...r,children:(0,t.jsx)(p,{...r})}):p(r)}}}]);