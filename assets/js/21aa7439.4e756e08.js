"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["985660"],{553484:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>o,toc:()=>c,default:()=>h,metadata:()=>a,assets:()=>i,contentTitle:()=>l});var a=JSON.parse('{"id":"api/api oauth kakao","title":"oauth-kakao","description":"1. \uC571 \uC0DD\uC131","source":"@site/docs/api/api oauth kakao.md","sourceDirName":"api","slug":"/api/api oauth kakao","permalink":"/docs/api/api oauth kakao","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"api oauth kakao logout","permalink":"/docs/api/api oauth kakao logout"},"next":{"title":"api oauth naver","permalink":"/docs/api/api oauth naver"}}'),t=r(447259),s=r(255511);let o={},l="oauth-kakao",i={},c=[{value:"REST API vs SDK",id:"rest-api-vs-sdk",level:2},{value:"client",id:"client",level:2},{value:"index.html",id:"indexhtml",level:3},{value:"login.page.ts (REST API \uC0AC\uC6A9)",id:"loginpagets-rest-api-\uC0AC\uC6A9",level:3},{value:"login.page.ts (Javascript SDK \uC0AC\uC6A9)",id:"loginpagets-javascript-sdk-\uC0AC\uC6A9",level:3},{value:"app.routes.ts",id:"approutests",level:3},{value:"callback.page.ts",id:"callbackpagets",level:3},{value:"server",id:"server",level:2},{value:"axios \uC124\uC815",id:"axios-\uC124\uC815",level:2},{value:"install",id:"install",level:3},{value:"module",id:"module",level:3},{value:"user/oauth",id:"useroauth",level:3},{value:"\uB85C\uADF8\uC544\uC6C3",id:"\uB85C\uADF8\uC544\uC6C3",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"oauth-kakao",children:"oauth-kakao"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"\uC571 \uC0DD\uC131"}),"\n",(0,t.jsx)(n.li,{children:"\uB3D9\uC758 \uD56D\uBAA9 \uC124\uC815"}),"\n",(0,t.jsx)(n.li,{children:"\uCE74\uCE74\uC624 \uB85C\uADF8\uC778 \uD65C\uC131\uD654, OpenID Connect \uD65C\uC131\uD654"}),"\n",(0,t.jsxs)(n.li,{children:["\uC571\uD0A4 -> REST API \uD0A4 \uB610\uB294 Javascript \uD0A4 (\uB124\uC774\uD2F0\uBE0C \uC571 \uD0A4) \uD658\uACBD \uBCC0\uC218\uB85C \uC124\uC815","\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"REST API \uD0A4\uB294 \uACF5\uAC1C\uB418\uBA74 \uC548\uB41C\uB2E4 (REST API\uB85C \uC0AC\uC6A9)"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Javascript \uD0A4\uB294 \uACF5\uAC1C\uB418\uC5B4\uB3C4 \uC0C1\uAD00\uC5C6\uB2E4 (Javascript SDK\uB97C \uC0AC\uC6A9\uD560 \uB54C \uC0AC\uC6A9)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Redirect URL \uC124\uC815","\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'\uC0AC\uC6A9\uC790\uAC00 \uB85C\uADF8\uC778\uC5D0 \uC131\uACF5\uD588\uC744 \uB54C \uB9AC\uB514\uB809\uC158 \uC2DC\uD0AC "\uD074\uB77C\uC774\uC5B8\uD2B8"\uC758 URL'}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"REDIRECT_URL?code=fdhttfdhft6ht \uCF54\uB4DC \uD615\uC2DD\uC73C\uB85C \uB9AC\uB2E4\uC774\uB809\uD2B8 \uB41C\uB2E4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"querystring\uC73C\uB85C code\uB97C \uBC1B\uC544\uC11C \uC11C\uBC84\uC5D0 \uB85C\uADF8\uC778 \uB610\uB294 \uD68C\uC6D0\uAC00\uC785 \uC694\uCCAD (REST API \uC0AC\uC6A9)"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\uB610\uB294 SDK\uB97C \uC0AC\uC6A9\uD558\uC5EC \uD68C\uC6D0 \uC815\uBCF4\uB9CC \uC11C\uBC84\uC5D0 \uC694\uCCAD. (Javascript SDK \uC0AC\uC6A9)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"\uC11C\uBC84\uC5D0\uC11C \uBC1B\uC740 \uCF54\uB4DC\uB97C \uC774\uC6A9\uD574\uC11C \uCE74\uCE74\uC624 \uC778\uC99D \uC11C\uBC84\uC5D0 \uD68C\uC6D0 \uC815\uBCF4 \uC694\uCCAD"}),"\n",(0,t.jsx)(n.li,{children:"\uCE74\uCE74\uC624 \uC778\uC99D \uC11C\uBC84\uC5D0\uC11C \uD68C\uC6D0 \uC815\uBCF4\uB97C \uBC1B\uC544\uC11C \uC11C\uBC84\uC5D0\uC11C \uB85C\uADF8\uC778 \uB610\uB294 \uD68C\uC6D0\uAC00\uC785 \uCC98\uB9AC"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"rest-api-vs-sdk",children:"REST API vs SDK"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"SDK\uB97C \uC0AC\uC6A9\uD574\uC11C \uAD6C\uD604\uD558\uBA74 \uAC04\uD3B8 \uB85C\uADF8\uC778\uC744 \uAD6C\uD604\uD560 \uC218 \uC788\uACE0"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"REST API\uB97C \uC0AC\uC6A9\uD574\uC11C \uAD6C\uD604\uD558\uBA74 \uB354 \uB9CE\uC740 \uC815\uBCF4\uB97C \uBC1B\uC544\uC62C \uC218 \uC788\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"client",children:"client"}),"\n",(0,t.jsx)(n.h3,{id:"indexhtml",children:"index.html"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<head>\r\n  <script\r\n    src="https://t1.kakaocdn.net/kakao_js_sdk/2.2.0/kakao.min.js"\r\n    integrity="sha384-x+WG2i7pOR+oWb6O5GV5f1KN2Ko6N7PTGPS7UlasYWNxZMKQA63Cj/B2lbUmUfuC"\r\n    crossorigin="anonymous"\r\n  ><\/script>\r\n  <script>\r\n    Kakao.init(""); // \uC0AC\uC6A9\uD558\uB824\uB294 \uC571\uC758 JavaScript \uD0A4 \uC785\uB825\r\n  <\/script>\r\n</head>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"loginpagets-rest-api-\uC0AC\uC6A9",children:"login.page.ts (REST API \uC0AC\uC6A9)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { CommonModule } from "@angular/common";\r\nimport { Component } from "@angular/core";\r\nimport { IconComponent } from "angular-libs";\r\n\r\ndeclare const Kakao: any; // \uCE74\uCE74\uC624 \uAC1D\uCCB4 \uBD88\uB7EC\uC624\uAE30\r\n\r\n@Component({\r\n  selector: "app-login",\r\n  standalone: true,\r\n  imports: [CommonModule, IconComponent],\r\n  templateUrl: "./login.page.html",\r\n  styleUrls: ["./login.page.scss"],\r\n})\r\nexport class LoginPage {\r\n  constructor() {}\r\n  login() {\r\n    Kakao.Auth.authorize({\r\n      redirectUri: "http://localhost:3000/auth/kakao/callback",\r\n    });\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"loginpagets-javascript-sdk-\uC0AC\uC6A9",children:"login.page.ts (Javascript SDK \uC0AC\uC6A9)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'export class JoinPage implements OnInit {\r\n  JAVASCRIPT_API_KEY = "50284f7f25fb25ad3f69339c6c605149";\r\n\r\n  ngOnInit(): void {\r\n    Kakao.init(this.JAVASCRIPT_API_KEY);\r\n    console.log(Kakao.isInitialized());\r\n  }\r\n\r\n  KaKaoLoginAPI(): void {\r\n    Kakao.Auth.login({\r\n      success: () => {\r\n        Kakao.API.request({\r\n          url: "/v2/user/me",\r\n          success: (res: any) => {\r\n            console.log("\uC131\uACF5 : ", res);\r\n          },\r\n          fail: (err: any) => {\r\n            alert(`\uAC1C\uC778\uC815\uBCF4\uB97C \uAC00\uC838\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. ${JSON.stringify(err)}`);\r\n          },\r\n        });\r\n      },\r\n      fail: (err: any) => {\r\n        alert(`\uB3C4\uBA54\uC778\uC744 \uD655\uC778\uD574\uC8FC\uC138\uC694. ${JSON.stringify(err)}`);\r\n      },\r\n    });\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"approutests",children:"app.routes.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"{\r\n    path: '/auth/kakao/callback',\r\n    data: {\r\n    title: '\uCE74\uCE74\uC624 \uB85C\uADF8\uC778 \uCF5C\uBC31 URL',\r\n    },\r\n    loadComponent: () =>\r\n    import('./pages/login/kakao/callback.page').then((m) => m.CallbackPage),\r\n},\n"})}),"\n",(0,t.jsx)(n.h3,{id:"callbackpagets",children:"callback.page.ts"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"querystring\uC758 code\uB97C \uBC1B\uC544\uC11C \uC11C\uBC84\uC5D0 \uC694\uCCAD"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"async sendCode(){\r\n    const code = this.route.snapshot.queryParams.code;\r\n    if(!code) return;\r\n    const response = await lastValueFrom(this.httpService.post('http://localhost:4200/api/v1/user/oauth', {code}))\r\n    console.log(response);\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"server",children:"server"}),"\n",(0,t.jsx)(n.h2,{id:"axios-\uC124\uC815",children:"axios \uC124\uC815"}),"\n",(0,t.jsx)(n.h3,{id:"install",children:"install"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"npm i --save @nestjs/axios axios\n"})}),"\n",(0,t.jsx)(n.h3,{id:"module",children:"module"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { HttpModule } from "@nestjs/axios";\r\n\r\n@Module({\r\n  imports: [HttpModule],\r\n  providers: [UserService],\r\n})\r\nexport class UserModule {}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"useroauth",children:"user/oauth"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"  constructor(\r\n    private readonly userService: UserService,\r\n    private readonly httpService: HttpService\r\n  ) {}\r\n\r\n  @Get('oauth')\r\n  async oauth(@Query('code') code: string) {\r\n    if (!code || typeof code !== 'string')\r\n      throw new BadRequestException('code is required');\r\n\r\n    const url = 'https://kauth.kakao.com/oauth/token';\r\n\r\n    const data = {\r\n      grant_type: 'authorization_code',\r\n      client_id: '7ce0584576ca0egd07474f14933101b6072', // REST API KEY\r\n      redirect_uri: 'http://localhost:3000/auth/kakao/callback', // Redirect URI \uB611\uAC19\uC774\r\n      code,\r\n    };\r\n\r\n    const headers = {\r\n      'Content-type': 'application/x-www-form-urlencoded;charset=utf-8',\r\n    };\r\n\r\n    const response = await lastValueFrom(\r\n      this.httpService.post(url, data, { headers })\r\n    );\r\n\r\n    const { access_token, token_type, refresh_token, expires_in, scope } =\r\n      response.data;\r\n\r\n    const userInfo = await lastValueFrom(\r\n      this.httpService.post('https://kapi.kakao.com/v2/user/me', data, {\r\n        headers: {\r\n          Authorization: `Bearer ${access_token}`,\r\n          'Content-type': 'application/x-www-form-urlencoded;charset=utf-8',\r\n        },\r\n      })\r\n    );\r\n\r\n    console.log(userInfo);\r\n\r\n    const user = this.userService.createOrLogin({\r\n      platform: 'kakao',\r\n      platformUserId: userInfo.data.id,\r\n    });\r\n\r\n    return user;\r\n  }\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\uB85C\uADF8\uC544\uC6C3",children:"\uB85C\uADF8\uC544\uC6C3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:" kakaoLogout() {\r\n    Kakao.Auth.logout()\r\n      .then(function() {\r\n        alert('logout ok\\naccess token -> ' + Kakao.Auth.getAccessToken());\r\n        deleteCookie();\r\n      })\r\n      .catch(function() {\r\n        alert('Not logged in');\r\n      });\r\n    // \uCFE0\uD0A4\uC0AD\uC81C\r\n  }\n"})})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},255511:function(e,n,r){r.d(n,{R:()=>o,x:()=>l});var a=r(596363);let t={},s=a.createContext(t);function o(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);