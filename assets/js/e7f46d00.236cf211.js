"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["823148"],{184190:function(e,r,t){t.r(r),t.d(r,{frontMatter:()=>c,toc:()=>i,default:()=>d,metadata:()=>n,assets:()=>o,contentTitle:()=>u});var n=JSON.parse('{"id":"angular/angular base guard CanActivate","title":"angular guard","description":"\uC778\uD130\uD398\uC774\uC2A4\uB294 deprecated","source":"@site/docs/angular/angular base guard CanActivate.md","sourceDirName":"angular","slug":"/angular/angular base guard CanActivate","permalink":"/docs/angular/angular base guard CanActivate","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"angular directive","permalink":"/docs/angular/angular base directive"},"next":{"title":"angular guard CanDeactivate","permalink":"/docs/angular/angular base guard CanDeactivate"}}'),a=t(447259),s=t(255511);let c={},u="angular guard",o={},i=[{value:"AppModule",id:"appmodule",level:2},{value:"guards/auth.guard.ts",id:"guardsauthguardts",level:2},{value:"app.routes.ts",id:"approutests",level:2}];function l(e){let r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"angular-guard",children:"angular guard"})}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"\uC778\uD130\uD398\uC774\uC2A4\uB294 deprecated"}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"\uD568\uC218\uD615\uC73C\uB85C \uC791\uC131"}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"canActivate => route\uC5D0 \uC811\uADFC\uD560 \uC218 \uC788\uB0D0\uB294 \uB73B && \uB77C\uC6B0\uD305 \uD574\uB3C4 \uB418\uACA0\uB0D0\uB294 \uB73B (activatedRoute : \uD604\uC7AC \uB77C\uC6B0\uD2B8)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:"const canActivateTeam: CanActivateFn = (route: ActivatedRouteSnapshot, state: RouterStateSnapshot) => {\r\n  return inject(PermissionsService).canActivate(inject(UserToken), route.params.id);\r\n};\n"})}),"\n",(0,a.jsx)(r.h2,{id:"appmodule",children:"AppModule"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:'bootstrapApplication(App, {\r\n  providers: [\r\n    provideRouter([\r\n      {\r\n        path: "team/:id",\r\n        component: TeamComponent,\r\n        canActivate: [canActivateTeam],\r\n      },\r\n    ]),\r\n  ],\r\n});\n'})}),"\n",(0,a.jsx)(r.h2,{id:"guardsauthguardts",children:"guards/auth.guard.ts"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:'export const AuthGuard = (next: ActivatedRouteSnapshot) => {\r\n  const store = inject(Store);\r\n  const router = inject(Router);\r\n  const toast = inject(ToastService);\r\n\r\n  const accessToken = localStorage.getItem("accessToken");\r\n  if (!accessToken) {\r\n    router.navigateByUrl("/auth", { replaceUrl: true });\r\n    return false;\r\n  }\r\n\r\n  store\r\n    .select((state) => state.auth.user)\r\n    .subscribe((user) => {\r\n      if (!user) {\r\n        const httpService = inject(HttpService);\r\n        httpService.get<IUserDTO>("auth").subscribe({\r\n          next: (res) => {\r\n            if (res.status === "INACTIVE") {\r\n              router.navigateByUrl("/auth", { replaceUrl: true });\r\n              toast.show("\uBE44\uD65C\uC131\uD654\uB41C \uACC4\uC815\uC785\uB2C8\uB2E4.", "danger");\r\n              return false;\r\n            } else {\r\n              store.dispatch(new SetUser(res));\r\n              return true;\r\n            }\r\n          },\r\n        });\r\n      }\r\n    });\r\n  return true;\r\n};\n'})}),"\n",(0,a.jsx)(r.h2,{id:"approutests",children:"app.routes.ts"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:"canActivate: [AuthGuard],\r\ncanActivateChild: [AuthGuard], // \uC790\uC2DD \uB77C\uC6B0\uD2B8\uC5D0\uB3C4 \uC801\uC6A9\uD558\uAE30\n"})})]})}function d(e={}){let{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},255511:function(e,r,t){t.d(r,{R:()=>c,x:()=>u});var n=t(596363);let a={},s=n.createContext(a);function c(e){let r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function u(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);