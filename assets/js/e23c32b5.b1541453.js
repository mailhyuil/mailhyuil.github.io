"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[766800],{529087:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(596363);const s={},c=r.createContext(s);function o(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(c.Provider,{value:n},e.children)}},652460:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"x design pattern/x event sourcing","title":"event sourcing","description":"\ucd5c\uc885 \uc0c1\ud0dc\ub97c \uc800\uc7a5\ud558\ub294 \uac83\uc774 \uc544\ub2c8\ub77c","source":"@site/docs/x design pattern/x event sourcing.md","sourceDirName":"x design pattern","slug":"/x design pattern/x event sourcing","permalink":"/docs/x design pattern/x event sourcing","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"event sourcing quill-delta","permalink":"/docs/x design pattern/x event sourcing quill-delta"},"next":{"title":"method chaining","permalink":"/docs/x design pattern/x method chaining"}}');var s=t(447259),c=t(529087);const o={},a="event sourcing",i={},d=[{value:"\uc7a5\uc810",id:"\uc7a5\uc810",level:2},{value:"event store",id:"event-store",level:2},{value:"snapshot store",id:"snapshot-store",level:2},{value:"\uad6c\ud604",id:"\uad6c\ud604",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"event-sourcing",children:"event sourcing"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\ucd5c\uc885 \uc0c1\ud0dc\ub97c \uc800\uc7a5\ud558\ub294 \uac83\uc774 \uc544\ub2c8\ub77c"}),"\n",(0,s.jsx)(n.p,{children:"\uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub41c \uacfc\uc815\uc744 \uc804\ubd80 \uae30\ub85d\ud55c\ub2e4."}),"\n",(0,s.jsx)(n.p,{children:"\uc774\ubca4\ud2b8\ub97c Replay\ud558\uc5ec \ucd5c\uc885 \uc0c1\ud0dc\ub97c \uc5bb\ub294\ub2e4."}),"\n",(0,s.jsx)(n.p,{children:"(e.g. [\ud584\ubc84\uac70, \ucf5c\ub77c] vs \ud584\ubc84\uac70 \uc8fc\ubb38 -> \ucf5c\ub77c \uc8fc\ubb38 -> \uac10\uc790\ud280\uae40 \uc8fc\ubb38 -> \uac10\uc790\ud280\uae40 \uc8fc\ubb38\ucde8\uc18c)"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc4f0\uae30\uc758 \uc131\ub2a5\uc774 \ube68\ub9ac\uc9c8 \uc218 \uc788\uc9c0\ub9cc, \uc77d\uae30\uc758 \uc131\ub2a5\uc740 \ub290\ub824\uc9c4\ub2e4."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"update, delete\uac00 \uc5c6\ub2e4. \ubaa8\ub4e0 \ub370\uc774\ud130\ub294 append only\uc774\ub2e4."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"event store\uc640 snapshot store\ub97c \ud544\uc694\ub85c\ud55c\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uc7a5\uc810",children:"\uc7a5\uc810"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"\ub370\uc774\ud130 \uc190\uc2e4 \ubc29\uc9c0: \ubaa8\ub4e0 \uc0c1\ud0dc \ubcc0\uacbd\uc744 \uc774\ubca4\ud2b8\ub85c \uc800\uc7a5\ud558\uc5ec \ub370\uc774\ud130 \uc190\uc2e4\uc744 \ubc29\uc9c0 (zero data loss)\r\n\uc0c1\ud0dc \ubcf5\uc6d0 \uc6a9\uc774\uc131: \uc774\ubca4\ud2b8\ub97c \uc7ac\uc0dd\ud558\uc5ec \uc2dc\uc2a4\ud15c\uc758 \ud604\uc7ac \uc0c1\ud0dc\ub97c \ubcf5\uc6d0\ud558\uac70\ub098 \ud2b9\uc815 \uc2dc\uc810\uc758 \uc0c1\ud0dc\ub97c \uc7ac\uad6c\uc131\r\n\uac10\uc0ac \ubc0f \ucd94\uc801 \uae30\ub2a5 \ud5a5\uc0c1: \ubaa8\ub4e0 \ubcc0\uacbd \uc0ac\ud56d\uc774 \uc774\ubca4\ud2b8\ub85c \uae30\ub85d\ub418\ubbc0\ub85c, \uc2dc\uc2a4\ud15c \ub3d9\uc791\uc758 \ud22c\uba85\uc131\uacfc \uac10\uc0ac \uae30\ub2a5\uc774 \ud5a5\uc0c1\r\n\ube44\uc988\ub2c8\uc2a4 \uc778\uc0ac\uc774\ud2b8 \uc81c\uacf5: \uc774\ubca4\ud2b8 \ub370\uc774\ud130\ub97c \ubd84\uc11d\ud558\uc5ec \uc0c8\ub85c\uc6b4 \ube44\uc988\ub2c8\uc2a4 \uae30\ud68c\ub97c \ubc1c\uacac\ud558\uace0, \uc758\uc0ac \uacb0\uc815\uc5d0 \ud65c\uc6a9\r\n\ud655\uc7a5\uc131\uacfc \uc720\uc5f0\uc131: \uc774\ubca4\ud2b8 \uae30\ubc18 \uc544\ud0a4\ud14d\ucc98\ub97c \ud1b5\ud574 \uc2dc\uc2a4\ud15c \ud655\uc7a5\uc131\uacfc \uc720\uc5f0\uc131\uc744 \ud5a5\uc0c1\n"})}),"\n",(0,s.jsx)(n.h2,{id:"event-store",children:"event store"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc774\ubca4\ud2b8\ub97c \uc800\uc7a5\ud558\ub294 \uc800\uc7a5\uc18c"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc4f0\uae30\ub9cc \uac00\ub2a5\ud558\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"snapshot-store",children:"snapshot store"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc774\ubca4\ud2b8\ub97c \ucc98\uc74c\ubd80\ud130 \uc21c\ud68c\ud558\uba70 \uc0c1\ud0dc\ub97c \uac31\uc2e0\ud558\ub294 \uac83\uc740 \ube44\ud6a8\uc728\uc801\uc774\ub2e4."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uc774\ubca4\ud2b8\ub97c \uc77c\uc815 \uc8fc\uae30\ub9c8\ub2e4 \uc2a4\ub0c5\uc0f7\uc73c\ub85c \uc800\uc7a5\ud558\uace0 \uc774\ud6c4 \uc774\ubca4\ud2b8\ub294 \uc2a4\ub0c5\uc0f7 \uc774\ud6c4\ubd80\ud130 \uc2dc\uc791\ud55c\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uad6c\ud604",children:"\uad6c\ud604"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// \uc774\ubca4\ud2b8 \uc18c\uc2f1\uc744 \uc704\ud55c \ud074\ub798\uc2a4\r\nclass EventSourcing {\r\n  constructor() {\r\n    this.events = [];\r\n    this.currentState = {};\r\n  }\r\n\r\n  // \uc0c1\ud0dc\ub97c \ubcc0\uacbd\ud560 \ub54c\ub9c8\ub2e4 \uc774\ubca4\ud2b8\ub97c \uc800\uc7a5\r\n  addEvent(event) {\r\n    this.events.push(event);\r\n    this.updateState(event);\r\n  }\r\n\r\n  // \uc800\uc7a5\ub41c \uc774\ubca4\ud2b8\ub4e4\uc744 \uc21c\ud68c\ud558\uba70 \uc0c1\ud0dc\ub97c \uac31\uc2e0\r\n  updateState(event) {\r\n    // \uc774\ubca4\ud2b8 \ud0c0\uc785\uc5d0 \ub530\ub77c \uac31\uc2e0 \ubc29\ubc95\uc774 \ub2ec\ub77c\uc9d0\r\n    switch (event.type) {\r\n      case "USER_CREATED":\r\n        this.currentState.user = event.payload;\r\n        break;\r\n      case "USER_UPDATED":\r\n        this.currentState.user = { ...this.currentState.user, ...event.payload };\r\n        break;\r\n      case "PRODUCT_CREATED":\r\n        this.currentState.product = event.payload;\r\n        break;\r\n      case "PRODUCT_UPDATED":\r\n        this.currentState.product = { ...this.currentState.product, ...event.payload };\r\n        break;\r\n      // ...\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\n// \uc774\ubca4\ud2b8 \uc0dd\uc131\uc744 \uc704\ud55c \ud568\uc218\r\nfunction createEvent(type, payload) {\r\n  return { type, payload };\r\n}\r\n\r\n// \uc774\ubca4\ud2b8 \uc18c\uc2f1 \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131\r\nconst eventSourcing = new EventSourcing();\r\n\r\n// \uc774\ubca4\ud2b8 \ucd94\uac00\r\neventSourcing.addEvent(createEvent("USER_CREATED", { name: "John", age: 30 }));\r\neventSourcing.addEvent(createEvent("USER_UPDATED", { age: 31 }));\r\neventSourcing.addEvent(createEvent("PRODUCT_CREATED", { name: "Smartphone", price: 1000 }));\r\neventSourcing.addEvent(createEvent("PRODUCT_UPDATED", { price: 900 }));\r\n\r\n// \ucd5c\uc885 \uc0c1\ud0dc \ucd9c\ub825\r\nconsole.log(eventSourcing.currentState);\n'})})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);