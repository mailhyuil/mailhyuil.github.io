"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["370803"],{616048:function(e,t,r){r.r(t),r.d(t,{frontMatter:()=>s,toc:()=>i,default:()=>m,metadata:()=>n,assets:()=>p,contentTitle:()=>o});var n=JSON.parse('{"id":"typescript/typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30","title":"typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30","description":"typescript\uB294 \uC815\uC801 \uD0C0\uC785 \uC5B8\uC5B4\uC774\uAE30 \uB54C\uBB38\uC5D0 \uB7F0\uD0C0\uC784\uC5D0 \uD0C0\uC785 \uC815\uBCF4\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uB2E4 (\uB7F0\uD0C0\uC784\uC2DC\uC5D0\uB294 \uB2E8\uC21C\uD788 \uC790\uBC14\uC2A4\uD06C\uB9BD\uD2B8\uC774\uB2E4.)","source":"@site/docs/typescript/typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30.md","sourceDirName":"typescript","slug":"/typescript/typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30","permalink":"/docs/typescript/typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"typescript Index Signature & Record","permalink":"/docs/typescript/typescript Index Signature & Record"},"next":{"title":"as type assertion","permalink":"/docs/typescript/typescript as - \uD0C0\uC785 \uB2E8\uC5B8"}}'),a=r(447259),c=r(255511);let s={},o="typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30",p={},i=[{value:"payment.service.ts (namespace \uC0AC\uC6A9)",id:"paymentservicets-namespace-\uC0AC\uC6A9",level:2},{value:"payment.service.ts (reflect-metadata \uC0AC\uC6A9)",id:"paymentservicets-reflect-metadata-\uC0AC\uC6A9",level:2},{value:"payment-button.component.ts",id:"payment-buttoncomponentts",level:2}];function y(e){let t={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"typescript-reflect-class-metadata-\uC0AC\uC6A9\uD558\uAE30",children:"typescript Reflect class metadata \uC0AC\uC6A9\uD558\uAE30"})}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"typescript\uB294 \uC815\uC801 \uD0C0\uC785 \uC5B8\uC5B4\uC774\uAE30 \uB54C\uBB38\uC5D0 \uB7F0\uD0C0\uC784\uC5D0 \uD0C0\uC785 \uC815\uBCF4\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uB2E4 (\uB7F0\uD0C0\uC784\uC2DC\uC5D0\uB294 \uB2E8\uC21C\uD788 \uC790\uBC14\uC2A4\uD06C\uB9BD\uD2B8\uC774\uB2E4.)"}),"\n",(0,a.jsx)(t.p,{children:"java\uAC19\uC740 \uC5B8\uC5B4\uB294 \uCEF4\uD30C\uC77C \uC2DC, \uB7F0\uD0C0\uC784 \uC2DC\uC5D0\uB3C4 \uC815\uC801 \uD0C0\uC785 \uC5B8\uC5B4\uC774\uAE30 \uB54C\uBB38\uC5D0 \uB7F0\uD0C0\uC784\uC5D0\uB3C4 \uD0C0\uC785 \uC815\uBCF4\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC788\uB2E4. (Java\uC758 Reflection API)"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\uADF8\uB807\uAE30 \uB54C\uBB38\uC5D0 \uB7F0\uD0C0\uC784\uC5D0 \uB3D9\uC801\uC73C\uB85C \uBA54\uD0C0\uB370\uC774\uD130\uB97C \uC800\uC7A5\uD558\uC5EC \uC0AC\uC6A9\uD558\uB294 \uBC29\uC2DD\uC73C\uB85C \uC811\uADFC\uD574\uC57C\uD55C\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"paymentservicets-namespace-\uC0AC\uC6A9",children:"payment.service.ts (namespace \uC0AC\uC6A9)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:'import { Injectable } from "@angular/core";\r\n\r\nexport type Lecture = {\r\n  id: number;\r\n  title: string;\r\n  type: "free" | "paid";\r\n  price: number;\r\n};\r\n\r\n@Injectable({\r\n  providedIn: "root",\r\n})\r\nexport class PaymentService {\r\n  paymentStrategy: Record<Lecture["type"], PaymentStrategy>;\r\n\r\n  constructor() {\r\n    const strategies = PaymentStrategy.getImplementations();\r\n    this.paymentStrategy = strategies.reduce((acc, cur) => {\r\n      const instance = new cur();\r\n      acc[instance.type] = instance;\r\n      return acc;\r\n    }, {} as typeof this.paymentStrategy);\r\n  }\r\n\r\n  payment(lecture: Lecture) {\r\n    this.paymentStrategy[lecture.type].payment(lecture);\r\n  }\r\n}\r\n\r\nexport interface PaymentStrategy {\r\n  readonly type: Lecture["type"];\r\n  payment(lecture: Lecture): void;\r\n}\r\n\r\nexport namespace PaymentStrategy {\r\n  type Constructor<T> = {\r\n    new (...args: any[]): T;\r\n    readonly prototype: T;\r\n  };\r\n\r\n  const implementations: Constructor<PaymentStrategy>[] = [];\r\n\r\n  export function getImplementations(): Constructor<PaymentStrategy>[] {\r\n    return implementations;\r\n  }\r\n\r\n  export function register<T extends Constructor<PaymentStrategy>>(constructor: T) {\r\n    implementations.push(constructor);\r\n  }\r\n}\r\n\r\n@PaymentStrategy.register\r\nexport class FreePayment implements PaymentStrategy {\r\n  type: Lecture["type"] = "free";\r\n  constructor() {\r\n    console.log("FreePayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("FreePayment.payment", lecture);\r\n  }\r\n}\r\n\r\n@PaymentStrategy.register\r\nexport class PaidPayment implements PaymentStrategy {\r\n  type: Lecture["type"] = "paid";\r\n  constructor() {\r\n    console.log("PaidPayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("PaidPayment.payment", lecture);\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(t.h2,{id:"paymentservicets-reflect-metadata-\uC0AC\uC6A9",children:"payment.service.ts (reflect-metadata \uC0AC\uC6A9)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:'import { Injectable } from "@angular/core";\r\nimport "reflect-metadata";\r\n\r\nexport type Lecture = {\r\n  id: number;\r\n  title: string;\r\n  type: "free" | "paid";\r\n  price: number;\r\n};\r\n\r\n@Injectable({\r\n  providedIn: "root",\r\n})\r\nexport class PaymentService {\r\n  paymentStrategy: Record<Lecture["type"], PaymentStrategy>;\r\n\r\n  constructor() {\r\n    const strategies = PaymentStrategy.getStrategies();\r\n    this.paymentStrategy = strategies.reduce((acc, cur) => {\r\n      const instance = new cur();\r\n      const type = Reflect.getMetadata("strategy:payment", cur) as Lecture["type"];\r\n      acc[type] = instance;\r\n      return acc;\r\n    }, {} as typeof this.paymentStrategy);\r\n  }\r\n\r\n  payment(lecture: Lecture) {\r\n    this.paymentStrategy[lecture.type].payment(lecture);\r\n  }\r\n}\r\n\r\nnamespace PaymentStrategy {\r\n  type Constructor<T> = {\r\n    new (...args: any[]): T;\r\n    readonly prototype: T;\r\n  };\r\n\r\n  const strategyRegistry: Constructor<PaymentStrategy>[] = [];\r\n  export function getStrategies() {\r\n    return strategyRegistry;\r\n  }\r\n\r\n  export function register(type: Lecture["type"]): ClassDecorator {\r\n    return (target: any) => {\r\n      Reflect.defineMetadata("strategy:payment", type, target);\r\n      strategyRegistry.push(target);\r\n    };\r\n  }\r\n}\r\n\r\nexport interface PaymentStrategy {\r\n  payment(lecture: Lecture): void;\r\n}\r\n\r\n@PaymentStrategy.register("free")\r\nexport class FreePayment implements PaymentStrategy {\r\n  constructor() {\r\n    console.log("FreePayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("FreePayment.payment", lecture);\r\n  }\r\n}\r\n\r\n@PaymentStrategy.register("paid")\r\nexport class PaidPayment implements PaymentStrategy {\r\n  constructor() {\r\n    console.log("PaidPayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("PaidPayment.payment", lecture);\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(t.h2,{id:"payment-buttoncomponentts",children:"payment-button.component.ts"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:'import { CommonModule } from "@angular/common";\r\nimport { Component, Input, inject } from "@angular/core";\r\nimport { PaymentService } from "../../pages/home/payment.service";\r\n\r\n@Component({\r\n  selector: "app-payment-button",\r\n  templateUrl: "./payment-button.component.html",\r\n  styleUrls: ["./payment-button.component.scss"],\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n})\r\nexport default class PaymentButtonComponent {\r\n  @Input() lecture: Lecture;\r\n  paymentService = inject(PaymentService);\r\n  submit() {\r\n    this.paymentService.payment(this.lecture);\r\n  }\r\n}\n'})})]})}function m(e={}){let{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(y,{...e})}):y(e)}},255511:function(e,t,r){r.d(t,{R:()=>s,x:()=>o});var n=r(596363);let a={},c=n.createContext(a);function s(e){let t=n.useContext(c);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(c.Provider,{value:t},e.children)}}}]);