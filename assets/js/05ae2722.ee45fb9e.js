"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[948177],{172848:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"db-prisma/prisma migrate","title":"prisma migrate","description":"\ud504\ub85c\ud1a0\ud0c0\uc774\ud551 \ud560 \ub54c\ub294 \ube60\ub974\uac8c db push\ub97c \ud558\uace0","source":"@site/docs/db-prisma/prisma migrate.md","sourceDirName":"db-prisma","slug":"/db-prisma/prisma migrate","permalink":"/docs/db-prisma/prisma migrate","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"prisma migrate flow","permalink":"/docs/db-prisma/prisma migrate workflow \uc21c\uc11c"},"next":{"title":"prisma \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c","permalink":"/docs/db-prisma/prisma migration \ud30c\uc77c \uc218\uc815"}}');var i=r(447259),a=r(529087);const o={},d="prisma migrate",t={},l=[{value:"dev / deploy",id:"dev--deploy",level:2},{value:"diff",id:"diff",level:2},{value:"resolve",id:"resolve",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"prisma-migrate",children:"prisma migrate"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\ud504\ub85c\ud1a0\ud0c0\uc774\ud551 \ud560 \ub54c\ub294 \ube60\ub974\uac8c db push\ub97c \ud558\uace0"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\uc2e4\uc11c\ubc84 \ubc30\ud3ec \uc804\ub2e8\uacc4\uc5d0\uc11c migrate dev\ub85c \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c \uc0dd\uc131"}),"\n",(0,i.jsx)(n.p,{children:"\uc0dd\uc131\ub41c migration \ud30c\uc77c\uc744 ci/cd\uc5d0\uc11c migrate deploy"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\uc774\ud6c4\ub85c\ub294 \uacc4\uc18d migration dev\ub85c \uac1c\ubc1c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dev--deploy",children:"dev / deploy"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"dev\ub294 \uc2a4\ud0a4\ub9c8 \ubcc0\uacbd\uc744 \uac10\uc9c0\ud574 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c\uc744 \uc0dd\uc131\ud558\uace0 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc801\uc6a9\ud55c\ub2e4."}),"\n",(0,i.jsx)(n.p,{children:"dev\ub294 shadow database\ub97c \uc0ac\uc6a9\ud55c\ub2e4."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"deploy\ub294 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c\uc744 \uc77d\uc5b4\uc11c \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc801\uc6a9\ud55c\ub2e4."}),"\n",(0,i.jsx)(n.p,{children:"deploy\ub294 \ub85c\uceec\uc5d0\uc11c \uc2e4\ud589\ud558\ub294\uac8c \uc544\ub2c8\ub77c ci/cd \ud30c\uc774\ud504\ub77c\uc778\uc5d0\uc11c \uc2e4\ud589\ub418\uc5b4\uc57c\ud55c\ub2e4."}),"\n",(0,i.jsx)(n.p,{children:'deploy\ub294 "development \ub370\uc774\ud130\ubca0\uc774\uc2a4"\ub97c "production \ub370\uc774\ud130\ubca0\uc774\uc2a4"\uc640 sync \ud558\ub294 \uac83'}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"local\uc5d0\uc11c dev\ub97c \uc0ac\uc6a9\ud558\uace0, ci/cd\uc5d0\uc11c deploy\ub97c \uc0ac\uc6a9\ud574 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c\uc744 \uc801\uc6a9\ud558\uc790"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"prisma migrate dev --schema ./prisma\r\nprisma migrate deploy\n"})}),"\n",(0,i.jsx)(n.h2,{id:"diff",children:"diff"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\ubcc0\uacbd"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"npx dotenv -e apps/server/.env.production -- \\\r\nnpx prisma migrate diff \\\r\n--from-migrations prisma/migrations \\\r\n--to-schema-datasource prisma/schema.prisma \\\r\n--shadow-database-url postgres://username:password*@59.3.87.92:5432/my-shadow-db?schema=public \\\r\n--script prisma/migrations/init/migration.sql\n"})}),"\n",(0,i.jsx)(n.h2,{id:"resolve",children:"resolve"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\uc2e4\ud328\ud55c \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c\uc744 marking \ud558\ub294 \uae30\ub2a5"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\uc774\uc804 migration\uc73c\ub85c rollback \ud558\ub294 \uae30\ub2a5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"dotenv -e apps/server/.env.production -- \\\r\nnpx prisma migrate resolve --applied init_migration\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},529087:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var s=r(596363);const i={},a=s.createContext(i);function o(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);