"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[409242],{529087:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>s});var o=r(596363);const c={},t=o.createContext(c);function l(n){const e=o.useContext(t);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:l(n.components),o.createElement(t.Provider,{value:e},n.children)}},982858:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"go/go base goroutine sync","title":"go package sync","description":"Go\uc5d0\uc11c \ub3d9\uc2dc\uc131(concurrency)\uc744 \uc548\uc804\ud558\uac8c \ub2e4\ub8f0 \uc218 \uc788\uac8c \ud574\uc8fc\ub294 \uae30\ubcf8\uc801\uc778 \ub3d9\uae30\ud654 \ub3c4\uad6c\ub4e4\uc744 \uc81c\uacf5","source":"@site/docs/go/go base goroutine sync.md","sourceDirName":"go","slug":"/go/go base goroutine sync","permalink":"/docs/go/go base goroutine sync","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"go base conditional select","permalink":"/docs/go/go base goroutine select"},"next":{"title":"go base goroutine","permalink":"/docs/go/go base goroutine"}}');var c=r(447259),t=r(529087);const l={},s="go package sync",i={},a=[{value:"Mutex",id:"mutex",level:2},{value:"RWMutex",id:"rwmutex",level:2},{value:"Once",id:"once",level:2},{value:"WaitGroup",id:"waitgroup",level:2},{value:"Cond",id:"cond",level:2},{value:"Map",id:"map",level:2},{value:"Pool",id:"pool",level:2}];function d(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"go-package-sync",children:"go package sync"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"Go\uc5d0\uc11c \ub3d9\uc2dc\uc131(concurrency)\uc744 \uc548\uc804\ud558\uac8c \ub2e4\ub8f0 \uc218 \uc788\uac8c \ud574\uc8fc\ub294 \uae30\ubcf8\uc801\uc778 \ub3d9\uae30\ud654 \ub3c4\uad6c\ub4e4\uc744 \uc81c\uacf5"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uba40\ud2f0 \uace0\ub8e8\ud2f4 \ud658\uacbd\uc5d0\uc11c **\ub370\uc774\ud130 \uacbd\uc7c1(race condition)**\uc744 \ud53c\ud558\uae30 \uc704\ud574 \uc544\uc8fc \uc790\uc8fc \uc0ac\uc6a9\ub428"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"mutex",children:"Mutex"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:'\uc77d\uae30/\uc4f0\uae30 \uad00\uacc4\uc5c6\uc774 "\ud55c \ubc88\uc5d0 \ud558\ub098\ub9cc \uc811\uadfc \uac00\ub2a5"\ud55c \ub77d'}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\ub2e8\uc21c\ud568, \uc77d\uae30 \uc791\uc5c5\uc870\ucc28 \ubcd1\ub82c \ucc98\ub9ac \uc548 \ub428"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\ub3d9\uc2dc\uc131\uc774 \ub0ae\uc74c (\ud558\uc9c0\ub9cc \uc548\uc804)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-txt",children:"Lock() \u2192 \ub2e4\ub978 \uace0\ub8e8\ud2f4\uc740 \ub2e4 \ub9c9\ud798\r\nUnlock() \u2192 \ub2e4\uc74c \uace0\ub8e8\ud2f4 \uc2e4\ud589 \uac00\ub2a5\n"})}),"\n",(0,c.jsx)(e.h2,{id:"rwmutex",children:"RWMutex"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uc77d\uae30\uc640 \uc4f0\uae30\ub97c \ubd84\ub9ac\ud574\uc11c \ub354 \ub192\uc740 \ub3d9\uc2dc\uc131 \uc81c\uacf5"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uc77d\uae30 \ub9ce\uc740 \uc0c1\ud669\uc5d0\uc11c \uc131\ub2a5 \u2191"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uc4f0\uae30 \uc911\uc77c \ub550 \uc77d\uae30\ub3c4 \ubabb\ud568"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uc798\ubabb \uc4f0\uba74 \ub370\ub4dc\ub77d \uc0dd\uae30\uae30 \uc26c\uc6c0 (RLock \uc548 \ud480\uac70\ub098, Lock \uc911\ubcf5 \ub4f1)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-txt",children:"RLock() / RUnlock() \u2192 \uc5ec\ub7ec \uace0\ub8e8\ud2f4 \ub3d9\uc2dc \uc77d\uae30 \uac00\ub2a5\r\n\r\nLock() / Unlock() \u2192 \uc4f0\uae30 \uc2dc \ub2e8\ub3c5 \uc810\uc720\n"})}),"\n",(0,c.jsx)(e.h2,{id:"once",children:"Once"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\ud568\uc218\uac00 \ud55c\ubc88\ub9cc \ud638\ucd9c\ub418\ub3c4\ub85d \ubcf4\uc7a5"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\ucd08\uae30\ud654, \uc2f1\uae00\ud1a4 \ud328\ud134 \ub4f1\uc5d0\uc11c \uc720\uc6a9"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:"var once sync.Once\r\nvar instance *Config\r\n\r\nfunc GetConfig() *Config {\r\n\tonce.Do(func() {\r\n\t\tinstance = loadConfig()\r\n\t})\r\n\treturn instance\r\n}\n"})}),"\n",(0,c.jsx)(e.h2,{id:"waitgroup",children:"WaitGroup"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uc5ec\ub7ec \uace0\ub8e8\ud2f4\uc774 \ub05d\ub0a0 \ub54c\uae4c\uc9c0 \ub300\uae30"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:"for i := 0; i < 5; i++ {\r\n\twg.Add(1) // \ud83d\udd25 \uace0\ub8e8\ud2f4 \uc2e4\ud589 \uc804\uc5d0 \ubc18\ub4dc\uc2dc \ud638\ucd9c\r\n\tgo func(i int) {\r\n\t\tdefer wg.Done() // \ud83d\udd25 defer\ub85c \uace0\ub8e8\ud2f4 \uc885\ub8cc \uc2dc \ubc18\ub4dc\uc2dc \ud638\ucd9c\r\n\t\tfmt.Println(i)\r\n\t}(i) // \ud83d\udc48 \ub8e8\ud504 \ubcc0\uc218 \ucea1\uccd0\ub3c4 \ubc29\uc9c0!\r\n}\r\nwg.Wait()\r\n\n"})}),"\n",(0,c.jsx)(e.h2,{id:"cond",children:"Cond"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\uc870\uac74 \ubcc0\uc218"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:'var mu sync.Mutex\r\nvar cond = sync.NewCond(&mu)\r\nvar ready = false\r\n\r\nfunc worker() {\r\n\tmu.Lock()\r\n\tfor !ready {\r\n\t\tcond.Wait() // \uc870\uac74 \ub9cc\uc871 \uc804\uae4c\uc9c0 \ube14\ub85d\r\n\t}\r\n\tfmt.Println("\uc791\uc5c5 \uc2dc\uc791!")\r\n\tmu.Unlock()\r\n}\r\n\r\nfunc main() {\r\n\tgo worker()\r\n\r\n\ttime.Sleep(1 * time.Second)\r\n\tmu.Lock()\r\n\tready = true\r\n\tcond.Signal() // \ud558\ub098 \uae68\uc6c0 (Broadcast()\ub294 \ubaa8\ub450 \uae68\uc6c0)\r\n\tmu.Unlock()\r\n}\n'})}),"\n",(0,c.jsx)(e.h2,{id:"map",children:"Map"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\ub3d9\uc2dc\uc131 \uc548\uc804\ud55c \ub9f5"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:'var m sync.Map\r\n\r\nfunc main() {\r\n\tm.Store("name", "hyuil")\r\n\tm.Store("age", 99)\r\n\r\n\tval, ok := m.Load("name")\r\n\tif ok {\r\n\t\tfmt.Println(val)\r\n\t}\r\n\r\n\tm.Range(func(k, v any) bool {\r\n\t\tfmt.Printf("%v: %v\\n", k, v)\r\n\t\treturn true\r\n\t})\r\n}\n'})}),"\n",(0,c.jsx)(e.h2,{id:"pool",children:"Pool"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\ub3d9\uc2dc\uc131 \uc548\uc804\ud55c \uba54\ubaa8\ub9ac \ud480"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:"var bufPool = sync.Pool{\r\n\tNew: func() any {\r\n\t\treturn new(bytes.Buffer)\r\n\t},\r\n}\r\n\r\nfunc handler() {\r\n\tbuf := bufPool.Get().(*bytes.Buffer) // \uaebc\ub0c4\r\n\tbuf.Reset()\r\n\tdefer bufPool.Put(buf) // \ubc18\ud658\r\n}\n"})})]})}function u(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(d,{...n})}):d(n)}}}]);