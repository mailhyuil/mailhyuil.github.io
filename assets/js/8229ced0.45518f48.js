"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["970039"],{626320:function(n,e,r){r.r(e),r.d(e,{frontMatter:()=>a,toc:()=>l,default:()=>c,metadata:()=>s,assets:()=>p,contentTitle:()=>o});var s=JSON.parse('{"id":"nestjs/nest \uC138\uD305 settings fastify","title":"nest fastify \uC138\uD305","description":"\uB300\uBD80\uBD84\uC758 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB294 \uC798 \uB3D9\uC791\uD558\uC9C0\uB9CC","source":"@site/docs/nestjs/nest \uC138\uD305 settings fastify.md","sourceDirName":"nestjs","slug":"/nestjs/nest \uC138\uD305 settings fastify","permalink":"/docs/nestjs/nest \uC138\uD305 settings fastify","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nest main.ts \uC138\uD305 enhancers","permalink":"/docs/nestjs/nest \uC138\uD305 settings enhancers"},"next":{"title":"prisma","permalink":"/docs/nestjs/nest \uC138\uD305 settings prisma"}}'),t=r(447259),i=r(255511);let a={},o="nest fastify \uC138\uD305",p={},l=[{value:"install",id:"install",level:2},{value:"main.ts",id:"maints",level:2},{value:"logger.middleware.ts",id:"loggermiddlewarets",level:2}];function m(n){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"nest-fastify-\uC138\uD305",children:"nest fastify \uC138\uD305"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\uB300\uBD80\uBD84\uC758 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB294 \uC798 \uB3D9\uC791\uD558\uC9C0\uB9CC"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\uC608\uC678\uC801\uC73C\uB85C main.ts\uC5D0\uC11C \uBBF8\uB4E4\uC6E8\uC5B4\uB85C \uCD94\uAC00\uD558\uB294 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB4E4\uC740 fastify \uC804\uC6A9 \uD328\uD0A4\uC9C0\uB97C \uC0AC\uC6A9\uD574\uC57C\uD55C\uB2E4. (helmet, csrf, multipart, compress, cookie, session \uB4F1)"}),"\n",(0,t.jsx)(e.p,{children:"fastify \uC804\uC6A9 \uBBF8\uB4E4\uC6E8\uC5B4\uB294 express\uBCF4\uB2E4 \uB354 \uCD5C\uC801\uD654\uB418\uC5B4 \uBE60\uB974\uB2E4."}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"jwt\uB294 @nestjs/jwt\uB97C \uC0AC\uC6A9\uD574\uB3C4 \uB418\uC9C0\uB9CC \uB354 \uBE60\uB974\uAC8C \uCC98\uB9AC\uD558\uAE30 \uC704\uD574\uC11C @fastify/jwt\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC788\uC74C"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"install",children:"install"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"################ \uD544\uC218 \uD328\uD0A4\uC9C0 #####################\r\n\r\n# fastify\r\nnpm i @nestjs/platform-fastify\r\n\r\n# security\r\nnpm i @fastify/helmet\r\n# response compression\r\nnpm i @fastify/compress\r\n# cookie\r\nnpm i @fastify/cookie\r\n# file upload\r\nnpm i @fastify/multipart\r\n# jwt\r\nnpm i @fastify/jwt\r\n\r\n# env\r\nnpm i dotenv\r\n\r\n# encryption\r\nnpm i bcrypt\r\nnpm i -D @types/bcrypt\r\n\r\n# validation\r\nnpm i class-validator\r\nnpm i class-transformer\r\nnpm i nestjs-form-data\r\n\r\n# testing\r\nnpm i -D @nestjs/testing\r\nnpm i -D supertest\r\nnpm i -D @types/supertest\r\n\r\n# openapi\r\nnpm i @nestjs/swagger\r\nnpm i ng-openapi-gen\r\nnpm i @apidevtools/json-schema-ref-parser\r\n\r\n# date\r\nnpm i dayjs\r\n\r\n# http\r\nnpm i axios\r\nnpm i @nestjs/axios\r\n\r\n# rate limit\r\nnpm i @nestjs/throttler\r\n\r\n# server cache\r\nnpm i @nestjs/cache-manager\r\nnpm i cache-manager\r\n\r\n# prisma\r\nnpm i @prisma/client\r\nnpm i -D prisma\r\nnpm i prisma-error-enum\r\n\r\n# event\r\nnpm i @nestjs/event-emitter\r\n\r\n# schedule\r\nnpm i @nestjs/schedule\r\n\r\n# nestjs-cls\r\nnpm i nestjs-cls\r\nnpm i @nestjs-cls/transactional\r\nnpm i @nestjs-cls/transactional-adapter-prisma\r\n\r\n# AOP\r\nnpm i @toss/nestjs-aop\r\n\r\n################ \uC120\uD0DD\uC801 \uD328\uD0A4\uC9C0 #####################\r\n\r\n# redis cache\r\nnpm i redis\r\n\r\n# websocket-server\r\nnpm i @nestjs/websockets\r\nnpm i @nestjs/platform-socket.io\r\n# websocket-client\r\nnpm i ngx-socket-io\r\n# npm i socket.io\r\n# npm i socket.io-client\r\n# npm i @types/socket.io\r\n\r\n# message queue\r\nnpm i bull\r\nnpm i @nestjs/bull\r\n\r\n# mongoose\r\nnpm i mongoose\r\nnpm i @nestjs/mongoose\r\n\r\n# drizzle\r\nnpm i drizzle\r\n\r\n# graphql server\r\nnpm i @nestjs/graphql\r\nnpm i @nestjs/apollo\r\nnpm i @apollo/server\r\n# graphql client\r\nnpm i @apollo/client\r\nnpm i apollo-angular\r\n\r\n# image optimize\r\nnpm i sharp\r\nnpm i -D @types/sharp\r\n\r\n# session\r\nnpm i @fastify/secure-session\r\n\r\n# aws-sdk\r\nnpm i aws-sdk\r\nnpm i @aws-sdk/client-s3\r\nnpm i multer-s3\r\n\r\n# CSRF\r\n# npm i @fastify/csrf-protection\r\n\r\n# config\r\n# npm i @nestjs/config\r\n\r\n# npm i -D dotenv-cli\n"})}),"\n",(0,t.jsx)(e.h2,{id:"maints",children:"main.ts"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { INestApplication } from "@nestjs/common";\r\nimport { NestFactory } from "@nestjs/core";\r\nimport { AppModule } from "./app/app.module";\r\nimport { FastifyAdapter, NestFastifyApplication } from "@nestjs/platform-fastify";\r\nimport cookie from "@fastify/cookie";\r\nimport jwt from "@fastify/jwt";\r\nimport helmet from "@fastify/helmet";\r\nimport multipart from "@fastify/multipart";\r\n\r\nconst NODE_ENV = process.env.NODE_ENV;\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create<NestFastifyApplication>(AppModule, new FastifyAdapter());\r\n\r\n  /** Cookie Parser */\r\n  await app.register(cookie);\r\n  /** File Upload */\r\n  await app.register(multipart);\r\n  /** JWT */\r\n  await app.register(jwt, {\r\n    secret: process.env.JWT_SECRET,\r\n  });\r\n  /** Security */\r\n  await app.register(helmet);\r\n  /** Trust Proxy */\r\n  app.set("trust proxy", true);\r\n  /** Global Prefix */\r\n  app.setGlobalPrefix("api");\r\n  /** Versioning */\r\n  app.enableVersioning({\r\n    type: VersioningType.URI,\r\n    defaultVersion: "1", // global fallback version \uC124\uC815\r\n  });\r\n  /** Port */\r\n  const port = process.env.SERVER_PORT || 3000;\r\n  /** OpenAPI */\r\n  initOpenAPI(app, port);\r\n  /** Server Listen */\r\n  await app.listen(port);\r\n  winstonLogger.log(`\u{1F680} Application is running on: http://localhost:${port}/api`);\r\n}\r\n\r\nbootstrap();\n'})}),"\n",(0,t.jsx)(e.h2,{id:"loggermiddlewarets",children:"logger.middleware.ts"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"FastifyRequest, FastifyReply\uB97C \uC0AC\uC6A9"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { Injectable, NestMiddleware } from "@nestjs/common";\r\nimport { FastifyRequest, FastifyReply } from "fastify";\r\n\r\n@Injectable()\r\nexport class LoggerMiddleware implements NestMiddleware {\r\n  use(req: FastifyRequest["raw"], res: FastifyReply["raw"], next: () => void) {\r\n    console.log("Request...");\r\n    next();\r\n  }\r\n}\n'})})]})}function c(n={}){let{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(m,{...n})}):m(n)}},255511:function(n,e,r){r.d(e,{R:()=>a,x:()=>o});var s=r(596363);let t={},i=s.createContext(t);function a(n){let e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);