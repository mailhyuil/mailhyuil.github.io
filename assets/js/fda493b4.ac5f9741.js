"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["303217"],{887877:function(r,e,t){t.r(e),t.d(e,{frontMatter:()=>o,toc:()=>p,default:()=>d,metadata:()=>n,assets:()=>a,contentTitle:()=>u});var n=JSON.parse('{"id":"php wordpress/wordpress rest api custom","title":"wordpress rest api custom","description":"","source":"@site/docs/php wordpress/wordpress rest api custom.md","sourceDirName":"php wordpress","slug":"/php wordpress/wordpress rest api custom","permalink":"/docs/php wordpress/wordpress rest api custom","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"wordpress post type \uC0DD\uC131","permalink":"/docs/php wordpress/wordpress post type \uC0DD\uC131"},"next":{"title":"wordpress headless settings","permalink":"/docs/php wordpress/wordpress \uC138\uD305 settings headless"}}'),s=t(447259),i=t(255511);let o={},u="wordpress rest api custom",a={},p=[];function _(r){let e={code:"code",h1:"h1",header:"header",pre:"pre",...(0,i.R)(),...r.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"wordpress-rest-api-custom",children:"wordpress rest api custom"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"<?php\r\n\r\nadd_action('rest_api_init', 'register_inquiry_routes');\r\n\r\nfunction register_inquiry_routes() {\r\n    // Create Inquiry\r\n    register_rest_route('custom/v1', 'inquiries', array(\r\n        'methods' => WP_REST_Server::CREATABLE,\r\n        'callback' => 'create_inquiry_item',\r\n        'permission_callback' => '__return_true',\r\n    ));\r\n\r\n    // Get All Inquiries\r\n    register_rest_route('custom/v1', 'inquiries', array(\r\n        'methods' => WP_REST_Server::READABLE,\r\n        'callback' => 'get_inquiries',\r\n        'permission_callback' => '__return_true',\r\n    ));\r\n\r\n    // Get Single Inquiry\r\n    register_rest_route('custom/v1', 'inquiries/(?P<id>\\d+)', array(\r\n        'methods' => WP_REST_Server::READABLE,\r\n        'callback' => 'get_inquiry',\r\n        'permission_callback' => '__return_true',\r\n    ));\r\n\r\n    // Update Inquiry\r\n    register_rest_route('custom/v1', 'inquiries/(?P<id>\\d+)', array(\r\n        'methods' => WP_REST_Server::EDITABLE,\r\n        'callback' => 'update_inquiry_item',\r\n        'permission_callback' => '__return_true',\r\n    ));\r\n\r\n    // Delete Inquiry\r\n    register_rest_route('custom/v1', 'inquiries/(?P<id>\\d+)', array(\r\n        'methods' => WP_REST_Server::DELETABLE,\r\n        'callback' => 'delete_inquiry_item',\r\n        'permission_callback' => '__return_true',\r\n    ));\r\n}\r\n\r\n// CREATE - Inquiry \uC0DD\uC131\r\nfunction create_inquiry_item($request) {\r\n    $inquiry = array(\r\n        'post_title' => $request->get_param('title'),\r\n        'post_content' => $request->get_param('content'),\r\n        'post_password' => $request->get_param('password'),\r\n        'post_status' => 'publish',\r\n        'post_type' => 'inquiries',\r\n    );\r\n\r\n    $post_id = wp_insert_post($inquiry);\r\n\r\n    if ($post_id === 0) {\r\n        return new WP_Error('cant-create', 'Can\\'t create inquiry', array('status' => 500));\r\n    }\r\n\r\n    return rest_ensure_response(array(\r\n        'id' => $post_id,\r\n        'title' => $inquiry['post_title'],\r\n        'content' => $inquiry['post_content'],\r\n    ));\r\n}\r\n\r\n// READ - \uBAA8\uB4E0 Inquiry \uC870\uD68C\r\nfunction get_inquiries($request) {\r\n    $args = array(\r\n        'post_type' => 'inquiries',\r\n        'posts_per_page' => -1,\r\n    );\r\n    $query = new WP_Query($args);\r\n    $inquiries = array();\r\n\r\n    while ($query->have_posts()) {\r\n        $query->the_post();\r\n        $inquiries[] = array(\r\n            'id' => get_the_ID(),\r\n            'title' => get_the_title(),\r\n            'content' => get_the_content(),\r\n        );\r\n    }\r\n\r\n    return rest_ensure_response($inquiries);\r\n}\r\n\r\n// READ - \uB2E8\uC77C Inquiry \uC870\uD68C\r\nfunction get_inquiry($request) {\r\n    $post_id = $request->get_param('id');\r\n    $post = get_post($post_id);\r\n\r\n    if (empty($post) || $post->post_type !== 'inquiries') {\r\n        return new WP_Error('no_inquiry', 'Inquiry not found', array('status' => 404));\r\n    }\r\n\r\n    return rest_ensure_response(array(\r\n        'id' => $post->ID,\r\n        'title' => $post->post_title,\r\n        'content' => $post->post_content,\r\n    ));\r\n}\r\n\r\n// UPDATE - Inquiry \uC218\uC815\r\nfunction update_inquiry_item($request) {\r\n    $post_id = $request->get_param('id');\r\n    $post = get_post($post_id);\r\n\r\n    if (empty($post) || $post->post_type !== 'inquiries') {\r\n        return new WP_Error('no_inquiry', 'Inquiry not found', array('status' => 404));\r\n    }\r\n\r\n    $inquiry_data = array(\r\n        'ID' => $post_id,\r\n        'post_title' => $request->get_param('title'),\r\n        'post_content' => $request->get_param('content'),\r\n    );\r\n\r\n    $updated_post_id = wp_update_post($inquiry_data);\r\n\r\n    if (is_wp_error($updated_post_id)) {\r\n        return new WP_Error('cant-update', 'Can\\'t update inquiry', array('status' => 500));\r\n    }\r\n\r\n    return rest_ensure_response(array(\r\n        'id' => $updated_post_id,\r\n        'title' => $request->get_param('title'),\r\n        'content' => $request->get_param('content'),\r\n    ));\r\n}\r\n\r\n// DELETE - Inquiry \uC0AD\uC81C\r\nfunction delete_inquiry_item($request) {\r\n    $post_id = $request->get_param('id');\r\n    $post = get_post($post_id);\r\n\r\n    if (empty($post) || $post->post_type !== 'inquiries') {\r\n        return new WP_Error('no_inquiry', 'Inquiry not found', array('status' => 404));\r\n    }\r\n\r\n    $deleted = wp_delete_post($post_id, true);\r\n\r\n    if (!$deleted) {\r\n        return new WP_Error('cant-delete', 'Can\\'t delete inquiry', array('status' => 500));\r\n    }\r\n\r\n    return rest_ensure_response(array('message' => 'Inquiry deleted successfully.'));\r\n}\n"})})]})}function d(r={}){let{wrapper:e}={...(0,i.R)(),...r.components};return e?(0,s.jsx)(e,{...r,children:(0,s.jsx)(_,{...r})}):_(r)}},255511:function(r,e,t){t.d(e,{R:()=>o,x:()=>u});var n=t(596363);let s={},i=n.createContext(s);function o(r){let e=n.useContext(i);return n.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function u(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(s):r.components||s:o(r.components),n.createElement(i.Provider,{value:e},r.children)}}}]);