"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[649840],{433201:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>E,contentTitle:()=>c,default:()=>a,frontMatter:()=>t,metadata:()=>r,toc:()=>i});const r=JSON.parse('{"id":"db-postgres/postgres lock","title":"postgres base lock","description":"TABLE-LEVEL LOCK","source":"@site/docs/db-postgres/postgres lock.md","sourceDirName":"db-postgres","slug":"/db-postgres/postgres lock","permalink":"/docs/db-postgres/postgres lock","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"postgres SP-GiST index (Space-Partitioned Generalized Search Tree)","permalink":"/docs/db-postgres/postgres index SP-GiST"},"next":{"title":"postgres multi-processing","permalink":"/docs/db-postgres/postgres multi-processing"}}');var o=n(447259),l=n(529087);const t={},c="postgres base lock",E={},i=[{value:"TABLE-LEVEL LOCK",id:"table-level-lock",level:2},{value:"ROW-LEVEL LOCK",id:"row-level-lock",level:2},{value:"PAGE-LEVEL LOCK",id:"page-level-lock",level:2},{value:"Advisory LOCK",id:"advisory-lock",level:2}];function d(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"postgres-base-lock",children:"postgres base lock"})}),"\n",(0,o.jsx)(s.h2,{id:"table-level-lock",children:"TABLE-LEVEL LOCK"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"\ucffc\ub9ac\uc5d0 \ub530\ub77c\uc11c \uc790\ub3d9\uc73c\ub85c \ud68d\ub4dd"}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"ACCESS SHARE -- SELECT \uc2dc \ud68d\ub4dd\r\nROW SHARE -- SELECT FOR UPDATE, SELECT FOR SHARE \uc2dc \ud68d\ub4dd\r\nROW EXCLUSIVE -- UPDATE, DELETE, INSERT \uc2dc \ud68d\ub4dd\r\nSHARE UPDATE EXCLUSIVE -- VACUUM, ANALYZE... \uc2dc \ud68d\ub4dd\r\nSHARE -- CREATE INDEX \uc2dc \ud68d\ub4dd\r\nSHARE ROW EXCLUSIVE -- CREATE COLLATION, CREATE TRIGGER, ALTER TABLE \uc2dc \ud68d\ub4dd\r\nEXCLUSIVE -- REFRESH MATERIALIZED VIEW CONCURRENTLY \uc2dc \ud68d\ub4dd\r\nACCESS EXCLUSIVE -- DROP TABLE, TRUNCATE, REINDEX, CLUSTER, VACUUM FULL, REFRESH MATERIALIZED VIEW... \uc2dc \ud68d\ub4dd\n"})}),"\n",(0,o.jsx)(s.h2,{id:"row-level-lock",children:"ROW-LEVEL LOCK"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"FOR\ubb38\uc744 \ud1b5\ud574\uc11c \ud68d\ub4dd"}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"-- FOR lock_strength [ OF table_name [, ...] ] [ NOWAIT | SKIP LOCKED ] --\r\nSELECT * FROM users WHERE id=1 FOR UPDATE;\r\nSELECT * FROM users WHERE id=1 FOR NO KEY UPDATE;\r\nSELECT * FROM users WHERE id=1 FOR SHARE;\r\nSELECT * FROM users WHERE id=1 FOR KEY SHARE;\n"})}),"\n",(0,o.jsx)(s.h2,{id:"page-level-lock",children:"PAGE-LEVEL LOCK"}),"\n",(0,o.jsx)(s.h2,{id:"advisory-lock",children:"Advisory LOCK"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"\ud2b8\ub79c\uc7ad\uc158 \uc774\uc678 \ub2e4\uc218\uc758 \uc5b4\ud50c\ub9ac\ucf00\uc774\uc158, \uc2dc\uc2a4\ud15c\uc5d0\uc11c \uc218\ud589\ub418\ub294 \ud2b8\ub79c\uc7ad\uc158\ub4e4\uc758 LOCK\uc744 \uc870\uc808\ud558\uae30 \uc704\ud55c LOCK"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"\ubd84\uc0b0\ub77d"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"\uc77c\ubc18\uc801\uc778 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub77d(lock)\uacfc\ub294 \ub2e4\ub974\uac8c \uc0ac\uc6a9\uc790\uac00 \uc9c1\uc811 \uc9c0\uc815\ud558\ub294 \uc7a0\uae08 \uba54\ucee4\ub2c8\uc998"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"-- session level\r\npg_advisory_lock(key bigint)\r\npg_try_advisory_lock(key bigint)\r\npg_advisory_unlock(key bigint)\r\n\r\n-- transaction level\r\npg_advisory_xact_lock(key bigint)\r\npg_try_advisory_xact_lock(key bitint)\n"})})]})}function a(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},529087:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>c});var r=n(596363);const o={},l=r.createContext(o);function t(e){const s=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);