"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["931873"],{838091:function(n,e,r){r.r(e),r.d(e,{frontMatter:()=>s,toc:()=>c,default:()=>i,metadata:()=>o,assets:()=>l,contentTitle:()=>d});var o=JSON.parse('{"id":"nestjs/nest advanced cqrs command","title":"nest CQRS Command","description":"\uC77C\uBC18 \uCEE4\uB9E8\uB4DC \uD328\uD134\uC774 \uC544\uB2CC \uCEE4\uB9E8\uB4DC \uBC84\uC2A4 \uD328\uD134","source":"@site/docs/nestjs/nest advanced cqrs command.md","sourceDirName":"nestjs","slug":"/nestjs/nest advanced cqrs command","permalink":"/docs/nestjs/nest advanced cqrs command","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nest cqrs AggregateRoot","permalink":"/docs/nestjs/nest advanced cqrs AggregateRoot"},"next":{"title":"nest CQRS Event","permalink":"/docs/nestjs/nest advanced cqrs event"}}'),t=r(447259),a=r(255511);let s={},d="nest CQRS Command",l={},c=[{value:"Command",id:"command",level:2},{value:"Command handler",id:"command-handler",level:2},{value:"controller",id:"controller",level:2}];function m(n){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"nest-cqrs-command",children:"nest CQRS Command"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\uC77C\uBC18 \uCEE4\uB9E8\uB4DC \uD328\uD134\uC774 \uC544\uB2CC \uCEE4\uB9E8\uB4DC \uBC84\uC2A4 \uD328\uD134"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"Command\uB294 DTO \uC5ED\uD560\uC744 \uC218\uD589\uD558\uACE0 Handler\uB294 Command\uB97C \uCC98\uB9AC\uD558\uB294 \uC5ED\uD560\uC744 \uC218\uD589\uD55C\uB2E4."}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"Write Transaction\uC758 Trigger \uC5ED\uD560\uC744 \uC218\uD589\uD55C\uB2E4."}),"\n",(0,t.jsx)(e.p,{children:"\uD558\uB098\uC758 Command\uB85C \uB05D\uB0A0 \uC218\uB3C4 \uC788\uACE0, Saga\uB97C \uD1B5\uD574 \uC5EC\uB7EC Command\uB97C \uCC98\uB9AC\uD560 \uC218\uB3C4 \uC788\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"command",children:"Command"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export class KillDragonCommand {\r\n  constructor(public readonly heroId: string, public readonly dragonId: string) {}\r\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"command-handler",children:"Command handler"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { CommandHandler, EventPublisher, ICommandHandler } from "@nestjs/cqrs";\r\nimport { HeroRepository } from "../../repository/hero.repository";\r\nimport { KillDragonCommand } from "../impl/kill-dragon.command";\r\n\r\n@CommandHandler(KillDragonCommand)\r\nexport class KillDragonHandler implements ICommandHandler<KillDragonCommand> {\r\n  constructor(private readonly repository: HeroRepository, private readonly publisher: EventPublisher) {}\r\n\r\n  async execute(command: KillDragonCommand) {\r\n    const { heroId, dragonId } = command;\r\n    const hero = this.publisher.mergeObjectContext(await this.repository.findOneById(+heroId));\r\n    hero.killEnemy(dragonId);\r\n    hero.commit();\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"controller",children:"controller"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { CommandBus } from "@nestjs/cqrs";\r\n\r\n@Controller("hero")\r\nexport class HeroesGameController {\r\n  constructor(private readonly commandBus: CommandBus) {}\r\n\r\n  @Post(":id/kill")\r\n  async killDragon(@Param("id") id: string, @Body() dto: KillDragonDto) {\r\n    return this.commandBus.execute(new KillDragonCommand(id, dto.dragonId));\r\n  }\r\n}\n'})})]})}function i(n={}){let{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(m,{...n})}):m(n)}},255511:function(n,e,r){r.d(e,{R:()=>s,x:()=>d});var o=r(596363);let t={},a=o.createContext(t);function s(n){let e=o.useContext(a);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),o.createElement(a.Provider,{value:e},n.children)}}}]);