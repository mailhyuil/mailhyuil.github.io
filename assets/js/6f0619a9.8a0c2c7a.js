"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[757685],{529087:(n,r,e)=>{e.d(r,{R:()=>s,x:()=>c});var t=e(596363);const o={},i=t.createContext(o);function s(n){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(r):{...r,...n}},[r,n])}function c(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),t.createElement(i.Provider,{value:r},n.children)}},599812:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"logging & monitoring & profiling & tracing/sentry nestjs","title":"nest sentry","description":"\uc5d0\ub7ec \ub85c\uadf8\ub97c slack\uc73c\ub85c \uc804\uc1a1\ud558\ub294 \ubc29\ubc95","source":"@site/docs/logging & monitoring & profiling & tracing/sentry nestjs.md","sourceDirName":"logging & monitoring & profiling & tracing","slug":"/logging & monitoring & profiling & tracing/sentry nestjs","permalink":"/docs/logging & monitoring & profiling & tracing/sentry nestjs","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"sentry integration","permalink":"/docs/logging & monitoring & profiling & tracing/sentry integration"},"next":{"title":"sentry","permalink":"/docs/logging & monitoring & profiling & tracing/sentry"}}');var o=e(447259),i=e(529087);const s={},c="nest sentry",l={},a=[{value:"install",id:"install",level:2},{value:"main.ts",id:"maints",level:2},{value:"error interceptor",id:"error-interceptor",level:2}];function p(n){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"nest-sentry",children:"nest sentry"})}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:"\uc5d0\ub7ec \ub85c\uadf8\ub97c slack\uc73c\ub85c \uc804\uc1a1\ud558\ub294 \ubc29\ubc95"}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"install",children:"install"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-sh",children:"npm i @sentry/node\r\n# npm i nest-raven\r\nnpm i @slack/client\n"})}),"\n",(0,o.jsx)(r.h2,{id:"maints",children:"main.ts"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-ts",children:'import { NestFactory } from "@nestjs/core";\r\nimport { AppModule } from "./app.module";\r\nimport * as Sentry from "@sentry/node";\r\nimport { WebhookInterceptor } from "./common/webhook.interceptor";\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create(AppModule);\r\n  // sentry init\r\n  Sentry.init({\r\n    dsn: process.env.SENTRY_DSN,\r\n  });\r\n  await app.listen(3000);\r\n}\r\nbootstrap();\n'})}),"\n",(0,o.jsx)(r.h2,{id:"error-interceptor",children:"error interceptor"}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:"Sentry.captureException(error)\ub97c \ud1b5\ud574 \uc5d0\ub7ec\ub97c sentry\ub85c \uc804\uc1a1"}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-ts",children:'import { ExecutionContext, Injectable, NestInterceptor, CallHandler } from "@nestjs/common";\r\nimport { Observable } from "rxjs";\r\nimport { catchError } from "rxjs/operators";\r\nimport * as Sentry from "@sentry/minimal";\r\n\r\n@Injectable()\r\nexport class SentryInterceptor implements NestInterceptor {\r\n  intercept(_: ExecutionContext, next: CallHandler): Observable<any> {\r\n    return next.handle().pipe(\r\n      catchError(error => {\r\n        Sentry.captureException(error);\r\n        return null;\r\n      }),\r\n    );\r\n  }\r\n}\n'})})]})}function d(n={}){const{wrapper:r}={...(0,i.R)(),...n.components};return r?(0,o.jsx)(r,{...n,children:(0,o.jsx)(p,{...n})}):p(n)}}}]);