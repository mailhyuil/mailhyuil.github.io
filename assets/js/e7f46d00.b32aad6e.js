"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[611751],{529087:(e,r,t)=>{t.d(r,{R:()=>c,x:()=>u});var n=t(596363);const a={},s=n.createContext(a);function c(e){const r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function u(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),n.createElement(s.Provider,{value:r},e.children)}},814942:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>o,contentTitle:()=>u,default:()=>d,frontMatter:()=>c,metadata:()=>n,toc:()=>i});const n=JSON.parse('{"id":"angular/angular base guard CanActivate","title":"angular guard","description":"\uc778\ud130\ud398\uc774\uc2a4\ub294 deprecated","source":"@site/docs/angular/angular base guard CanActivate.md","sourceDirName":"angular","slug":"/angular/angular base guard CanActivate","permalink":"/docs/angular/angular base guard CanActivate","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"angular directive","permalink":"/docs/angular/angular base directive"},"next":{"title":"angular guard CanDeactivate","permalink":"/docs/angular/angular base guard CanDeactivate"}}');var a=t(447259),s=t(529087);const c={},u="angular guard",o={},i=[{value:"AppModule",id:"appmodule",level:2},{value:"guards/auth.guard.ts",id:"guardsauthguardts",level:2},{value:"app.routes.ts",id:"approutests",level:2}];function l(e){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"angular-guard",children:"angular guard"})}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"\uc778\ud130\ud398\uc774\uc2a4\ub294 deprecated"}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"\ud568\uc218\ud615\uc73c\ub85c \uc791\uc131"}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"canActivate => route\uc5d0 \uc811\uadfc\ud560 \uc218 \uc788\ub0d0\ub294 \ub73b && \ub77c\uc6b0\ud305 \ud574\ub3c4 \ub418\uaca0\ub0d0\ub294 \ub73b (activatedRoute : \ud604\uc7ac \ub77c\uc6b0\ud2b8)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:"const canActivateTeam: CanActivateFn = (route: ActivatedRouteSnapshot, state: RouterStateSnapshot) => {\r\n  return inject(PermissionsService).canActivate(inject(UserToken), route.params.id);\r\n};\n"})}),"\n",(0,a.jsx)(r.h2,{id:"appmodule",children:"AppModule"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:'bootstrapApplication(App, {\r\n  providers: [\r\n    provideRouter([\r\n      {\r\n        path: "team/:id",\r\n        component: TeamComponent,\r\n        canActivate: [canActivateTeam],\r\n      },\r\n    ]),\r\n  ],\r\n});\n'})}),"\n",(0,a.jsx)(r.h2,{id:"guardsauthguardts",children:"guards/auth.guard.ts"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:'export const AuthGuard = (next: ActivatedRouteSnapshot) => {\r\n  const store = inject(Store);\r\n  const router = inject(Router);\r\n  const toast = inject(ToastService);\r\n\r\n  const accessToken = localStorage.getItem("accessToken");\r\n  if (!accessToken) {\r\n    router.navigateByUrl("/auth", { replaceUrl: true });\r\n    return false;\r\n  }\r\n\r\n  store\r\n    .select((state) => state.auth.user)\r\n    .subscribe((user) => {\r\n      if (!user) {\r\n        const httpService = inject(HttpService);\r\n        httpService.get<IUserDTO>("auth").subscribe({\r\n          next: (res) => {\r\n            if (res.status === "INACTIVE") {\r\n              router.navigateByUrl("/auth", { replaceUrl: true });\r\n              toast.show("\ube44\ud65c\uc131\ud654\ub41c \uacc4\uc815\uc785\ub2c8\ub2e4.", "danger");\r\n              return false;\r\n            } else {\r\n              store.dispatch(new SetUser(res));\r\n              return true;\r\n            }\r\n          },\r\n        });\r\n      }\r\n    });\r\n  return true;\r\n};\n'})}),"\n",(0,a.jsx)(r.h2,{id:"approutests",children:"app.routes.ts"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:"canActivate: [AuthGuard],\r\ncanActivateChild: [AuthGuard], // \uc790\uc2dd \ub77c\uc6b0\ud2b8\uc5d0\ub3c4 \uc801\uc6a9\ud558\uae30\n"})})]})}function d(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);