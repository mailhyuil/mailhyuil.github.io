"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["441933"],{323984:function(r,e,n){n.r(e),n.d(e,{frontMatter:()=>o,toc:()=>c,default:()=>d,metadata:()=>s,assets:()=>a,contentTitle:()=>i});var s=JSON.parse('{"id":"graphQL/graphql nestjs code first","title":"nest graphQL","description":"@nestjs/graphql\uC758 \uB370\uCF54\uB808\uC774\uD130\uB85C \uBAA8\uB378\uC744 \uC815\uC758","source":"@site/docs/graphQL/graphql nestjs code first.md","sourceDirName":"graphQL","slug":"/graphQL/graphql nestjs code first","permalink":"/docs/graphQL/graphql nestjs code first","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"graphql naming convention","permalink":"/docs/graphQL/graphql naming convention"},"next":{"title":"graphql nestjs decorator","permalink":"/docs/graphQL/graphql nestjs decorator"}}'),l=n(447259),t=n(255511);let o={},i="nest graphQL",a={},c=[{value:"install",id:"install",level:2},{value:"app.module.ts",id:"appmodulets",level:2},{value:"user.model.ts",id:"usermodelts",level:2},{value:"resolver",id:"resolver",level:2},{value:"client",id:"client",level:2}];function p(r){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...r.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"nest-graphql",children:"nest graphQL"})}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"@nestjs/graphql\uC758 \uB370\uCF54\uB808\uC774\uD130\uB85C \uBAA8\uB378\uC744 \uC815\uC758"}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"\uBAA8\uB378\uC744 resolver\uC5D0\uC11C \uC0AC\uC6A9\uD558\uBA74 \uC790\uB3D9\uC73C\uB85C \uC2A4\uD0A4\uB9C8\uAC00 \uC0DD\uC131\uB428"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"install",children:"install"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sh",children:"npm i graphql\r\n\r\n# server\r\nnpm i @nestjs/graphql\r\nnpm i @nestjs/apollo\r\nnpm i @apollo/server\r\n\r\n# client\r\nnpm i @apollo/client\r\nnpm i apollo-angular\n"})}),"\n",(0,l.jsx)(e.h2,{id:"appmodulets",children:"app.module.ts"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'import { ApolloDriver, ApolloDriverConfig } from "@nestjs/apollo";\r\nimport { GraphQLModule } from "@nestjs/graphql";\r\n\r\n@Module({\r\n  imports: [\r\n    GraphQLModule.forRoot<ApolloDriverConfig>({\r\n      driver: ApolloDriver,\r\n      autoSchemaFile: join(process.cwd(), "apps/server/src/schema.gql"),\r\n      playground: true,\r\n    }),\r\n    UserModule, // UserResolver \uAC00 Provider\uB85C \uB4F1\uB85D\uB418\uC5B4\uC57C \uD568\r\n  ],\r\n  controllers: [],\r\n  providers: [],\r\n})\r\nexport class AppModule {}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"usermodelts",children:"user.model.ts"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'import { Field, ID, ObjectType } from "@nestjs/graphql";\r\n\r\n@Exclude()\r\n@ObjectType()\r\nexport class User {\r\n  @Expose()\r\n  @Field(() => ID)\r\n  id: string;\r\n\r\n  @Expose()\r\n  @Field({ nullable: false })\r\n  username: string;\r\n\r\n  @Expose()\r\n  @Field({ nullable: false })\r\n  email: string;\r\n\r\n  @Expose()\r\n  @Field({ nullable: false })\r\n  password: string;\r\n}\r\n\r\n@InputType()\r\nexport class CreateUserDTO {\r\n  @IsNotEmpty()\r\n  @Field()\r\n  username: string;\r\n\r\n  @IsNotEmpty()\r\n  @Field()\r\n  email: string;\r\n\r\n  @IsNotEmpty()\r\n  @Field()\r\n  password: string;\r\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"resolver",children:"resolver"}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"controller\uB300\uC2E0 resolver \uC0AC\uC6A9"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'import { Args, Mutation, Query, Resolver } from "@nestjs/graphql";\r\nimport { CreateUserDTO, User } from "./user.model";\r\nimport { UserService } from "./user.service";\r\n\r\n@Resolver((of) => User)\r\nexport class UserResolver {\r\n  constructor(private userService: UserService) {}\r\n\r\n  @Query((returns) => User)\r\n  async findById(@Args("id", { type: () => String }) id: string) {\r\n    return await this.userService.findById(id);\r\n  }\r\n\r\n  @Query((returns) => [User])\r\n  async findAll() {\r\n    return await this.userService.findAll();\r\n  }\r\n\r\n  @Mutation((returns) => User)\r\n  async create(@Args("user") user: CreateUserDTO) {\r\n    const createdUser = await this.userService.create(user);\r\n    return createdUser;\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"client",children:"client"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'// query\r\nthis.apollo\r\n  .watchQuery({\r\n    query: gql`\r\n      {\r\n        findAll {\r\n          username\r\n          email\r\n        }\r\n      }\r\n    `,\r\n  })\r\n  .valueChanges.subscribe((user: any) => {\r\n    console.log(user);\r\n  });\r\n// mutation\r\nthis.apollo\r\n  .watchQuery({\r\n    mutation: gql`\r\n      {\r\n        create(user: { username: "hyuil", email: "hyuil@gmail.com", password: "1234" }) {\r\n          username\r\n        }\r\n      }\r\n    `,\r\n  })\r\n  .valueChanges.subscribe((user: any) => {\r\n    console.log(user);\r\n  });\r\n// subscription\n'})})]})}function d(r={}){let{wrapper:e}={...(0,t.R)(),...r.components};return e?(0,l.jsx)(e,{...r,children:(0,l.jsx)(p,{...r})}):p(r)}},255511:function(r,e,n){n.d(e,{R:()=>o,x:()=>i});var s=n(596363);let l={},t=s.createContext(l);function o(r){let e=s.useContext(t);return s.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function i(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(l):r.components||l:o(r.components),s.createElement(t.Provider,{value:e},r.children)}}}]);