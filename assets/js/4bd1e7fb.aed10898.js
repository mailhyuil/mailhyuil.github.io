"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[268836],{529087:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>i});var t=r(596363);const a={},o=t.createContext(a);function s(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(o.Provider,{value:n},e.children)}},859510:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>g,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"javascript/js pagination offset","title":"js offset pagination","description":"\ub2e4\uc591\ud55c \uc815\ub82c \ubc29\uc2dd\uc744 \uc0ac\uc6a9 \uac00\ub2a5","source":"@site/docs/javascript/js pagination offset.md","sourceDirName":"javascript","slug":"/javascript/js pagination offset","permalink":"/docs/javascript/js pagination offset","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"js cursor pagination","permalink":"/docs/javascript/js pagination cursor.md"},"next":{"title":"js polyfill","permalink":"/docs/javascript/js polyfill"}}');var a=r(447259),o=r(529087);const s={},i="js offset pagination",c={},l=[{value:"front-end",id:"front-end",level:2},{value:"controller",id:"controller",level:2},{value:"service",id:"service",level:2},{value:"html",id:"html",level:2}];function p(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"js-offset-pagination",children:"js offset pagination"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\ub2e4\uc591\ud55c \uc815\ub82c \ubc29\uc2dd\uc744 \uc0ac\uc6a9 \uac00\ub2a5"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\ub4a4\ub85c \uac08 \uc218\ub85d \ub290\ub9b0 \ucffc\ub9ac"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"front-end",children:"front-end"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:'const option = ref<IPaginationOptionDTO>({\r\n  pageNo: 1,\r\n  pageSize: 10,\r\n  startDate: dayjs().subtract(10, "year").format("YYYY-MM-DD"),\r\n  endDate: dayjs().format("YYYY-MM-DD HH:mm"),\r\n  query: "",\r\n  type: "ALL",\r\n});\r\n\r\nconst { data: result } = await useApiFetch.get<IPaginationDTO<IPostDTO>>("/post/search", {\r\n  method: "GET",\r\n  query: option.value,\r\n});\n'})}),"\n",(0,a.jsx)(n.h2,{id:"controller",children:"controller"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"export class SomeController {\r\n  async search(@Query() option: PaginationOption) {\r\n    const [entities, count] = await this.someService.search(option);\r\n    return {\r\n      entities,\r\n      pageInfo: {\r\n        currentPage: option.pageNo,\r\n        itemsCount: entities.length,\r\n        itemsPerPage: option.pageSize,\r\n        totalItems: count,\r\n        totalPages: Math.ceil(count / option.pageSize),\r\n      },\r\n    };\r\n  }\r\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"service",children:"service"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:'export class SomeService {\r\n  async search(option: PaginationOptionDTO): Promise<[Post[], number]> {\r\n    const where: Prisma.PostWhereInput = {\r\n      title: { contains: option.query },\r\n      createdAt: {\r\n        lte: dayjs(option.endDate).subtract(9, "hour").toDate(),\r\n        gte: dayjs(option.startDate).subtract(9, "hour").toDate(),\r\n      },\r\n    };\r\n    const count = await this.prismaService.post.count({ where });\r\n    const entities = await this.prismaService.post.findMany({\r\n      where,\r\n      orderBy: {\r\n        createdAt: "desc",\r\n      },\r\n      take: option.pageSize,\r\n      skip: (option.pageNo - 1) * option.pageSize,\r\n    });\r\n    return [entities, count];\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"html",children:"html"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<script lang="ts" setup>\r\n  import _ from "lodash";\r\n  import { PageInfo } from "~/src/interface/type/page-info.type";\r\n\r\n  const props = defineProps<{\r\n    pageInfo: PageInfo;\r\n  }>();\r\n\r\n  const emit = defineEmits(["update:modelValue"]);\r\n\r\n  const pages = ref<number[]>([]);\r\n\r\n  const generateRange = (pageInfo: PageInfo): void => {\r\n    if (pageInfo) {\r\n      if (typeof pageInfo.currentPage === "string") {\r\n        pageInfo.currentPage = parseInt(pageInfo.currentPage as unknown as string, 10);\r\n      }\r\n\r\n      if (typeof pageInfo.totalPages === "string") {\r\n        pageInfo.totalPages = parseInt(pageInfo.totalPages as unknown as string, 10);\r\n      }\r\n\r\n      if (pageInfo.totalPages <= 5) {\r\n        pages.value = [];\r\n        for (let i = 1; i <= pageInfo.totalPages; i++) {\r\n          pages.value.push(i);\r\n        }\r\n      } else if (pageInfo.currentPage > pageInfo.totalPages - 3) {\r\n        pages.value = [];\r\n        for (let i = pageInfo.totalPages - 4; i <= pageInfo.totalPages; i++) {\r\n          pages.value.push(i);\r\n        }\r\n      } else if (pageInfo.currentPage >= 3) {\r\n        pages.value = [];\r\n        for (let i = pageInfo.currentPage - 2; i <= pageInfo.currentPage + 2; i++) {\r\n          pages.value.push(i);\r\n        }\r\n      } else if (pageInfo.currentPage < 3) {\r\n        pages.value = [1, 2, 3, 4, 5];\r\n      }\r\n    }\r\n  };\r\n\r\n  watch(\r\n    props,\r\n    (value) => {\r\n      generateRange(value.pageInfo);\r\n    },\r\n    { deep: true, immediate: true }\r\n  );\r\n\r\n  onMounted(() => generateRange(props.pageInfo));\r\n<\/script>\r\n\r\n<template>\r\n  <div class="relative flex gap-1">\r\n    <div\r\n      v-if="pageInfo.currentPage > 1"\r\n      class="flex h-8 w-8 cursor-pointer select-none items-center justify-center gap-2.5 rounded px-2 py-1 text-gray-600 shadow-sm transition-colors hover:bg-gray-300 hover:text-white"\r\n      @click="emit(\'update:modelValue\', 1)">\r\n      <Icon class="h-3 w-3" name="ic:baseline-keyboard-double-arrow-left" />\r\n    </div>\r\n    <div\r\n      v-if="pageInfo.currentPage > 1"\r\n      class="flex h-8 w-8 cursor-pointer select-none items-center justify-center gap-2.5 rounded px-2 py-1 text-gray-600 shadow-sm transition-colors hover:bg-gray-300 hover:text-white"\r\n      @click="emit(\'update:modelValue\', pageInfo.currentPage - 1)">\r\n      <Icon class="h-3 w-3" name="ic:baseline-keyboard-arrow-left" />\r\n    </div>\r\n    <div\r\n      v-for="page in pages"\r\n      class="flex h-8 w-8 cursor-pointer select-none items-center justify-center gap-2.5 rounded px-2 py-1 shadow-sm transition-colors"\r\n      :class="pageInfo.currentPage === page ? \'bg-primary text-white\' : \'text-gray-600 hover:bg-gray-400 hover:text-white\'"\r\n      @click="emit(\'update:modelValue\', page)">\r\n      {{ page }}\r\n    </div>\r\n    <div\r\n      v-if="pageInfo.currentPage < pageInfo.totalPages"\r\n      class="flex h-8 w-8 cursor-pointer select-none items-center justify-center gap-2.5 rounded px-2 py-1 text-gray-600 shadow-sm transition-colors hover:bg-gray-300 hover:text-white"\r\n      @click="emit(\'update:modelValue\', pageInfo.currentPage + 1)">\r\n      <Icon class="h-3 w-3" name="ic:baseline-keyboard-arrow-right" />\r\n    </div>\r\n    <div\r\n      v-if="pageInfo.currentPage < pageInfo.totalPages"\r\n      class="flex h-8 w-8 cursor-pointer select-none items-center justify-center gap-2.5 rounded px-2 py-1 text-gray-600 shadow-sm transition-colors hover:bg-gray-300 hover:text-white"\r\n      @click="emit(\'update:modelValue\', pageInfo.totalPages)">\r\n      <Icon class="h-3 w-3" name="ic:baseline-keyboard-double-arrow-right" />\r\n    </div>\r\n  </div>\r\n</template>\n'})})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);