"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[987747],{333418:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"react & nextjs/next http interceptor","title":"next middleware api-interceptor","description":"\uc571 \uc2e4\ud589 \uc2dc fetch\ub97c monkey-patch\ud558\uc5ec \ubaa8\ub4e0 \uc694\uccad\uc5d0 \ub300\ud574 interceptor\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.","source":"@site/docs/react & nextjs/next http interceptor.md","sourceDirName":"react & nextjs","slug":"/react & nextjs/next http interceptor","permalink":"/docs/react & nextjs/next http interceptor","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"next guard auth-guard","permalink":"/docs/react & nextjs/next guard"},"next":{"title":"next lazy loading (dynamic, import)","permalink":"/docs/react & nextjs/next lazy load - dynamic, import"}}');var o=n(447259),c=n(529087);const i={},a="next middleware api-interceptor",s={},d=[];function p(e){const t={blockquote:"blockquote",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"next-middleware-api-interceptor",children:"next middleware api-interceptor"})}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsx)(t.p,{children:"\uc571 \uc2e4\ud589 \uc2dc fetch\ub97c monkey-patch\ud558\uc5ec \ubaa8\ub4e0 \uc694\uccad\uc5d0 \ub300\ud574 interceptor\ub97c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4."}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-ts",children:'// \uc608: globalFetchInterceptor.ts (\uc571 \ucd08\uae30 \uc9c4\uc785 \uc2dc \uc2e4\ud589\ub418\uac8c)\r\n\r\nconst originalFetch = window.fetch;\r\n\r\nwindow.fetch = async (input, init) => {\r\n  // \ud83d\udd0d \uc694\uccad \uac00\ub85c\ucc44\uae30\r\n  const token = localStorage.getItem("accessToken");\r\n  const modifiedInit = {\r\n    ...init,\r\n    headers: {\r\n      ...(init?.headers || {}),\r\n      Authorization: token ? `Bearer ${token}` : "",\r\n    },\r\n  };\r\n\r\n  try {\r\n    const response = await originalFetch(input, modifiedInit);\r\n\r\n    // \u2705 \uc751\ub2f5 \uac00\ub85c\ucc44\uae30\r\n    if (response.status === 401) {\r\n      console.warn("\ud1a0\ud070 \ub9cc\ub8cc \ub610\ub294 \uc778\uc99d \uc624\ub958");\r\n      // \uc608: refresh token \uc2dc\ub3c4, \ub85c\uadf8\uc544\uc6c3 \ub4f1\r\n    }\r\n\r\n    return response;\r\n  } catch (error) {\r\n    // \u274c \uc5d0\ub7ec \ucc98\ub9ac\r\n    console.error("Fetch error intercepted:", error);\r\n    throw error;\r\n  }\r\n};\n'})})]})}function l(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},529087:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var r=n(596363);const o={},c=r.createContext(o);function i(e){const t=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(c.Provider,{value:t},e.children)}}}]);