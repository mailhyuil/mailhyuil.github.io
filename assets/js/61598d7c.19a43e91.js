"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["216073"],{559340:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>t,toc:()=>i,default:()=>a,metadata:()=>r,assets:()=>c,contentTitle:()=>E});var r=JSON.parse('{"id":"db-postgres/postgres lock","title":"postgres base lock","description":"TABLE-LEVEL LOCK","source":"@site/docs/db-postgres/postgres lock.md","sourceDirName":"db-postgres","slug":"/db-postgres/postgres lock","permalink":"/docs/db-postgres/postgres lock","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"postgres SP-GiST index (Space-Partitioned Generalized Search Tree)","permalink":"/docs/db-postgres/postgres index SP-GiST"},"next":{"title":"postgres multi-processing","permalink":"/docs/db-postgres/postgres multi-processing"}}'),l=s(447259),o=s(255511);let t={},E="postgres base lock",c={},i=[{value:"TABLE-LEVEL LOCK",id:"table-level-lock",level:2},{value:"ROW-LEVEL LOCK",id:"row-level-lock",level:2},{value:"PAGE-LEVEL LOCK",id:"page-level-lock",level:2},{value:"Advisory LOCK",id:"advisory-lock",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"postgres-base-lock",children:"postgres base lock"})}),"\n",(0,l.jsx)(n.h2,{id:"table-level-lock",children:"TABLE-LEVEL LOCK"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\uCFFC\uB9AC\uC5D0 \uB530\uB77C\uC11C \uC790\uB3D9\uC73C\uB85C \uD68D\uB4DD"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"ACCESS SHARE -- SELECT \uC2DC \uD68D\uB4DD\r\nROW SHARE -- SELECT FOR UPDATE, SELECT FOR SHARE \uC2DC \uD68D\uB4DD\r\nROW EXCLUSIVE -- UPDATE, DELETE, INSERT \uC2DC \uD68D\uB4DD\r\nSHARE UPDATE EXCLUSIVE -- VACUUM, ANALYZE... \uC2DC \uD68D\uB4DD\r\nSHARE -- CREATE INDEX \uC2DC \uD68D\uB4DD\r\nSHARE ROW EXCLUSIVE -- CREATE COLLATION, CREATE TRIGGER, ALTER TABLE \uC2DC \uD68D\uB4DD\r\nEXCLUSIVE -- REFRESH MATERIALIZED VIEW CONCURRENTLY \uC2DC \uD68D\uB4DD\r\nACCESS EXCLUSIVE -- DROP TABLE, TRUNCATE, REINDEX, CLUSTER, VACUUM FULL, REFRESH MATERIALIZED VIEW... \uC2DC \uD68D\uB4DD\n"})}),"\n",(0,l.jsx)(n.h2,{id:"row-level-lock",children:"ROW-LEVEL LOCK"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"FOR\uBB38\uC744 \uD1B5\uD574\uC11C \uD68D\uB4DD"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"-- FOR lock_strength [ OF table_name [, ...] ] [ NOWAIT | SKIP LOCKED ] --\r\nSELECT * FROM users WHERE id=1 FOR UPDATE;\r\nSELECT * FROM users WHERE id=1 FOR NO KEY UPDATE;\r\nSELECT * FROM users WHERE id=1 FOR SHARE;\r\nSELECT * FROM users WHERE id=1 FOR KEY SHARE;\n"})}),"\n",(0,l.jsx)(n.h2,{id:"page-level-lock",children:"PAGE-LEVEL LOCK"}),"\n",(0,l.jsx)(n.h2,{id:"advisory-lock",children:"Advisory LOCK"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\uD2B8\uB79C\uC7AD\uC158 \uC774\uC678 \uB2E4\uC218\uC758 \uC5B4\uD50C\uB9AC\uCF00\uC774\uC158, \uC2DC\uC2A4\uD15C\uC5D0\uC11C \uC218\uD589\uB418\uB294 \uD2B8\uB79C\uC7AD\uC158\uB4E4\uC758 LOCK\uC744 \uC870\uC808\uD558\uAE30 \uC704\uD55C LOCK"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\uBD84\uC0B0\uB77D"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\uC77C\uBC18\uC801\uC778 \uB370\uC774\uD130\uBCA0\uC774\uC2A4 \uB77D(lock)\uACFC\uB294 \uB2E4\uB974\uAC8C \uC0AC\uC6A9\uC790\uAC00 \uC9C1\uC811 \uC9C0\uC815\uD558\uB294 \uC7A0\uAE08 \uBA54\uCEE4\uB2C8\uC998"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"-- session level\r\npg_advisory_lock(key bigint)\r\npg_try_advisory_lock(key bigint)\r\npg_advisory_unlock(key bigint)\r\n\r\n-- transaction level\r\npg_advisory_xact_lock(key bigint)\r\npg_try_advisory_xact_lock(key bitint)\n"})})]})}function a(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},255511:function(e,n,s){s.d(n,{R:()=>t,x:()=>E});var r=s(596363);let l={},o=r.createContext(l);function t(e){let n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function E(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);