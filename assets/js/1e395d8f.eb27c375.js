"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[742520],{412715:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"nestjs/nest auth jwt","title":"nestjs jwt","description":"jwt.io","source":"@site/docs/nestjs/nest auth jwt.md","sourceDirName":"nestjs","slug":"/nestjs/nest auth jwt","permalink":"/docs/nestjs/nest auth jwt","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nestjs jwt","permalink":"/docs/nestjs/nest auth jwt \uc778\uc99d \ub85c\uc9c1"},"next":{"title":"nest session properties","permalink":"/docs/nestjs/nest auth session properties"}}');var t=r(447259),o=r(529087);const l={},i="nestjs jwt",c={},d=[{value:"jwt\uc758 \ubaa9\uc801",id:"jwt\uc758-\ubaa9\uc801",level:2},{value:"jwt \uad6c\uc870",id:"jwt-\uad6c\uc870",level:2},{value:"install",id:"install",level:2},{value:".env",id:"env",level:2},{value:"access-token.module.ts",id:"access-tokenmodulets",level:2},{value:"refresh-token.module.ts",id:"refresh-tokenmodulets",level:2},{value:"app.module.ts",id:"appmodulets",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"nestjs-jwt",children:"nestjs jwt"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://jwt.io/",children:"jwt.io"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://randomkeygen.com/",children:"randomkeygen"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"jwt\uc758 payload\ub294 \ub2e8\uc21c base64\ub85c \uc778\ucf54\ub529\ub418\uc5b4 \uc788\uae30 \ub54c\ubb38\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4\ub97c \ub123\uc73c\uba74 \uc548\ub41c\ub2e4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\uadf8\ub7ec\ub098 signature\ub294 secret\uc744 \uc0ac\uc6a9\ud558\uae30 \ub54c\ubb38\uc5d0 \uac80\uc99d \uac00\ub2a5\ud558\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"jwt\uc758-\ubaa9\uc801",children:"jwt\uc758 \ubaa9\uc801"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"jwt\uc758 \ud575\uc2ec\uc740 \uc0c1\ud0dc\ub97c \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uac00\uc9c0\uace0 \uc788\ub2e4\ub294 \uac83\uc774\ub2e4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"database\uc5d0\uc11c \uc720\uc800\uc758 \uc815\ubcf4\ub97c \uac00\uc838\uc624\uc9c0 \uc54a\uc544\ub3c4 \ub418\uae30 \ub54c\ubb38\uc5d0 (session \ubc29\uc2dd) \uc11c\ubc84\uc758 \ubd80\ud558\ub97c \uc904\uc77c \uc218 \uc788\ub2e4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\ub530\ub77c\uc11c user\uc758 \uc815\ubcf4\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0\uc11c \uc870\ud68c\ud558\uc9c0\ub9d0\uace0 verify\ub41c payload\uc5d0\uc11c \uac00\uc838\uc640\uc57c\ud55c\ub2e4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"refresh token \uc870\ud68c, blacklist \uc870\ud68c\ub3c4 rdbs\uac00 \uc544\ub2cc \uba54\ubaa8\ub9ac db\uc5d0\uc11c \uc870\ud68c\ud558\uba74 \ub354 \ubd80\ud558\ub97c \uc904\uc77c \uc218 \uc788\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"jwt-\uad6c\uc870",children:"jwt \uad6c\uc870"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"secret\uc744 \uc0ac\uc6a9\ud558\uba74 \ub9c8\uc9c0\ub9c9 verify signature \ubd80\ubd84\ub9cc \ubc14\ub010\ub2e4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\uc989 jwt.io \uac19\uc740 \uc0ac\uc774\ud2b8\uc5d0\uc11c header\uc640 payload\ub294 \ud56d\uc0c1 \ud655\uc778\uc774 \uac00\ub2a5\ud558\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.           # header /// \uc54c\uace0\ub9ac\uc998, \ud0c0\uc785\r\neyJpZCI6MSwidXNlcm5hbWUiOiJjb2RlZ2VhciIsImlhdC  # payload /// \ub370\uc774\ud130\r\nI6MTY0MzUxOTI2MCwiZXhwIjoxNjQzNTE5NTYwfQ.       # payload\r\njxsk2FtHsRRhoAZrsUDgHaHOLCxI9IlSMKTrkZ0zUl4     # verify signature /// secret\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc0dd\uc131\ub418\ub294 \ub79c\ub364\ud55c \uac12\n"})}),"\n",(0,t.jsx)(n.h2,{id:"install",children:"install"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"npm i @nestjs/jwt\n"})}),"\n",(0,t.jsx)(n.h2,{id:"env",children:".env"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"JWT_ACCESS_TOKEN_SECRET=VERY_SECRET_ACCESS_TOKEN\r\nJWT_ACCESS_TOKEN_EXPIRES_IN=1h\r\nJWT_REFRESH_TOKEN_SECRET=VERY_SECRET_REFRESH_TOKEN\r\nJWT_REFRESH_TOKEN_EXPIRES_IN=30d\n"})}),"\n",(0,t.jsx)(n.h2,{id:"access-tokenmodulets",children:"access-token.module.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Global, Module, OnModuleInit } from "@nestjs/common";\r\nimport { JwtModule, JwtService } from "@nestjs/jwt";\r\nimport { AccessTokenService } from "./token.token";\r\n\r\nconst secret = process.env["JWT_ACCESS_TOKEN_SECRET"];\r\nconst expiresIn = process.env["JWT_ACCESS_TOKEN_EXPIRES_IN"];\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    JwtModule.register({\r\n      secret,\r\n      signOptions: { expiresIn },\r\n      global: true,\r\n    }),\r\n  ],\r\n  controllers: [],\r\n  providers: [\r\n    {\r\n      provide: AccessTokenService,\r\n      useExisting: JwtService,\r\n    },\r\n  ],\r\n  exports: [AccessTokenService],\r\n})\r\nexport class AccessTokenModule implements OnModuleInit {\r\n  onModuleInit() {\r\n    if (!secret) {\r\n      throw new Error("JWT_ACCESS_TOKEN_SECRET \ud658\uacbd\ubcc0\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");\r\n    }\r\n    if (!expiresIn) {\r\n      throw new Error("JWT_ACCESS_TOKEN_EXPIRES_IN \ud658\uacbd\ubcc0\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"refresh-tokenmodulets",children:"refresh-token.module.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Global, Module, OnModuleInit } from "@nestjs/common";\r\nimport { JwtModule, JwtService } from "@nestjs/jwt";\r\nimport { RefreshTokenService } from "./token.token";\r\n\r\nconst secret = process.env["JWT_REFRESH_TOKEN_SECRET"];\r\nconst expiresIn = process.env["JWT_REFRESH_TOKEN_EXPIRES_IN"];\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    JwtModule.register({\r\n      secret,\r\n      signOptions: { expiresIn },\r\n      global: true,\r\n    }),\r\n  ],\r\n  controllers: [],\r\n  providers: [\r\n    {\r\n      provide: RefreshTokenService,\r\n      useExisting: JwtService,\r\n    },\r\n  ],\r\n  exports: [RefreshTokenService],\r\n})\r\nexport class RefreshTokenModule implements OnModuleInit {\r\n  onModuleInit() {\r\n    if (!secret) {\r\n      throw new Error("JWT_REFRESH_TOKEN_SECRET \ud658\uacbd\ubcc0\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");\r\n    }\r\n    if (!expiresIn) {\r\n      throw new Error("JWT_REFRESH_TOKEN_EXPIRES_IN \ud658\uacbd\ubcc0\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"appmodulets",children:"app.module.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"@Module({\r\n  imports: [AccessTokenModule, RefreshTokenModule],\r\n  controllers: [],\r\n  providers: [],\r\n})\r\nexport class AppModule {}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},529087:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var s=r(596363);const t={},o=s.createContext(t);function l(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);