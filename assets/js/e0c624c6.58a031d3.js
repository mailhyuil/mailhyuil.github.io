"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[652862],{235258:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>n,toc:()=>i});const n=JSON.parse('{"id":"typescript/typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30","title":"typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30","description":"typescript\ub294 \uc815\uc801 \ud0c0\uc785 \uc5b8\uc5b4\uc774\uae30 \ub54c\ubb38\uc5d0 \ub7f0\ud0c0\uc784\uc5d0 \ud0c0\uc785 \uc815\ubcf4\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub2e4 (\ub7f0\ud0c0\uc784\uc2dc\uc5d0\ub294 \ub2e8\uc21c\ud788 \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8\uc774\ub2e4.)","source":"@site/docs/typescript/typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30.md","sourceDirName":"typescript","slug":"/typescript/typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30","permalink":"/docs/typescript/typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"typescript Index Signature & Record","permalink":"/docs/typescript/typescript Index Signature & Record"},"next":{"title":"as type assertion","permalink":"/docs/typescript/typescript as - \ud0c0\uc785 \ub2e8\uc5b8"}}');var a=r(447259),c=r(529087);const s={},o="typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30",p={},i=[{value:"payment.service.ts (namespace \uc0ac\uc6a9)",id:"paymentservicets-namespace-\uc0ac\uc6a9",level:2},{value:"payment.service.ts (reflect-metadata \uc0ac\uc6a9)",id:"paymentservicets-reflect-metadata-\uc0ac\uc6a9",level:2},{value:"payment-button.component.ts",id:"payment-buttoncomponentts",level:2}];function y(e){const t={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"typescript-reflect-class-metadata-\uc0ac\uc6a9\ud558\uae30",children:"typescript Reflect class metadata \uc0ac\uc6a9\ud558\uae30"})}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"typescript\ub294 \uc815\uc801 \ud0c0\uc785 \uc5b8\uc5b4\uc774\uae30 \ub54c\ubb38\uc5d0 \ub7f0\ud0c0\uc784\uc5d0 \ud0c0\uc785 \uc815\ubcf4\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub2e4 (\ub7f0\ud0c0\uc784\uc2dc\uc5d0\ub294 \ub2e8\uc21c\ud788 \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8\uc774\ub2e4.)"}),"\n",(0,a.jsx)(t.p,{children:"java\uac19\uc740 \uc5b8\uc5b4\ub294 \ucef4\ud30c\uc77c \uc2dc, \ub7f0\ud0c0\uc784 \uc2dc\uc5d0\ub3c4 \uc815\uc801 \ud0c0\uc785 \uc5b8\uc5b4\uc774\uae30 \ub54c\ubb38\uc5d0 \ub7f0\ud0c0\uc784\uc5d0\ub3c4 \ud0c0\uc785 \uc815\ubcf4\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub2e4. (Java\uc758 Reflection API)"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\uadf8\ub807\uae30 \ub54c\ubb38\uc5d0 \ub7f0\ud0c0\uc784\uc5d0 \ub3d9\uc801\uc73c\ub85c \uba54\ud0c0\ub370\uc774\ud130\ub97c \uc800\uc7a5\ud558\uc5ec \uc0ac\uc6a9\ud558\ub294 \ubc29\uc2dd\uc73c\ub85c \uc811\uadfc\ud574\uc57c\ud55c\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"paymentservicets-namespace-\uc0ac\uc6a9",children:"payment.service.ts (namespace \uc0ac\uc6a9)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:'import { Injectable } from "@angular/core";\r\n\r\nexport type Lecture = {\r\n  id: number;\r\n  title: string;\r\n  type: "free" | "paid";\r\n  price: number;\r\n};\r\n\r\n@Injectable({\r\n  providedIn: "root",\r\n})\r\nexport class PaymentService {\r\n  paymentStrategy: Record<Lecture["type"], PaymentStrategy>;\r\n\r\n  constructor() {\r\n    const strategies = PaymentStrategy.getImplementations();\r\n    this.paymentStrategy = strategies.reduce((acc, cur) => {\r\n      const instance = new cur();\r\n      acc[instance.type] = instance;\r\n      return acc;\r\n    }, {} as typeof this.paymentStrategy);\r\n  }\r\n\r\n  payment(lecture: Lecture) {\r\n    this.paymentStrategy[lecture.type].payment(lecture);\r\n  }\r\n}\r\n\r\nexport interface PaymentStrategy {\r\n  readonly type: Lecture["type"];\r\n  payment(lecture: Lecture): void;\r\n}\r\n\r\nexport namespace PaymentStrategy {\r\n  type Constructor<T> = {\r\n    new (...args: any[]): T;\r\n    readonly prototype: T;\r\n  };\r\n\r\n  const implementations: Constructor<PaymentStrategy>[] = [];\r\n\r\n  export function getImplementations(): Constructor<PaymentStrategy>[] {\r\n    return implementations;\r\n  }\r\n\r\n  export function register<T extends Constructor<PaymentStrategy>>(constructor: T) {\r\n    implementations.push(constructor);\r\n  }\r\n}\r\n\r\n@PaymentStrategy.register\r\nexport class FreePayment implements PaymentStrategy {\r\n  type: Lecture["type"] = "free";\r\n  constructor() {\r\n    console.log("FreePayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("FreePayment.payment", lecture);\r\n  }\r\n}\r\n\r\n@PaymentStrategy.register\r\nexport class PaidPayment implements PaymentStrategy {\r\n  type: Lecture["type"] = "paid";\r\n  constructor() {\r\n    console.log("PaidPayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("PaidPayment.payment", lecture);\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(t.h2,{id:"paymentservicets-reflect-metadata-\uc0ac\uc6a9",children:"payment.service.ts (reflect-metadata \uc0ac\uc6a9)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:'import { Injectable } from "@angular/core";\r\nimport "reflect-metadata";\r\n\r\nexport type Lecture = {\r\n  id: number;\r\n  title: string;\r\n  type: "free" | "paid";\r\n  price: number;\r\n};\r\n\r\n@Injectable({\r\n  providedIn: "root",\r\n})\r\nexport class PaymentService {\r\n  paymentStrategy: Record<Lecture["type"], PaymentStrategy>;\r\n\r\n  constructor() {\r\n    const strategies = PaymentStrategy.getStrategies();\r\n    this.paymentStrategy = strategies.reduce((acc, cur) => {\r\n      const instance = new cur();\r\n      const type = Reflect.getMetadata("strategy:payment", cur) as Lecture["type"];\r\n      acc[type] = instance;\r\n      return acc;\r\n    }, {} as typeof this.paymentStrategy);\r\n  }\r\n\r\n  payment(lecture: Lecture) {\r\n    this.paymentStrategy[lecture.type].payment(lecture);\r\n  }\r\n}\r\n\r\nnamespace PaymentStrategy {\r\n  type Constructor<T> = {\r\n    new (...args: any[]): T;\r\n    readonly prototype: T;\r\n  };\r\n\r\n  const strategyRegistry: Constructor<PaymentStrategy>[] = [];\r\n  export function getStrategies() {\r\n    return strategyRegistry;\r\n  }\r\n\r\n  export function register(type: Lecture["type"]): ClassDecorator {\r\n    return (target: any) => {\r\n      Reflect.defineMetadata("strategy:payment", type, target);\r\n      strategyRegistry.push(target);\r\n    };\r\n  }\r\n}\r\n\r\nexport interface PaymentStrategy {\r\n  payment(lecture: Lecture): void;\r\n}\r\n\r\n@PaymentStrategy.register("free")\r\nexport class FreePayment implements PaymentStrategy {\r\n  constructor() {\r\n    console.log("FreePayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("FreePayment.payment", lecture);\r\n  }\r\n}\r\n\r\n@PaymentStrategy.register("paid")\r\nexport class PaidPayment implements PaymentStrategy {\r\n  constructor() {\r\n    console.log("PaidPayment init");\r\n  }\r\n  payment(lecture: Lecture) {\r\n    console.log("PaidPayment.payment", lecture);\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(t.h2,{id:"payment-buttoncomponentts",children:"payment-button.component.ts"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:'import { CommonModule } from "@angular/common";\r\nimport { Component, Input, inject } from "@angular/core";\r\nimport { PaymentService } from "../../pages/home/payment.service";\r\n\r\n@Component({\r\n  selector: "app-payment-button",\r\n  templateUrl: "./payment-button.component.html",\r\n  styleUrls: ["./payment-button.component.scss"],\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n})\r\nexport default class PaymentButtonComponent {\r\n  @Input() lecture: Lecture;\r\n  paymentService = inject(PaymentService);\r\n  submit() {\r\n    this.paymentService.payment(this.lecture);\r\n  }\r\n}\n'})})]})}function m(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(y,{...e})}):y(e)}},529087:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>o});var n=r(596363);const a={},c=n.createContext(a);function s(e){const t=n.useContext(c);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(c.Provider,{value:t},e.children)}}}]);