"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["748176"],{627779:function(e,r,n){n.r(r),n.d(r,{frontMatter:()=>a,toc:()=>c,default:()=>p,metadata:()=>t,assets:()=>l,contentTitle:()=>o});var t=JSON.parse('{"id":"spring/Spring Security - \uC2A4\uD504\uB9C1 \uC2DC\uD050\uB9AC\uD2F0","title":"Spring Security (\uC2A4\uD504\uB9C1\uC2DC\uD050\uB9AC\uD2F0)","description":"web.xml filter \uCD94\uAC00","source":"@site/docs/spring/Spring Security - \uC2A4\uD504\uB9C1 \uC2DC\uD050\uB9AC\uD2F0.md","sourceDirName":"spring","slug":"/spring/Spring Security - \uC2A4\uD504\uB9C1 \uC2DC\uD050\uB9AC\uD2F0","permalink":"/docs/spring/Spring Security - \uC2A4\uD504\uB9C1 \uC2DC\uD050\uB9AC\uD2F0","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Spring Security Basic","permalink":"/docs/spring/Spring Security - \uC2A4\uD504\uB9C1 \uC2DC\uD050\uB9AC\uD2F0 basic"},"next":{"title":"Spring basic","permalink":"/docs/spring/Spring basic"}}'),i=n(447259),s=n(255511);let a={},o="Spring Security (\uC2A4\uD504\uB9C1\uC2DC\uD050\uB9AC\uD2F0)",l={},c=[{value:"web.xml filter \uCD94\uAC00",id:"webxml-filter-\uCD94\uAC00",level:2},{value:"root-context \uC124\uC815",id:"root-context-\uC124\uC815",level:2},{value:"UserVO",id:"uservo",level:2},{value:"AuthorityVO",id:"authorityvo",level:2},{value:"UserDetailsServiceImpl",id:"userdetailsserviceimpl",level:2},{value:"AuthenticationProviderImpl",id:"authenticationproviderimpl",level:2},{value:"spring-boot-security-config",id:"spring-boot-security-config",level:2},{value:"old version",id:"old-version",level:3},{value:"new version",id:"new-version",level:3}];function u(e){let r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"spring-security-\uC2A4\uD504\uB9C1\uC2DC\uD050\uB9AC\uD2F0",children:"Spring Security (\uC2A4\uD504\uB9C1\uC2DC\uD050\uB9AC\uD2F0)"})}),"\n",(0,i.jsx)(r.h2,{id:"webxml-filter-\uCD94\uAC00",children:"web.xml filter \uCD94\uAC00"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-xml",children:"<filter>\r\n    <filter-name>springSecurityFilterChain</filter-name>\r\n    <filter-class>\r\n        org.springframework.web.filter.DelegatingFilterProxy\r\n    </filter-class>\r\n</filter>\r\n\r\n<filter-mapping>\r\n    <filter-name>springSecurityFilterChain</filter-name>\r\n    <url-pattern>/*</url-pattern>\r\n</filter-mapping>\n"})}),"\n",(0,i.jsx)(r.h2,{id:"root-context-\uC124\uC815",children:"root-context \uC124\uC815"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-xml",children:'<sec:http auto-config="true" use-expressions="true">\r\n\r\n    <sec:csrf disabled="false"/>\r\n\r\n    <sec:intercept-url pattern="/static/**" access="permitAll" />\r\n\r\n    <sec:intercept-url pattern="/user/login" access="permitAll"/>\r\n    <sec:intercept-url pattern="/user/join" access="permitAll"/>\r\n    <sec:intercept-url pattern="/guest" access="permitAll"/>\r\n    <sec:intercept-url pattern="/" access="permitAll"/>\r\n    <sec:intercept-url pattern="/**" access="isAuthenticated()"/>\r\n\r\n    <sec:form-login login-page="/user/login?error=LOGIN_NEED"\r\n            login-processing-url="/user/login"\r\n            username-parameter="username"\r\n            password-parameter="password"/>\r\n\r\n    <sec:logout\r\n        invalidate-session="true"\r\n        logout-success-url="/"\r\n        delete-cookies="JSESSIONID"\r\n    />\r\n</sec:http>\r\n\r\n<sec:authentication-manager>\r\n    <sec:authentication-provider ref="authenticationProvider"/>\r\n</sec:authentication-manager>\r\n\r\n\x3c!--\r\n<sec:authentication-manager>\r\n    <sec:authentication-provider>\r\n        <sec:user-service>\r\n            <sec:user name="callor"\r\n                    password="{noop}!korea8080" authorities="ROLE_ADMIN"/>\r\n        </sec:user-service>\r\n    </sec:authentication-provider>\r\n</sec:authentication-manager>\r\n    --\x3e\n'})}),"\n",(0,i.jsx)(r.h2,{id:"uservo",children:"UserVO"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:"public class UserVO implements UserDetails  {\r\n\r\n	private static final long serialVersionUID = 1L;\r\n\r\n	private String username;\r\n	private String password;\r\n	private boolean enabled;\r\n	private boolean accountNonExpired;\r\n	private boolean accountNonLocked;\r\n	private boolean credentialsNonExpired;\r\n\r\n	private Collection<? extends GrantedAuthority> authorities;\r\n\r\n	private String email;\r\n	private String tel;\r\n	private String realname;\r\n	private String nickname;\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"authorityvo",children:"AuthorityVO"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:"public class AuthorityVO {\r\n	private long seq;\r\n	private String username;\r\n	private String authority;\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"userdetailsserviceimpl",children:"UserDetailsServiceImpl"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:'public class UserDetailsServiceImpl implements UserDetailsService{\r\n\r\n	private final UserDao userDao;\r\n\r\n	public UserDetailsServiceImpl(UserDao userDao) {\r\n		this.userDao = userDao;\r\n	}\r\n\r\n	/*\r\n	 * \uB85C\uADF8\uC778 \uD55C \uC0AC\uC6A9\uC790\uC758 username \uC744 \uB9E4\uAC1C\uBCC0\uC218\uB85C \uC804\uB2EC\uBC1B\uC544\r\n	 * UserDao \uB97C \uD1B5\uD574 \uB85C\uADF8\uC778\uD55C \uC0AC\uC6A9\uC790 \uC815\uBCF4\uB97C DB \uB85C \uBD80\uD130 \uAC00\uC838\uC628\uB2E4\r\n	 */\r\n	@Override\r\n	public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\r\n		UserVO userVO = userDao.findById(username);\r\n\r\n		if(userVO == null) {\r\n			throw new UsernameNotFoundException(username + " : \uD68C\uC6D0\uAC00\uC785\uC744 \uBA3C\uC800\uD558\uC138\uC694");\r\n		}\r\n\r\n		List<AuthorityVO> authList = userDao.select_auths(username);\r\n\r\n		List<GrantedAuthority> grantList = new ArrayList<>();\r\n\r\n		for(AuthorityVO auth : authList) {\r\n			grantList.add(new SimpleGrantedAuthority(auth.getAuthority()));\r\n		}\r\n\r\n		userVO.setAuthorities(grantList);\r\n\r\n		return userVO;\r\n	}\r\n\r\n}\n'})}),"\n",(0,i.jsx)(r.h2,{id:"authenticationproviderimpl",children:"AuthenticationProviderImpl"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:'public class AuthenticationProviderImpl implements AuthenticationProvider{\r\n\r\n	@Autowired\r\n	@Qualifier("userDetailsService")\r\n	UserDetailsService userService;\r\n\r\n	@Override\r\n	public Authentication authenticate(Authentication authentication) throws AuthenticationException {\r\n		String username = (String) authentication.getPrincipal();\r\n		String password = (String) authentication.getCredentials();\r\n\r\n		UserVO user = (UserVO) userService.loadUserByUsername(username);\r\n\r\n		if(user == null) {\r\n			throw new UsernameNotFoundException(username + "\uC740 \uC874\uC7AC\uD558\uC9C0 \uC54A\uC740 \uC544\uC774\uB514\uC785\uB2C8\uB2E4.");\r\n		}\r\n\r\n		if(user.getPassword().equals(password) == false) {\r\n			throw new BadCredentialsException("\uBE44\uBC00\uBC88\uD638\uAC00 \uD2C0\uB9BD\uB2C8\uB2E4");\r\n		}\r\n\r\n		UsernamePasswordAuthenticationToken\r\n		token = new UsernamePasswordAuthenticationToken(user, password, user.getAuthorities());\r\n\r\n		return token;\r\n	}\r\n\r\n	@Override\r\n	public boolean supports(Class<?> authentication) {\r\n		return true;\r\n	}\r\n\r\n}\n'})}),"\n",(0,i.jsx)(r.h2,{id:"spring-boot-security-config",children:"spring-boot-security-config"}),"\n",(0,i.jsx)(r.h3,{id:"old-version",children:"old version"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:'@EnableWebSecurity\r\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n\r\n    @Override\r\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth.inMemoryAuthentication()\r\n                .withUser("admin")\r\n                .password("1234")\r\n                .roles("admin_role");\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http.\r\n                httpBasic()\r\n                .and()\r\n                .authorizeRequests()\r\n                .antMatchers("/admin/**").hasRole("admin_role")\r\n                .anyRequest().permitAll()\r\n                .and()\r\n                .formLogin();\r\n    }\r\n\r\n    @Bean\r\n    public PasswordEncoder getPasswordEncoder(){\r\n        return NoOpPasswordEncoder.getInstance();\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(r.h3,{id:"new-version",children:"new version"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"HttpSecurity"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:"@Configuration\r\npublic class SecurityConfiguration {\r\n\r\n    @Bean\r\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\r\n        http\r\n            .authorizeHttpRequests((authz) -> authz\r\n                .anyRequest().authenticated()\r\n            )\r\n            .httpBasic(withDefaults());\r\n        return http.build();\r\n    }\r\n\r\n}\n"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"WebSecurityCustomizer"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:'@Configuration\r\npublic class SecurityConfiguration {\r\n\r\n    @Bean\r\n    public WebSecurityCustomizer webSecurityCustomizer() {\r\n        return (web) -> web.ignoring().antMatchers("/ignore1", "/ignore2");\r\n    }\r\n\r\n}\n'})})]})}function p(e={}){let{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},255511:function(e,r,n){n.d(r,{R:()=>a,x:()=>o});var t=n(596363);let i={},s=t.createContext(i);function a(e){let r=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:r},e.children)}}}]);