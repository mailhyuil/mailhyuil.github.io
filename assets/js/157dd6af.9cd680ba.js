"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[551955],{529087:(r,e,n)=>{n.d(e,{R:()=>a,x:()=>o});var t=n(596363);const i={},s=t.createContext(i);function a(r){const e=t.useContext(s);return t.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function o(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(i):r.components||i:a(r.components),t.createElement(s.Provider,{value:e},r.children)}},566333:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"spring/Spring Security - \uc2a4\ud504\ub9c1 \uc2dc\ud050\ub9ac\ud2f0","title":"Spring Security (\uc2a4\ud504\ub9c1\uc2dc\ud050\ub9ac\ud2f0)","description":"web.xml filter \ucd94\uac00","source":"@site/docs/spring/Spring Security - \uc2a4\ud504\ub9c1 \uc2dc\ud050\ub9ac\ud2f0.md","sourceDirName":"spring","slug":"/spring/Spring Security - \uc2a4\ud504\ub9c1 \uc2dc\ud050\ub9ac\ud2f0","permalink":"/docs/spring/Spring Security - \uc2a4\ud504\ub9c1 \uc2dc\ud050\ub9ac\ud2f0","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Spring Security Basic","permalink":"/docs/spring/Spring Security - \uc2a4\ud504\ub9c1 \uc2dc\ud050\ub9ac\ud2f0 basic"},"next":{"title":"Spring basic","permalink":"/docs/spring/Spring basic"}}');var i=n(447259),s=n(529087);const a={},o="Spring Security (\uc2a4\ud504\ub9c1\uc2dc\ud050\ub9ac\ud2f0)",c={},l=[{value:"web.xml filter \ucd94\uac00",id:"webxml-filter-\ucd94\uac00",level:2},{value:"root-context \uc124\uc815",id:"root-context-\uc124\uc815",level:2},{value:"UserVO",id:"uservo",level:2},{value:"AuthorityVO",id:"authorityvo",level:2},{value:"UserDetailsServiceImpl",id:"userdetailsserviceimpl",level:2},{value:"AuthenticationProviderImpl",id:"authenticationproviderimpl",level:2},{value:"spring-boot-security-config",id:"spring-boot-security-config",level:2},{value:"old version",id:"old-version",level:3},{value:"new version",id:"new-version",level:3}];function u(r){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",pre:"pre",ul:"ul",...(0,s.R)(),...r.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"spring-security-\uc2a4\ud504\ub9c1\uc2dc\ud050\ub9ac\ud2f0",children:"Spring Security (\uc2a4\ud504\ub9c1\uc2dc\ud050\ub9ac\ud2f0)"})}),"\n",(0,i.jsx)(e.h2,{id:"webxml-filter-\ucd94\uac00",children:"web.xml filter \ucd94\uac00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<filter>\r\n    <filter-name>springSecurityFilterChain</filter-name>\r\n    <filter-class>\r\n        org.springframework.web.filter.DelegatingFilterProxy\r\n    </filter-class>\r\n</filter>\r\n\r\n<filter-mapping>\r\n    <filter-name>springSecurityFilterChain</filter-name>\r\n    <url-pattern>/*</url-pattern>\r\n</filter-mapping>\n"})}),"\n",(0,i.jsx)(e.h2,{id:"root-context-\uc124\uc815",children:"root-context \uc124\uc815"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<sec:http auto-config="true" use-expressions="true">\r\n\r\n    <sec:csrf disabled="false"/>\r\n\r\n    <sec:intercept-url pattern="/static/**" access="permitAll" />\r\n\r\n    <sec:intercept-url pattern="/user/login" access="permitAll"/>\r\n    <sec:intercept-url pattern="/user/join" access="permitAll"/>\r\n    <sec:intercept-url pattern="/guest" access="permitAll"/>\r\n    <sec:intercept-url pattern="/" access="permitAll"/>\r\n    <sec:intercept-url pattern="/**" access="isAuthenticated()"/>\r\n\r\n    <sec:form-login login-page="/user/login?error=LOGIN_NEED"\r\n            login-processing-url="/user/login"\r\n            username-parameter="username"\r\n            password-parameter="password"/>\r\n\r\n    <sec:logout\r\n        invalidate-session="true"\r\n        logout-success-url="/"\r\n        delete-cookies="JSESSIONID"\r\n    />\r\n</sec:http>\r\n\r\n<sec:authentication-manager>\r\n    <sec:authentication-provider ref="authenticationProvider"/>\r\n</sec:authentication-manager>\r\n\r\n\x3c!--\r\n<sec:authentication-manager>\r\n    <sec:authentication-provider>\r\n        <sec:user-service>\r\n            <sec:user name="callor"\r\n                    password="{noop}!korea8080" authorities="ROLE_ADMIN"/>\r\n        </sec:user-service>\r\n    </sec:authentication-provider>\r\n</sec:authentication-manager>\r\n    --\x3e\n'})}),"\n",(0,i.jsx)(e.h2,{id:"uservo",children:"UserVO"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class UserVO implements UserDetails  {\r\n\r\n\tprivate static final long serialVersionUID = 1L;\r\n\r\n\tprivate String username;\r\n\tprivate String password;\r\n\tprivate boolean enabled;\r\n\tprivate boolean accountNonExpired;\r\n\tprivate boolean accountNonLocked;\r\n\tprivate boolean credentialsNonExpired;\r\n\r\n\tprivate Collection<? extends GrantedAuthority> authorities;\r\n\r\n\tprivate String email;\r\n\tprivate String tel;\r\n\tprivate String realname;\r\n\tprivate String nickname;\r\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"authorityvo",children:"AuthorityVO"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class AuthorityVO {\r\n\tprivate long seq;\r\n\tprivate String username;\r\n\tprivate String authority;\r\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"userdetailsserviceimpl",children:"UserDetailsServiceImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserDetailsServiceImpl implements UserDetailsService{\r\n\r\n\tprivate final UserDao userDao;\r\n\r\n\tpublic UserDetailsServiceImpl(UserDao userDao) {\r\n\t\tthis.userDao = userDao;\r\n\t}\r\n\r\n\t/*\r\n\t * \ub85c\uadf8\uc778 \ud55c \uc0ac\uc6a9\uc790\uc758 username \uc744 \ub9e4\uac1c\ubcc0\uc218\ub85c \uc804\ub2ec\ubc1b\uc544\r\n\t * UserDao \ub97c \ud1b5\ud574 \ub85c\uadf8\uc778\ud55c \uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c DB \ub85c \ubd80\ud130 \uac00\uc838\uc628\ub2e4\r\n\t */\r\n\t@Override\r\n\tpublic UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\r\n\t\tUserVO userVO = userDao.findById(username);\r\n\r\n\t\tif(userVO == null) {\r\n\t\t\tthrow new UsernameNotFoundException(username + " : \ud68c\uc6d0\uac00\uc785\uc744 \uba3c\uc800\ud558\uc138\uc694");\r\n\t\t}\r\n\r\n\t\tList<AuthorityVO> authList = userDao.select_auths(username);\r\n\r\n\t\tList<GrantedAuthority> grantList = new ArrayList<>();\r\n\r\n\t\tfor(AuthorityVO auth : authList) {\r\n\t\t\tgrantList.add(new SimpleGrantedAuthority(auth.getAuthority()));\r\n\t\t}\r\n\r\n\t\tuserVO.setAuthorities(grantList);\r\n\r\n\t\treturn userVO;\r\n\t}\r\n\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"authenticationproviderimpl",children:"AuthenticationProviderImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class AuthenticationProviderImpl implements AuthenticationProvider{\r\n\r\n\t@Autowired\r\n\t@Qualifier("userDetailsService")\r\n\tUserDetailsService userService;\r\n\r\n\t@Override\r\n\tpublic Authentication authenticate(Authentication authentication) throws AuthenticationException {\r\n\t\tString username = (String) authentication.getPrincipal();\r\n\t\tString password = (String) authentication.getCredentials();\r\n\r\n\t\tUserVO user = (UserVO) userService.loadUserByUsername(username);\r\n\r\n\t\tif(user == null) {\r\n\t\t\tthrow new UsernameNotFoundException(username + "\uc740 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc740 \uc544\uc774\ub514\uc785\ub2c8\ub2e4.");\r\n\t\t}\r\n\r\n\t\tif(user.getPassword().equals(password) == false) {\r\n\t\t\tthrow new BadCredentialsException("\ube44\ubc00\ubc88\ud638\uac00 \ud2c0\ub9bd\ub2c8\ub2e4");\r\n\t\t}\r\n\r\n\t\tUsernamePasswordAuthenticationToken\r\n\t\ttoken = new UsernamePasswordAuthenticationToken(user, password, user.getAuthorities());\r\n\r\n\t\treturn token;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic boolean supports(Class<?> authentication) {\r\n\t\treturn true;\r\n\t}\r\n\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"spring-boot-security-config",children:"spring-boot-security-config"}),"\n",(0,i.jsx)(e.h3,{id:"old-version",children:"old version"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@EnableWebSecurity\r\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n\r\n    @Override\r\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth.inMemoryAuthentication()\r\n                .withUser("admin")\r\n                .password("1234")\r\n                .roles("admin_role");\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http.\r\n                httpBasic()\r\n                .and()\r\n                .authorizeRequests()\r\n                .antMatchers("/admin/**").hasRole("admin_role")\r\n                .anyRequest().permitAll()\r\n                .and()\r\n                .formLogin();\r\n    }\r\n\r\n    @Bean\r\n    public PasswordEncoder getPasswordEncoder(){\r\n        return NoOpPasswordEncoder.getInstance();\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"new-version",children:"new version"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"HttpSecurity"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\r\npublic class SecurityConfiguration {\r\n\r\n    @Bean\r\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\r\n        http\r\n            .authorizeHttpRequests((authz) -> authz\r\n                .anyRequest().authenticated()\r\n            )\r\n            .httpBasic(withDefaults());\r\n        return http.build();\r\n    }\r\n\r\n}\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"WebSecurityCustomizer"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\r\npublic class SecurityConfiguration {\r\n\r\n    @Bean\r\n    public WebSecurityCustomizer webSecurityCustomizer() {\r\n        return (web) -> web.ignoring().antMatchers("/ignore1", "/ignore2");\r\n    }\r\n\r\n}\n'})})]})}function p(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,i.jsx)(e,{...r,children:(0,i.jsx)(u,{...r})}):u(r)}}}]);