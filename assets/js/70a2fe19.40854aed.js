"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["608967"],{941364:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>i,toc:()=>l,default:()=>d,metadata:()=>r,assets:()=>u,contentTitle:()=>o});var r=JSON.parse('{"id":"kubernetes/kube Auth User & Group","title":"\uC720\uC800 \uC778\uC99D (Authentication)","description":"client \uC720\uC800\uAC00 kubernetes API \uC11C\uBC84\uC5D0 \uC811\uADFC\uD560 \uB54C \uC778\uC99D","source":"@site/docs/kubernetes/kube Auth User & Group.md","sourceDirName":"kubernetes","slug":"/kubernetes/kube Auth User & Group","permalink":"/docs/kubernetes/kube Auth User & Group","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Service Account for Pod","permalink":"/docs/kubernetes/kube Auth ServiceAccount for Pod"},"next":{"title":"kubernetes Calico","permalink":"/docs/kubernetes/kube CNI Calico"}}'),s=t(447259),c=t(255511);let i={},o="\uC720\uC800 \uC778\uC99D (Authentication)",u={},l=[{value:"\uC0DD\uC131",id:"\uC0DD\uC131",level:2},{value:".kube/config\uC5D0 \uCD94\uAC00",id:"kubeconfig\uC5D0-\uCD94\uAC00",level:2}];function a(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\uC720\uC800-\uC778\uC99D-authentication",children:"\uC720\uC800 \uC778\uC99D (Authentication)"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"client \uC720\uC800\uAC00 kubernetes API \uC11C\uBC84\uC5D0 \uC811\uADFC\uD560 \uB54C \uC778\uC99D"}),"\n",(0,s.jsx)(n.p,{children:"CSR \uC778\uC99D\uC11C\uB97C \uD1B5\uD574 \uC778\uC99D"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC720\uC800\uB124\uC784\uACFC \uC778\uC99D\uC11C \uC0DD\uC131 -> CSR(Certificate Signing Request) \uC778\uC99D\uC11C \uC0DD\uC131 -> Role -> RoleBinding"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"~/.kube/config \uD30C\uC77C\uC5D0 \uC0AC\uC6A9\uC790 \uC815\uBCF4\uAC00 \uC800\uC7A5\uB418\uC5B4 \uC788\uC74C"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"set-credentials, get-users"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"\uC778\uC99D\uC11C-\uD0A4-\uC0DD\uC131",children:"\uC778\uC99D\uC11C \uD0A4 \uC0DD\uC131"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# \uD0A4 \uC0DD\uC131\r\nopenssl genrsa -out <\uC778\uC99D\uC11C\uC774\uB984>.key 2048\r\n\r\n# csr \uC694\uCCAD \uD30C\uC77C \uC0DD\uC131\r\nopenssl req -new -key <\uC778\uC99D\uC11C\uC774\uB984>.key -out <\uC778\uC99D\uC11C\uC774\uB984>.csr -subj "/CN=<\uC778\uC99D\uC11C\uC774\uB984>"\r\n\r\n# csr file content\uB97C base64\uB85C \uC778\uCF54\uB529 (certificate-signing-request.yaml \uD30C\uC77C\uC758 request\uC5D0 \uBD99\uC5EC\uB123\uAE30)\r\ncat <\uC778\uC99D\uC11C\uC774\uB984>.csr | base64 | tr -d "\\n"\n'})}),"\n",(0,s.jsx)(n.h1,{id:"csr-\uC0DD\uC131",children:"CSR \uC0DD\uC131"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cat > certificate-signing-request.yaml\r\napiVersion: certificates.k8s.io/v1\r\nkind: CertificateSigningRequest\r\nmetadata:\r\n  name: <\uC720\uC800\uC774\uB984>\r\nspec:\r\n  request: <csr base64 \uC778\uCF54\uB529>\r\n  signerName: kubernetes.io/kube-apiserver-client\r\n  expirationSeconds: 86400  # one day\r\n  usages:\r\n  - client auth\r\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\uC0DD\uC131",children:"\uC0DD\uC131"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# \uC694\uCCAD\r\nkubectl apply -f <\uC778\uC99D\uC11C\uC774\uB984>.yaml\r\n\r\n# \uC694\uCCAD\uC744 \uC2B9\uC778\r\nkubectl certificate approve <\uC720\uC800\uC774\uB984>\r\n\r\n# \uD655\uC778\r\nkubectl get csr\r\n\r\n# \uC2B9\uC778\uB41C csr \uC778\uC99D\uC11C\uB97C \uC720\uC800\uC758 crt \uD30C\uC77C\uB85C \uC800\uC7A5\r\nkubectl get csr <\uC720\uC800\uC774\uB984> -o jsonpath='{.status.certificate}'| base64 -d > <\uC720\uC800\uC774\uB984>.crt\n"})}),"\n",(0,s.jsx)(n.h2,{id:"kubeconfig\uC5D0-\uCD94\uAC00",children:".kube/config\uC5D0 \uCD94\uAC00"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kubectl config set-credentials <\uC720\uC800\uC774\uB984> --client-key=<\uC720\uC800\uC774\uB984>.key --client-certificate=<\uC720\uC800\uC774\uB984>.crt --embed-certs=true\r\n\r\nkubectl config set-context <\uC720\uC800\uC774\uB984> --cluster=kubernetes --user=<\uC720\uC800\uC774\uB984>\r\n\r\nkubectl config use-context <\uC720\uC800\uC774\uB984>\n"})})]})}function d(e={}){let{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},255511:function(e,n,t){t.d(n,{R:()=>i,x:()=>o});var r=t(596363);let s={},c=r.createContext(s);function i(e){let n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);