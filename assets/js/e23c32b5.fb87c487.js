"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["622825"],{241614:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>o,toc:()=>l,default:()=>u,metadata:()=>r,assets:()=>i,contentTitle:()=>a});var r=JSON.parse('{"id":"x design pattern/x event sourcing","title":"event sourcing","description":"\uCD5C\uC885 \uC0C1\uD0DC\uB97C \uC800\uC7A5\uD558\uB294 \uAC83\uC774 \uC544\uB2C8\uB77C","source":"@site/docs/x design pattern/x event sourcing.md","sourceDirName":"x design pattern","slug":"/x design pattern/x event sourcing","permalink":"/docs/x design pattern/x event sourcing","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"event sourcing quill-delta","permalink":"/docs/x design pattern/x event sourcing quill-delta"},"next":{"title":"method chaining","permalink":"/docs/x design pattern/x method chaining"}}'),s=t(447259),c=t(255511);let o={},a="event sourcing",i={},l=[{value:"\uC7A5\uC810",id:"\uC7A5\uC810",level:2},{value:"event store",id:"event-store",level:2},{value:"snapshot store",id:"snapshot-store",level:2},{value:"\uAD6C\uD604",id:"\uAD6C\uD604",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"event-sourcing",children:"event sourcing"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uCD5C\uC885 \uC0C1\uD0DC\uB97C \uC800\uC7A5\uD558\uB294 \uAC83\uC774 \uC544\uB2C8\uB77C"}),"\n",(0,s.jsx)(n.p,{children:"\uC0C1\uD0DC\uAC00 \uBCC0\uACBD\uB41C \uACFC\uC815\uC744 \uC804\uBD80 \uAE30\uB85D\uD55C\uB2E4."}),"\n",(0,s.jsx)(n.p,{children:"\uC774\uBCA4\uD2B8\uB97C Replay\uD558\uC5EC \uCD5C\uC885 \uC0C1\uD0DC\uB97C \uC5BB\uB294\uB2E4."}),"\n",(0,s.jsx)(n.p,{children:"(e.g. [\uD584\uBC84\uAC70, \uCF5C\uB77C] vs \uD584\uBC84\uAC70 \uC8FC\uBB38 -> \uCF5C\uB77C \uC8FC\uBB38 -> \uAC10\uC790\uD280\uAE40 \uC8FC\uBB38 -> \uAC10\uC790\uD280\uAE40 \uC8FC\uBB38\uCDE8\uC18C)"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC4F0\uAE30\uC758 \uC131\uB2A5\uC774 \uBE68\uB9AC\uC9C8 \uC218 \uC788\uC9C0\uB9CC, \uC77D\uAE30\uC758 \uC131\uB2A5\uC740 \uB290\uB824\uC9C4\uB2E4."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"update, delete\uAC00 \uC5C6\uB2E4. \uBAA8\uB4E0 \uB370\uC774\uD130\uB294 append only\uC774\uB2E4."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"event store\uC640 snapshot store\uB97C \uD544\uC694\uB85C\uD55C\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uC7A5\uC810",children:"\uC7A5\uC810"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"\uB370\uC774\uD130 \uC190\uC2E4 \uBC29\uC9C0: \uBAA8\uB4E0 \uC0C1\uD0DC \uBCC0\uACBD\uC744 \uC774\uBCA4\uD2B8\uB85C \uC800\uC7A5\uD558\uC5EC \uB370\uC774\uD130 \uC190\uC2E4\uC744 \uBC29\uC9C0 (zero data loss)\r\n\uC0C1\uD0DC \uBCF5\uC6D0 \uC6A9\uC774\uC131: \uC774\uBCA4\uD2B8\uB97C \uC7AC\uC0DD\uD558\uC5EC \uC2DC\uC2A4\uD15C\uC758 \uD604\uC7AC \uC0C1\uD0DC\uB97C \uBCF5\uC6D0\uD558\uAC70\uB098 \uD2B9\uC815 \uC2DC\uC810\uC758 \uC0C1\uD0DC\uB97C \uC7AC\uAD6C\uC131\r\n\uAC10\uC0AC \uBC0F \uCD94\uC801 \uAE30\uB2A5 \uD5A5\uC0C1: \uBAA8\uB4E0 \uBCC0\uACBD \uC0AC\uD56D\uC774 \uC774\uBCA4\uD2B8\uB85C \uAE30\uB85D\uB418\uBBC0\uB85C, \uC2DC\uC2A4\uD15C \uB3D9\uC791\uC758 \uD22C\uBA85\uC131\uACFC \uAC10\uC0AC \uAE30\uB2A5\uC774 \uD5A5\uC0C1\r\n\uBE44\uC988\uB2C8\uC2A4 \uC778\uC0AC\uC774\uD2B8 \uC81C\uACF5: \uC774\uBCA4\uD2B8 \uB370\uC774\uD130\uB97C \uBD84\uC11D\uD558\uC5EC \uC0C8\uB85C\uC6B4 \uBE44\uC988\uB2C8\uC2A4 \uAE30\uD68C\uB97C \uBC1C\uACAC\uD558\uACE0, \uC758\uC0AC \uACB0\uC815\uC5D0 \uD65C\uC6A9\r\n\uD655\uC7A5\uC131\uACFC \uC720\uC5F0\uC131: \uC774\uBCA4\uD2B8 \uAE30\uBC18 \uC544\uD0A4\uD14D\uCC98\uB97C \uD1B5\uD574 \uC2DC\uC2A4\uD15C \uD655\uC7A5\uC131\uACFC \uC720\uC5F0\uC131\uC744 \uD5A5\uC0C1\n"})}),"\n",(0,s.jsx)(n.h2,{id:"event-store",children:"event store"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC774\uBCA4\uD2B8\uB97C \uC800\uC7A5\uD558\uB294 \uC800\uC7A5\uC18C"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC4F0\uAE30\uB9CC \uAC00\uB2A5\uD558\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"snapshot-store",children:"snapshot store"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC774\uBCA4\uD2B8\uB97C \uCC98\uC74C\uBD80\uD130 \uC21C\uD68C\uD558\uBA70 \uC0C1\uD0DC\uB97C \uAC31\uC2E0\uD558\uB294 \uAC83\uC740 \uBE44\uD6A8\uC728\uC801\uC774\uB2E4."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC774\uBCA4\uD2B8\uB97C \uC77C\uC815 \uC8FC\uAE30\uB9C8\uB2E4 \uC2A4\uB0C5\uC0F7\uC73C\uB85C \uC800\uC7A5\uD558\uACE0 \uC774\uD6C4 \uC774\uBCA4\uD2B8\uB294 \uC2A4\uB0C5\uC0F7 \uC774\uD6C4\uBD80\uD130 \uC2DC\uC791\uD55C\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uAD6C\uD604",children:"\uAD6C\uD604"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// \uC774\uBCA4\uD2B8 \uC18C\uC2F1\uC744 \uC704\uD55C \uD074\uB798\uC2A4\r\nclass EventSourcing {\r\n  constructor() {\r\n    this.events = [];\r\n    this.currentState = {};\r\n  }\r\n\r\n  // \uC0C1\uD0DC\uB97C \uBCC0\uACBD\uD560 \uB54C\uB9C8\uB2E4 \uC774\uBCA4\uD2B8\uB97C \uC800\uC7A5\r\n  addEvent(event) {\r\n    this.events.push(event);\r\n    this.updateState(event);\r\n  }\r\n\r\n  // \uC800\uC7A5\uB41C \uC774\uBCA4\uD2B8\uB4E4\uC744 \uC21C\uD68C\uD558\uBA70 \uC0C1\uD0DC\uB97C \uAC31\uC2E0\r\n  updateState(event) {\r\n    // \uC774\uBCA4\uD2B8 \uD0C0\uC785\uC5D0 \uB530\uB77C \uAC31\uC2E0 \uBC29\uBC95\uC774 \uB2EC\uB77C\uC9D0\r\n    switch (event.type) {\r\n      case "USER_CREATED":\r\n        this.currentState.user = event.payload;\r\n        break;\r\n      case "USER_UPDATED":\r\n        this.currentState.user = { ...this.currentState.user, ...event.payload };\r\n        break;\r\n      case "PRODUCT_CREATED":\r\n        this.currentState.product = event.payload;\r\n        break;\r\n      case "PRODUCT_UPDATED":\r\n        this.currentState.product = { ...this.currentState.product, ...event.payload };\r\n        break;\r\n      // ...\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\n// \uC774\uBCA4\uD2B8 \uC0DD\uC131\uC744 \uC704\uD55C \uD568\uC218\r\nfunction createEvent(type, payload) {\r\n  return { type, payload };\r\n}\r\n\r\n// \uC774\uBCA4\uD2B8 \uC18C\uC2F1 \uC778\uC2A4\uD134\uC2A4 \uC0DD\uC131\r\nconst eventSourcing = new EventSourcing();\r\n\r\n// \uC774\uBCA4\uD2B8 \uCD94\uAC00\r\neventSourcing.addEvent(createEvent("USER_CREATED", { name: "John", age: 30 }));\r\neventSourcing.addEvent(createEvent("USER_UPDATED", { age: 31 }));\r\neventSourcing.addEvent(createEvent("PRODUCT_CREATED", { name: "Smartphone", price: 1000 }));\r\neventSourcing.addEvent(createEvent("PRODUCT_UPDATED", { price: 900 }));\r\n\r\n// \uCD5C\uC885 \uC0C1\uD0DC \uCD9C\uB825\r\nconsole.log(eventSourcing.currentState);\n'})})]})}function u(e={}){let{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},255511:function(e,n,t){t.d(n,{R:()=>o,x:()=>a});var r=t(596363);let s={},c=r.createContext(s);function o(e){let n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);