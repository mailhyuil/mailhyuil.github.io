"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[570014],{529087:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>i});var c=r(596363);const a={},t=c.createContext(a);function o(n){const e=c.useContext(t);return c.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:o(n.components),c.createElement(t.Provider,{value:e},n.children)}},967086:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>l,frontMatter:()=>o,metadata:()=>c,toc:()=>h});const c=JSON.parse('{"id":"nginx/nginx cache","title":"proxy cache nginx cache","description":"\uce90\uc2dc \ud65c\uc131\ud654","source":"@site/docs/nginx/nginx cache.md","sourceDirName":"nginx","slug":"/nginx/nginx cache","permalink":"/docs/nginx/nginx cache","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nginx cache \ud558\ub4dc \ub4dc\ub77c\uc774\ube0c \ubd84\ud560","permalink":"/docs/nginx/nginx cache \ud558\ub4dc \ub4dc\ub77c\uc774\ube0c \ubd84\ud560"},"next":{"title":"nginx conf.d vs sites-available, sites-enabled","permalink":"/docs/nginx/nginx config conf.d vs sites-available & sites-enabled"}}');var a=r(447259),t=r(529087);const o={},i="proxy cache nginx cache",s={},h=[{value:"\uce90\uc2dc \ud65c\uc131\ud654",id:"\uce90\uc2dc-\ud65c\uc131\ud654",level:2}];function p(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,t.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"proxy-cache-nginx-cache",children:"proxy cache nginx cache"})}),"\n",(0,a.jsx)(e.h2,{id:"\uce90\uc2dc-\ud65c\uc131\ud654",children:"\uce90\uc2dc \ud65c\uc131\ud654"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-conf",children:"http {\r\n    # /data/nginx/cache \ubbf8\ub9ac \uc0dd\uc131\ud574\ub450\uae30\r\n    # \uc774 \ub514\ub809\ud1a0\ub9ac\uc5d0 \uce90\uc2dc \ud30c\uc77c\uc774 \uc0dd\uc131\ub41c\ub2e4.\r\n    # my_cache\ub77c\ub294 keys_zone\uc73c\ub85c 10mb\uc758 \uacf5\uc720\uba54\ubaa8\ub9ac \uc124\uc815\r\n    # inactive=60m 60\ubd84\uac04 \uc694\uccad\uc774 \uc5c6\uc73c\uba74 \uce90\uc2dc\ub97c \uc0ad\uc81c\ud55c\ub2e4.\r\n    # max_size=10g \uce90\uc2dc \ud30c\uc77c\uc758 \ucd5c\ub300 \ud06c\uae30\ub97c 10GB\ub85c \uc81c\ud55c\ud55c\ub2e4.\r\n    # min_free=1g \ucd5c\uc18c \uc5ec\uc720 \uacf5\uac04\uc744 \uc124\uc815\ud569\ub2c8\ub2e4. \uc5ec\uc720 \uacf5\uac04\uc774 \ubd80\uc871\ud574\uc9c0\uba74 \uc624\ub798\ub41c \uce90\uc2dc \ud30c\uc77c\uc744 \uc0ad\uc81c\ud569\ub2c8\ub2e4.\r\n    # levels=1:2 \uce90\uc2dc \ud30c\uc77c\uc744 1\ub2e8\uacc4\uc758 \ud558\uc704 \ub514\ub809\ud1a0\ub9ac\uc5d0 2\ub2e8\uacc4\ub85c \uc800\uc7a5\ud55c\ub2e4.\r\n    # use_temp_path=off \uce90\uc2dc \ud30c\uc77c\uc744 \uc0dd\uc131\ud560 \ub54c \uc784\uc2dc \ub514\ub809\ud1a0\ub9ac\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294\ub2e4.\r\n    proxy_cache_path /data/nginx/cache keys_zone=my_cache:10m max_size=10g levels=1:2  inactive=60m use_temp_path=off;\r\n\r\n    server {\r\n        # \uce90\uc2dc \uc0ac\uc6a9 (\ubaa8\ub4e0 path)\r\n        proxy_cache my_cache;\r\n\r\n        location / {\r\n            # \uce90\uc2dc \uc0ac\uc6a9 (\ud2b9\uc815 path)\r\n            proxy_cache my_cache;\r\n\r\n            # 200, 302 \uc751\ub2f5\uc744 10\ubd84\uac04 \uce90\uc2dc\ud55c\ub2e4.\r\n            proxy_cache_valid 200 302 10m;\r\n            # 404 \uc751\ub2f5\uc744 1\ubd84\uac04 \uce90\uc2dc\ud55c\ub2e4.\r\n            proxy_cache_valid 404 1m;\r\n\r\n            # \ud2b9\uc815 \uba54\uc18c\ub4dc\ub97c \uce90\uc2dc\ud55c\ub2e4.\r\n            proxy_cache_method GET HEAD POST;\r\n\r\n            # \uce90\uc2dc \ud30c\uc77c\uc744 \uc0dd\uc131\ud560 \ub54c\uae4c\uc9c0 \ub2e4\ub978 \uc694\uccad\uc744 \ub300\uae30\uc2dc\ud0a8\ub2e4.\r\n            proxy_cache_lock on;\r\n\r\n            # \uce90\uc2dc\ub41c \uc751\ub2f5\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc744 \ub54c, \ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0\uc11c \ube44\ub3d9\uae30\uc801\uc73c\ub85c \uce90\uc2dc\ub97c \uc5c5\ub370\uc774\ud2b8\r\n            proxy_cache_background_update on;\r\n\r\n            # ETag \ub610\ub294 Last-Modified \ud5e4\ub354\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc6d0\ubcf8(origin) \uc11c\ubc84\uc5d0 \uce90\uc2dc\ub41c \uc751\ub2f5\uc774 \uc5ec\uc804\ud788 \uc720\ud6a8\ud55c\uc9c0 \ud655\uc778\r\n            # \uc6d0\ubcf8 \uc11c\ubc84\uac00 304 Not Modified\ub97c \uc751\ub2f5\ud558\uba74, Nginx\ub294 \uae30\uc874 \uce90\uc2dc\ub97c \uadf8\ub300\ub85c \uc0ac\uc6a9.\r\n            proxy_cache_revalidate on;\r\n\r\n            # \uc694\uccad\uc774 3\ubc88 \uc774\uc0c1 \ub4e4\uc5b4\uc624\uba74 \uce90\uc2dc\ud55c\ub2e4.\r\n            proxy_cache_min_uses 3;\r\n\r\n            # origin\uc774 \ub2e4\uc6b4\ub41c \uacbd\uc6b0 \uce90\uc2dc\ub41c \ud30c\uc77c\uc744 \uc804\uc1a1\ud55c\ub2e4.\r\n            proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;\r\n\r\n            # X-CACHE\ub77c\ub294 \ucee4\uc2a4\ud140 \ud5e4\ub354\uc5d0 \uce90\uc2dc \uc0c1\ud0dc\ub97c \uc804\ub2ec\ud55c\ub2e4. (HIT, MISS, BYPASS, EXPIRED, STALE)\r\n            add_header X-CACHE $upstream_cache_status;\r\n\r\n            # \ud2b9\uc815 \uce90\uc2dc \uad00\ub828 \ud5e4\ub354\ub97c \ubb34\uc2dc\r\n            proxy_ignore_headers X-Accel-Expires Expires Cache-Control;\r\n\r\n            proxy_pass http://localhost:3000;\r\n        }\r\n\r\n        location ~* \\.(?:css|js|woff2?|ttf|eot|svg|png|jpg|jpeg|gif|ico)$ {\r\n            # \uce90\uc2dc \uc0ac\uc6a9 (\ud2b9\uc815 \ud655\uc7a5\uc790)\r\n            proxy_cache my_cache;\r\n        }\r\n    }\r\n}\n"})})]})}function l(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(p,{...n})}):p(n)}}}]);