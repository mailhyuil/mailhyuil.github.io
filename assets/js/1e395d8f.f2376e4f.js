"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["933793"],{177001:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>l,toc:()=>d,default:()=>h,metadata:()=>s,assets:()=>c,contentTitle:()=>i});var s=JSON.parse('{"id":"nestjs/nest auth jwt","title":"nestjs jwt","description":"jwt.io","source":"@site/docs/nestjs/nest auth jwt.md","sourceDirName":"nestjs","slug":"/nestjs/nest auth jwt","permalink":"/docs/nestjs/nest auth jwt","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nestjs jwt","permalink":"/docs/nestjs/nest auth jwt \uC778\uC99D \uB85C\uC9C1"},"next":{"title":"nest session properties","permalink":"/docs/nestjs/nest auth session properties"}}'),t=r(447259),o=r(255511);let l={},i="nestjs jwt",c={},d=[{value:"jwt\uC758 \uBAA9\uC801",id:"jwt\uC758-\uBAA9\uC801",level:2},{value:"jwt \uAD6C\uC870",id:"jwt-\uAD6C\uC870",level:2},{value:"install",id:"install",level:2},{value:".env",id:"env",level:2},{value:"access-token.module.ts",id:"access-tokenmodulets",level:2},{value:"refresh-token.module.ts",id:"refresh-tokenmodulets",level:2},{value:"app.module.ts",id:"appmodulets",level:2}];function a(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"nestjs-jwt",children:"nestjs jwt"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://jwt.io/",children:"jwt.io"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://randomkeygen.com/",children:"randomkeygen"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"jwt\uC758 payload\uB294 \uB2E8\uC21C base64\uB85C \uC778\uCF54\uB529\uB418\uC5B4 \uC788\uAE30 \uB54C\uBB38\uC5D0 \uBBFC\uAC10\uD55C \uC815\uBCF4\uB97C \uB123\uC73C\uBA74 \uC548\uB41C\uB2E4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\uADF8\uB7EC\uB098 signature\uB294 secret\uC744 \uC0AC\uC6A9\uD558\uAE30 \uB54C\uBB38\uC5D0 \uAC80\uC99D \uAC00\uB2A5\uD558\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"jwt\uC758-\uBAA9\uC801",children:"jwt\uC758 \uBAA9\uC801"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"jwt\uC758 \uD575\uC2EC\uC740 \uC0C1\uD0DC\uB97C \uD074\uB77C\uC774\uC5B8\uD2B8\uAC00 \uAC00\uC9C0\uACE0 \uC788\uB2E4\uB294 \uAC83\uC774\uB2E4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"database\uC5D0\uC11C \uC720\uC800\uC758 \uC815\uBCF4\uB97C \uAC00\uC838\uC624\uC9C0 \uC54A\uC544\uB3C4 \uB418\uAE30 \uB54C\uBB38\uC5D0 (session \uBC29\uC2DD) \uC11C\uBC84\uC758 \uBD80\uD558\uB97C \uC904\uC77C \uC218 \uC788\uB2E4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\uB530\uB77C\uC11C user\uC758 \uC815\uBCF4\uB294 \uB370\uC774\uD130\uBCA0\uC774\uC2A4\uC5D0\uC11C \uC870\uD68C\uD558\uC9C0\uB9D0\uACE0 verify\uB41C payload\uC5D0\uC11C \uAC00\uC838\uC640\uC57C\uD55C\uB2E4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"refresh token \uC870\uD68C, blacklist \uC870\uD68C\uB3C4 rdbs\uAC00 \uC544\uB2CC \uBA54\uBAA8\uB9AC db\uC5D0\uC11C \uC870\uD68C\uD558\uBA74 \uB354 \uBD80\uD558\uB97C \uC904\uC77C \uC218 \uC788\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"jwt-\uAD6C\uC870",children:"jwt \uAD6C\uC870"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"secret\uC744 \uC0AC\uC6A9\uD558\uBA74 \uB9C8\uC9C0\uB9C9 verify signature \uBD80\uBD84\uB9CC \uBC14\uB010\uB2E4."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\uC989 jwt.io \uAC19\uC740 \uC0AC\uC774\uD2B8\uC5D0\uC11C header\uC640 payload\uB294 \uD56D\uC0C1 \uD655\uC778\uC774 \uAC00\uB2A5\uD558\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.           # header /// \uC54C\uACE0\uB9AC\uC998, \uD0C0\uC785\r\neyJpZCI6MSwidXNlcm5hbWUiOiJjb2RlZ2VhciIsImlhdC  # payload /// \uB370\uC774\uD130\r\nI6MTY0MzUxOTI2MCwiZXhwIjoxNjQzNTE5NTYwfQ.       # payload\r\njxsk2FtHsRRhoAZrsUDgHaHOLCxI9IlSMKTrkZ0zUl4     # verify signature /// secret\uC744 \uC0AC\uC6A9\uD558\uC5EC \uC0DD\uC131\uB418\uB294 \uB79C\uB364\uD55C \uAC12\n"})}),"\n",(0,t.jsx)(n.h2,{id:"install",children:"install"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"npm i @nestjs/jwt\n"})}),"\n",(0,t.jsx)(n.h2,{id:"env",children:".env"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"JWT_ACCESS_TOKEN_SECRET=VERY_SECRET_ACCESS_TOKEN\r\nJWT_ACCESS_TOKEN_EXPIRES_IN=1h\r\nJWT_REFRESH_TOKEN_SECRET=VERY_SECRET_REFRESH_TOKEN\r\nJWT_REFRESH_TOKEN_EXPIRES_IN=30d\n"})}),"\n",(0,t.jsx)(n.h2,{id:"access-tokenmodulets",children:"access-token.module.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Global, Module, OnModuleInit } from "@nestjs/common";\r\nimport { JwtModule, JwtService } from "@nestjs/jwt";\r\nimport { AccessTokenService } from "./token.token";\r\n\r\nconst secret = process.env["JWT_ACCESS_TOKEN_SECRET"];\r\nconst expiresIn = process.env["JWT_ACCESS_TOKEN_EXPIRES_IN"];\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    JwtModule.register({\r\n      secret,\r\n      signOptions: { expiresIn },\r\n      global: true,\r\n    }),\r\n  ],\r\n  controllers: [],\r\n  providers: [\r\n    {\r\n      provide: AccessTokenService,\r\n      useExisting: JwtService,\r\n    },\r\n  ],\r\n  exports: [AccessTokenService],\r\n})\r\nexport class AccessTokenModule implements OnModuleInit {\r\n  onModuleInit() {\r\n    if (!secret) {\r\n      throw new Error("JWT_ACCESS_TOKEN_SECRET \uD658\uACBD\uBCC0\uC218\uAC00 \uC815\uC758\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");\r\n    }\r\n    if (!expiresIn) {\r\n      throw new Error("JWT_ACCESS_TOKEN_EXPIRES_IN \uD658\uACBD\uBCC0\uC218\uAC00 \uC815\uC758\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"refresh-tokenmodulets",children:"refresh-token.module.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Global, Module, OnModuleInit } from "@nestjs/common";\r\nimport { JwtModule, JwtService } from "@nestjs/jwt";\r\nimport { RefreshTokenService } from "./token.token";\r\n\r\nconst secret = process.env["JWT_REFRESH_TOKEN_SECRET"];\r\nconst expiresIn = process.env["JWT_REFRESH_TOKEN_EXPIRES_IN"];\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    JwtModule.register({\r\n      secret,\r\n      signOptions: { expiresIn },\r\n      global: true,\r\n    }),\r\n  ],\r\n  controllers: [],\r\n  providers: [\r\n    {\r\n      provide: RefreshTokenService,\r\n      useExisting: JwtService,\r\n    },\r\n  ],\r\n  exports: [RefreshTokenService],\r\n})\r\nexport class RefreshTokenModule implements OnModuleInit {\r\n  onModuleInit() {\r\n    if (!secret) {\r\n      throw new Error("JWT_REFRESH_TOKEN_SECRET \uD658\uACBD\uBCC0\uC218\uAC00 \uC815\uC758\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");\r\n    }\r\n    if (!expiresIn) {\r\n      throw new Error("JWT_REFRESH_TOKEN_EXPIRES_IN \uD658\uACBD\uBCC0\uC218\uAC00 \uC815\uC758\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"appmodulets",children:"app.module.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"@Module({\r\n  imports: [AccessTokenModule, RefreshTokenModule],\r\n  controllers: [],\r\n  providers: [],\r\n})\r\nexport class AppModule {}\n"})})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},255511:function(e,n,r){r.d(n,{R:()=>l,x:()=>i});var s=r(596363);let t={},o=s.createContext(t);function l(e){let n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);