"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["764301"],{353281:function(e,r,n){n.r(r),n.d(r,{frontMatter:()=>i,toc:()=>c,default:()=>d,metadata:()=>t,assets:()=>a,contentTitle:()=>l});var t=JSON.parse('{"id":"javascript/js Proxy usage","title":"js Proxy","description":"\uC774\uBBF8 \uC788\uB294 readonly \uAC1D\uCCB4\uC5D0 \uC0C8\uB85C\uC6B4 \uAE30\uB2A5\uC744 \uCD94\uAC00\uD560 \uC218 \uC788\uC74C","source":"@site/docs/javascript/js Proxy usage.md","sourceDirName":"javascript","slug":"/javascript/js Proxy usage","permalink":"/docs/javascript/js Proxy usage","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Promise","permalink":"/docs/javascript/js Promise"},"next":{"title":"js AOP Proxy","permalink":"/docs/javascript/js Proxy"}}'),o=n(447259),s=n(255511);let i={},l="js Proxy",a={},c=[{value:"\uD568\uC218 \uB4A4\uC5D0 \uD638\uCD9C\uD558\uAE30",id:"\uD568\uC218-\uB4A4\uC5D0-\uD638\uCD9C\uD558\uAE30",level:2}];function u(e){let r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"js-proxy",children:"js Proxy"})}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:"\uC774\uBBF8 \uC788\uB294 readonly \uAC1D\uCCB4\uC5D0 \uC0C8\uB85C\uC6B4 \uAE30\uB2A5\uC744 \uCD94\uAC00\uD560 \uC218 \uC788\uC74C"}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-js",children:"type Client = typeof client;\r\n\r\nconst buildClientProxy = (timeoutMs: number) => {\r\n	const startTime = Date.now();\r\n\r\n	const handler = {\r\n		get(target: Client, key: keyof Client) {\r\n			if (Date.now() >= startTime + timeoutMs) {\r\n				throw new Error('Lock has expired.');\r\n			}\r\n			const prop = Reflect.get(target, key); // target[key] \uB300\uC2E0 Reflect.get(target, key)\uB97C \uC0AC\uC6A9\uD558\uBA74 property\uAC00 \uC5C6\uC744 \uB54C undefined\uAC00 \uC544\uB2CC \uC5D0\uB7EC\uB97C \uBC1C\uC0DD\uC2DC\uD0B4\r\n			return typeof prop === 'function' ? prop.bind(target) : prop;\r\n		}\r\n	};\r\n\r\n	return new Proxy(client, handler) as Client;\r\n};\r\n\r\nconst clientProxy = buildClientProxy(timeoutMs);\r\n\r\nclientProxy.rPush(bidHistoryKey(attrs.itemId), serialized);\r\nclientProxy.hSet(itemsKey(item.id), {\r\n    bids: item.bids + 1,\r\n    price: attrs.amount,\r\n    highestBidUserId: attrs.userId\r\n});\n"})}),"\n",(0,o.jsx)(r.h2,{id:"\uD568\uC218-\uB4A4\uC5D0-\uD638\uCD9C\uD558\uAE30",children:"\uD568\uC218 \uB4A4\uC5D0 \uD638\uCD9C\uD558\uAE30"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-js",children:'class Client {\r\n  rPush(key: string, value: string) {\r\n    console.log(`rPush ${key} ${value}`);\r\n  }\r\n  hSet(key: string, value: any) {\r\n    console.log(`hSet ${key} ${value}`);\r\n  }\r\n}\r\nconst client = new Client();\r\n\r\nconst buildClientProxy = () => {\r\n  const handler = {\r\n    get(target: Client, key: keyof Client) {\r\n      const prop = Reflect.get(target, key); // target[key] \uB300\uC2E0 Reflect.get(target, key)\uB97C \uC0AC\uC6A9\uD558\uBA74 property\uAC00 \uC5C6\uC744 \uB54C undefined\uAC00 \uC544\uB2CC \uC5D0\uB7EC\uB97C \uBC1C\uC0DD\uC2DC\uD0B4\r\n      console.log("before");\r\n      if (typeof prop === "function") {\r\n        return function () {\r\n          // \uBC18\uB4DC\uC2DC function\uC744 \uC0AC\uC6A9 (\uD654\uC0B4\uD45C \uD568\uC218 x)\r\n          const fn = prop.bind(target)(arguments[0], arguments[1]);\r\n          console.log("after");\r\n          return fn;\r\n        };\r\n      }\r\n      return prop;\r\n    },\r\n  };\r\n  return new Proxy(client, handler) as Client;\r\n};\r\n\r\nconst clientProxy = buildClientProxy();\r\n\r\nclientProxy.hSet("key", "value");\r\nclientProxy.rPush("key", "value");\n'})})]})}function d(e={}){let{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},255511:function(e,r,n){n.d(r,{R:()=>i,x:()=>l});var t=n(596363);let o={},s=t.createContext(o);function i(e){let r=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:r},e.children)}}}]);