"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["941842"],{118182:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>l,toc:()=>i,default:()=>u,metadata:()=>t,assets:()=>c,contentTitle:()=>a});var t=JSON.parse('{"id":"nodejs/nodejs race condition mutex & semaphore","title":"nodejs Mutex & Semaphore","description":"\uC5EC\uB7EC \uC2A4\uB808\uB4DC \uB610\uB294 \uD504\uB85C\uC138\uC2A4\uAC00 \uACF5\uC720 \uC790\uC6D0\uC5D0 \uC811\uADFC\uD560 \uB54C, \uB3D9\uC2DC\uC5D0 \uC811\uADFC\uD558\uB294 \uAC83\uC744 \uB9C9\uAE30 \uC704\uD55C \uBC29\uBC95","source":"@site/docs/nodejs/nodejs race condition mutex & semaphore.md","sourceDirName":"nodejs","slug":"/nodejs/nodejs race condition mutex & semaphore","permalink":"/docs/nodejs/nodejs race condition mutex & semaphore","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nodejs race condition example","permalink":"/docs/nodejs/nodejs race condition example"},"next":{"title":"mutex vs distributed-lock","permalink":"/docs/nodejs/nodejs race condition mutex vs distributed-lock"}}'),s=r(447259),o=r(255511);let l={},a="nodejs Mutex & Semaphore",c={},i=[{value:"install",id:"install",level:2},{value:"mutex.js",id:"mutexjs",level:2},{value:"usage",id:"usage",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"nodejs-mutex--semaphore",children:"nodejs Mutex & Semaphore"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC5EC\uB7EC \uC2A4\uB808\uB4DC \uB610\uB294 \uD504\uB85C\uC138\uC2A4\uAC00 \uACF5\uC720 \uC790\uC6D0\uC5D0 \uC811\uADFC\uD560 \uB54C, \uB3D9\uC2DC\uC5D0 \uC811\uADFC\uD558\uB294 \uAC83\uC744 \uB9C9\uAE30 \uC704\uD55C \uBC29\uBC95"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\uC790\uB8CC\uAD6C\uC870\uC758 \uC77C\uC885\uC774\uB2E4!"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"install",children:"install"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"npm i async-mutex\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mutexjs",children:"mutex.js"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const _awaitUnlock = async (mutex) => {\r\n  // \uC7A0\uAE08 \uC0C1\uD0DC\uAC00 \uC544\uB2D8 -> \uC989\uC2DC resolve\r\n  if (!mutex._locked) {\r\n    return Promise.resolve();\r\n  }\r\n  return new Promise((resolve) => {\r\n    // 0.1\uCD08 \uD6C4\uC5D0 \uB2E4\uC2DC \uD655\uC778\r\n    setTimeout(() => {\r\n      _awaitUnlock(mutex).then(() => resolve());\r\n    }, 100);\r\n  });\r\n};\r\n\r\nclass Mutex {\r\n  constructor() {\r\n    this._locked = false;\r\n  }\r\n\r\n  async lock() {\r\n    // \uC7A0\uAE08 \uC0C1\uD0DC\uAC00 \uD480\uB9B4 \uB54C \uAE4C\uC9C0 \uB300\uAE30\r\n    await _awaitUnlock(this);\r\n    this._locked = true;\r\n  }\r\n\r\n  // \uC7A0\uAE08 \uD574\uC81C\uB294 \uBCC4\uB3C4\uC758 \uC81C\uC57D\uC744 \uC8FC\uC9C0 \uC54A\uC74C.\r\n  release() {\r\n    this._locked = false;\r\n  }\r\n}\r\n\r\nexport default Mutex;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const mutex = new Mutex();\r\n\r\nconst parallelLogic = async () => {\r\n  await mutex.lock(); // \uC5EC\uAE30\uC11C mutex\uAC00 \uC720\uD734 \uC0C1\uD0DC\uC77C \uB54C \uAE4C\uC9C0 \uB300\uAE30\uD558\uBA70, \uC720\uD734 \uC0C1\uD0DC\uAC00 \uB418\uBA74 \uC7A0\uAE08\uC744 \uAC78\uACE0 \uC9C4\uD589\uD55C\uB2E4.\r\n  try {\r\n    // ..\uBE44\uC988\uB2C8\uC2A4 \uB85C\uC9C1..\r\n  } finally {\r\n    mutex.release(); // \uBC18\uB4DC\uC2DC \uC2E4\uD589\uD55C\uB2E4. \uADF8\uB807\uC9C0 \uC54A\uC73C\uBA74 Dead-lock \uBC1C\uC0DD\uD568.\r\n  }\r\n};\n"})})]})}function u(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},255511:function(e,n,r){r.d(n,{R:()=>l,x:()=>a});var t=r(596363);let s={},o=t.createContext(s);function l(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);