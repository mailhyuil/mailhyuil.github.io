"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["685853"],{167543:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>l,toc:()=>c,default:()=>u,metadata:()=>a,assets:()=>i,contentTitle:()=>o});var a=JSON.parse('{"id":"aws/aws Lambda SAM","title":"aws Lambda SAM (Serverless Application Model)","description":"AWS Lambda \uD568\uC218\uC640 \uAD00\uB828 \uB9AC\uC18C\uC2A4\uB97C \uC815\uC758\uD558\uACE0 \uBC30\uD3EC\uD558\uAE30 \uC704\uD55C \uC624\uD508 \uC18C\uC2A4 \uD504\uB808\uC784\uC6CC\uD06C","source":"@site/docs/aws/aws Lambda SAM.md","sourceDirName":"aws","slug":"/aws/aws Lambda SAM","permalink":"/docs/aws/aws Lambda SAM","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"aws S3 Object Lambda","permalink":"/docs/aws/aws Lambda S3 Object Lambda"},"next":{"title":"Lambda layer","permalink":"/docs/aws/aws Lambda layer"}}'),t=r(447259),s=r(255511);let l={},o="aws Lambda SAM (Serverless Application Model)",i={},c=[{value:"cli",id:"cli",level:2},{value:"template.yaml",id:"templateyaml",level:2},{value:"samconfig.toml",id:"samconfigtoml",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"aws-lambda-sam-serverless-application-model",children:"aws Lambda SAM (Serverless Application Model)"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"AWS Lambda \uD568\uC218\uC640 \uAD00\uB828 \uB9AC\uC18C\uC2A4\uB97C \uC815\uC758\uD558\uACE0 \uBC30\uD3EC\uD558\uAE30 \uC704\uD55C \uC624\uD508 \uC18C\uC2A4 \uD504\uB808\uC784\uC6CC\uD06C"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"SAM\uC740 \uB0B4\uBD80\uC801\uC73C\uB85C CloudFormation\uC744 \uC0AC\uC6A9\uD574\uC11C \uC2E4\uC81C \uBC30\uD3EC\uB97C \uC218\uD589"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cli",children:"cli"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sam init # SAM \uD504\uB85C\uC81D\uD2B8 \uCD08\uAE30\uD654\r\nsam build # \uBE4C\uB4DC (\uCF54\uB4DC \uBCC0\uACBD \uC2DC \uBC18\uB4DC\uC2DC \uC218\uD589)\r\nsam deploy --guided # \uBC30\uD3EC (\uCD5C\uCD08 \uBC30\uD3EC \uC2DC --guided \uC635\uC158 \uC0AC\uC6A9)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"templateyaml",children:"template.yaml"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'AWSTemplateFormatVersion: "2010-09-09"\r\nTransform: AWS::Serverless-2016-10-31\r\nDescription: Schedule App with EventBridge\r\n\r\nGlobals:\r\n  Function:\r\n    Timeout: 30\r\n    Runtime: nodejs22.x\r\n    Architectures:\r\n      - x86_64\r\n    Environment:\r\n      Variables:\r\n        DATABASE_URL: !Ref DatabaseUrl\r\n\r\nResources:\r\n  # Prisma Layer\r\n  PrismaLayer:\r\n    Type: AWS::Serverless::LayerVersion\r\n    Properties:\r\n      LayerName: prisma-client\r\n      Description: Prisma Client Layer\r\n      ContentUri: prisma-layer/\r\n      CompatibleRuntimes:\r\n        - nodejs22.x\r\n      RetentionPolicy: Delete\r\n\r\n  # Lambda \uD568\uC218 1: Open Class\r\n  OpenClassFunction:\r\n    Type: AWS::Serverless::Function\r\n    Properties:\r\n      FunctionName: open-class\r\n      CodeUri: open-class/\r\n      Handler: app.lambdaHandler\r\n      Description: Open a class when scheduled\r\n      Layers:\r\n        - !Ref PrismaLayer\r\n    Metadata:\r\n      BuildMethod: esbuild\r\n      BuildProperties:\r\n        Minify: true\r\n        Target: es2020\r\n        Sourcemap: true\r\n        EntryPoints:\r\n          - app.ts\r\n        External:\r\n          - ".prisma/client"\r\n\r\n  # Lambda \uD568\uC218 2: Close Class\r\n  CloseClassFunction:\r\n    Type: AWS::Serverless::Function\r\n    Properties:\r\n      FunctionName: close-class\r\n      CodeUri: close-class/\r\n      Handler: app.lambdaHandler\r\n      Description: Close a class when scheduled\r\n      Layers:\r\n        - !Ref PrismaLayer\r\n    Metadata:\r\n      BuildMethod: esbuild\r\n      BuildProperties:\r\n        Minify: true\r\n        Target: es2020\r\n        Sourcemap: true\r\n        EntryPoints:\r\n          - app.ts\r\n        External:\r\n          - ".prisma/client"\r\n\r\n  # EventBridge Scheduler \uC2E4\uD589 \uC5ED\uD560 (\uB450 Lambda \uBAA8\uB450 \uD3EC\uD568)\r\n  SchedulerExecutionRole:\r\n    Type: AWS::IAM::Role\r\n    Properties:\r\n      AssumeRolePolicyDocument:\r\n        Version: "2012-10-17"\r\n        Statement:\r\n          - Effect: Allow\r\n            Principal:\r\n              Service: scheduler.amazonaws.com\r\n            Action: sts:AssumeRole\r\n      Policies:\r\n        - PolicyName: InvokeLambdaFunctions\r\n          PolicyDocument:\r\n            Version: "2012-10-17"\r\n            Statement:\r\n              - Effect: Allow\r\n                Action: lambda:InvokeFunction\r\n                Resource:\r\n                  - !GetAtt OpenClassFunction.Arn\r\n                  - !GetAtt CloseClassFunction.Arn\r\n\r\nParameters:\r\n  DatabaseUrl:\r\n    Type: String\r\n    Description: Database connection URL\r\n    NoEcho: true\r\n\r\nOutputs:\r\n  OpenClassFunctionArn:\r\n    Description: Lambda Function ARN for EventBridge (Open)\r\n    Value: !GetAtt OpenClassFunction.Arn\r\n    Export:\r\n      Name: !Sub "${AWS::StackName}-OpenClassFunctionArn"\r\n\r\n  CloseClassFunctionArn:\r\n    Description: Lambda Function ARN for EventBridge (Close)\r\n    Value: !GetAtt CloseClassFunction.Arn\r\n    Export:\r\n      Name: !Sub "${AWS::StackName}-CloseClassFunctionArn"\r\n\r\n  SchedulerRoleArn:\r\n    Description: IAM Role ARN for EventBridge Scheduler\r\n    Value: !GetAtt SchedulerExecutionRole.Arn\r\n    Export:\r\n      Name: !Sub "${AWS::StackName}-SchedulerRoleArn"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"samconfigtoml",children:"samconfig.toml"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"sam cli \uBA85\uB839\uC5B4\uC758 \uAE30\uBCF8 \uC635\uC158 \uC124\uC815 \uD30C\uC77C"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'# More information about the configuration file can be found here:\r\n# https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-config.html\r\nversion = 0.1\r\n\r\n[default.global.parameters]\r\nstack_name = "schedule-app"\r\n\r\n[default.build.parameters]\r\ncached = true\r\nparallel = true\r\n\r\n[default.validate.parameters]\r\nlint = true\r\n\r\n[default.deploy.parameters]\r\ncapabilities = "CAPABILITY_IAM"\r\nconfirm_changeset = true\r\nresolve_s3 = true\r\nstack_name = "class-scheduler"\r\ns3_prefix = "class-scheduler"\r\nregion = "ap-northeast-2"\r\ndisable_rollback = true\r\nimage_repositories = []\r\n\r\n[default.package.parameters]\r\nresolve_s3 = true\r\n\r\n[default.sync.parameters]\r\nwatch = true\r\n\r\n[default.local_start_api.parameters]\r\nwarm_containers = "EAGER"\r\n\r\n[default.local_start_lambda.parameters]\r\nwarm_containers = "EAGER"\n'})})]})}function u(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},255511:function(e,n,r){r.d(n,{R:()=>l,x:()=>o});var a=r(596363);let t={},s=a.createContext(t);function l(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);