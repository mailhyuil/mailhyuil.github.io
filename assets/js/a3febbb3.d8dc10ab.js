"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["347270"],{782609:function(t,e,n){n.r(e),n.d(e,{frontMatter:()=>a,toc:()=>i,default:()=>u,metadata:()=>s,assets:()=>l,contentTitle:()=>p});var s=JSON.parse('{"id":"nestjs/nest passport jwt","title":"nest oauth passport","description":"https \uD658\uACBD\uC5D0\uC11C\uB9CC \uC815\uC0C1\uC801\uC73C\uB85C \uD14C\uC2A4\uD2B8\uAC00 \uAC00\uB2A5\uD558\uB2E4","source":"@site/docs/nestjs/nest passport jwt.md","sourceDirName":"nestjs","slug":"/nestjs/nest passport jwt","permalink":"/docs/nestjs/nest passport jwt","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nest pagination offset","permalink":"/docs/nestjs/nest pagination offset"},"next":{"title":"nest oauth passport","permalink":"/docs/nestjs/nest passport oauth"}}'),r=n(447259),o=n(255511);let a={},p="nest oauth passport",l={},i=[{value:"install",id:"install",level:2},{value:"strategy \uC0DD\uC131",id:"strategy-\uC0DD\uC131",level:2},{value:"guard \uC0AC\uC6A9",id:"guard-\uC0AC\uC6A9",level:2}];function c(t){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"nest-oauth-passport",children:"nest oauth passport"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"https \uD658\uACBD\uC5D0\uC11C\uB9CC \uC815\uC0C1\uC801\uC73C\uB85C \uD14C\uC2A4\uD2B8\uAC00 \uAC00\uB2A5\uD558\uB2E4"}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"https \uD658\uACBD\uC774 \uC544\uB2C8\uB77C\uBA74 ngrok \uC744 \uC0AC\uC6A9\uD574\uC11C (http\uB97C https\uD658\uACBD\uC73C\uB85C \uBC14\uAFBC url\uC744 \uC900\uB2E4) \uD14C\uC2A4\uD2B8 \uD558\uC790!"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"install",children:"install"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sh",children:"npm i passport\r\nnpm i @nestjs/passport\r\n\r\n# jwt\r\nnpm i @nestjs/jwt\r\nnpm i passport-jwt\r\nnpm i -D @types/passport-jwt\n"})}),"\n",(0,r.jsx)(e.h2,{id:"strategy-\uC0DD\uC131",children:"strategy \uC0DD\uC131"}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"\uC0DD\uC131\uB41C strategy\uB97C module\uC758 providers\uC5D0 \uB4F1\uB85D"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:'import { ExtractJwt, Strategy } from "passport-jwt";\r\nimport { PassportStrategy } from "@nestjs/passport";\r\nimport { Injectable } from "@nestjs/common";\r\nimport { jwtConstants } from "./constants";\r\n\r\n@Injectable()\r\nexport class JwtStrategy extends PassportStrategy(Strategy) {\r\n  constructor() {\r\n    super({\r\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\r\n      ignoreExpiration: false,\r\n      secretOrKey: jwtConstants.secret,\r\n    });\r\n  }\r\n\r\n  async validate(payload: any) {\r\n    return { userId: payload.sub, username: payload.username };\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"guard-\uC0AC\uC6A9",children:"guard \uC0AC\uC6A9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:'import { Controller, Request, Post, UseGuards } from "@nestjs/common";\r\nimport { AuthGuard } from "@nestjs/passport";\r\n\r\n@Controller()\r\nexport class AppController {\r\n  @UseGuards(AuthGuard("jwt"))\r\n  @Post("auth/login")\r\n  async login(@Request() req) {\r\n    return req.user;\r\n  }\r\n}\n'})})]})}function u(t={}){let{wrapper:e}={...(0,o.R)(),...t.components};return e?(0,r.jsx)(e,{...t,children:(0,r.jsx)(c,{...t})}):c(t)}},255511:function(t,e,n){n.d(e,{R:()=>a,x:()=>p});var s=n(596363);let r={},o=s.createContext(r);function a(t){let e=s.useContext(o);return s.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function p(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:a(t.components),s.createElement(o.Provider,{value:e},t.children)}}}]);