"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[226474],{458593:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"nestjs/nest \uc138\ud305 settings fastify","title":"nest fastify \uc138\ud305","description":"\ub300\ubd80\ubd84\uc758 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub294 \uc798 \ub3d9\uc791\ud558\uc9c0\ub9cc","source":"@site/docs/nestjs/nest \uc138\ud305 settings fastify.md","sourceDirName":"nestjs","slug":"/nestjs/nest \uc138\ud305 settings fastify","permalink":"/docs/nestjs/nest \uc138\ud305 settings fastify","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nest main.ts \uc138\ud305 enhancers","permalink":"/docs/nestjs/nest \uc138\ud305 settings enhancers"},"next":{"title":"prisma","permalink":"/docs/nestjs/nest \uc138\ud305 settings prisma"}}');var t=e(447259),i=e(529087);const a={},o="nest fastify \uc138\ud305",p={},l=[{value:"install",id:"install",level:2},{value:"main.ts",id:"maints",level:2},{value:"logger.middleware.ts",id:"loggermiddlewarets",level:2}];function m(n){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"nest-fastify-\uc138\ud305",children:"nest fastify \uc138\ud305"})}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"\ub300\ubd80\ubd84\uc758 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub294 \uc798 \ub3d9\uc791\ud558\uc9c0\ub9cc"}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"\uc608\uc678\uc801\uc73c\ub85c main.ts\uc5d0\uc11c \ubbf8\ub4e4\uc6e8\uc5b4\ub85c \ucd94\uac00\ud558\ub294 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub4e4\uc740 fastify \uc804\uc6a9 \ud328\ud0a4\uc9c0\ub97c \uc0ac\uc6a9\ud574\uc57c\ud55c\ub2e4. (helmet, csrf, multipart, compress, cookie, session \ub4f1)"}),"\n",(0,t.jsx)(r.p,{children:"fastify \uc804\uc6a9 \ubbf8\ub4e4\uc6e8\uc5b4\ub294 express\ubcf4\ub2e4 \ub354 \ucd5c\uc801\ud654\ub418\uc5b4 \ube60\ub974\ub2e4."}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"jwt\ub294 @nestjs/jwt\ub97c \uc0ac\uc6a9\ud574\ub3c4 \ub418\uc9c0\ub9cc \ub354 \ube60\ub974\uac8c \ucc98\ub9ac\ud558\uae30 \uc704\ud574\uc11c @fastify/jwt\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc74c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"install",children:"install"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"################ \ud544\uc218 \ud328\ud0a4\uc9c0 #####################\r\n\r\n# fastify\r\nnpm i @nestjs/platform-fastify\r\n\r\n# security\r\nnpm i @fastify/helmet\r\n# response compression\r\nnpm i @fastify/compress\r\n# cookie\r\nnpm i @fastify/cookie\r\n# file upload\r\nnpm i @fastify/multipart\r\n# jwt\r\nnpm i @fastify/jwt\r\n\r\n# env\r\nnpm i dotenv\r\n\r\n# encryption\r\nnpm i bcrypt\r\nnpm i -D @types/bcrypt\r\n\r\n# validation\r\nnpm i class-validator\r\nnpm i class-transformer\r\nnpm i nestjs-form-data\r\n\r\n# testing\r\nnpm i -D @nestjs/testing\r\nnpm i -D supertest\r\nnpm i -D @types/supertest\r\n\r\n# openapi\r\nnpm i @nestjs/swagger\r\nnpm i ng-openapi-gen\r\nnpm i @apidevtools/json-schema-ref-parser\r\n\r\n# date\r\nnpm i dayjs\r\n\r\n# http\r\nnpm i axios\r\nnpm i @nestjs/axios\r\n\r\n# rate limit\r\nnpm i @nestjs/throttler\r\n\r\n# server cache\r\nnpm i @nestjs/cache-manager\r\nnpm i cache-manager\r\n\r\n# prisma\r\nnpm i @prisma/client\r\nnpm i -D prisma\r\nnpm i prisma-error-enum\r\n\r\n# event\r\nnpm i @nestjs/event-emitter\r\n\r\n# schedule\r\nnpm i @nestjs/schedule\r\n\r\n# nestjs-cls\r\nnpm i nestjs-cls\r\nnpm i @nestjs-cls/transactional\r\nnpm i @nestjs-cls/transactional-adapter-prisma\r\n\r\n# AOP\r\nnpm i @toss/nestjs-aop\r\n\r\n################ \uc120\ud0dd\uc801 \ud328\ud0a4\uc9c0 #####################\r\n\r\n# redis cache\r\nnpm i redis\r\n\r\n# websocket-server\r\nnpm i @nestjs/websockets\r\nnpm i @nestjs/platform-socket.io\r\n# websocket-client\r\nnpm i ngx-socket-io\r\n# npm i socket.io\r\n# npm i socket.io-client\r\n# npm i @types/socket.io\r\n\r\n# message queue\r\nnpm i bull\r\nnpm i @nestjs/bull\r\n\r\n# mongoose\r\nnpm i mongoose\r\nnpm i @nestjs/mongoose\r\n\r\n# drizzle\r\nnpm i drizzle\r\n\r\n# graphql server\r\nnpm i @nestjs/graphql\r\nnpm i @nestjs/apollo\r\nnpm i @apollo/server\r\n# graphql client\r\nnpm i @apollo/client\r\nnpm i apollo-angular\r\n\r\n# image optimize\r\nnpm i sharp\r\nnpm i -D @types/sharp\r\n\r\n# session\r\nnpm i @fastify/secure-session\r\n\r\n# aws-sdk\r\nnpm i aws-sdk\r\nnpm i @aws-sdk/client-s3\r\nnpm i multer-s3\r\n\r\n# CSRF\r\n# npm i @fastify/csrf-protection\r\n\r\n# config\r\n# npm i @nestjs/config\r\n\r\n# npm i -D dotenv-cli\n"})}),"\n",(0,t.jsx)(r.h2,{id:"maints",children:"main.ts"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",children:'import { INestApplication } from "@nestjs/common";\r\nimport { NestFactory } from "@nestjs/core";\r\nimport { AppModule } from "./app/app.module";\r\nimport { FastifyAdapter, NestFastifyApplication } from "@nestjs/platform-fastify";\r\nimport cookie from "@fastify/cookie";\r\nimport jwt from "@fastify/jwt";\r\nimport helmet from "@fastify/helmet";\r\nimport multipart from "@fastify/multipart";\r\n\r\nconst NODE_ENV = process.env.NODE_ENV;\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create<NestFastifyApplication>(AppModule, new FastifyAdapter());\r\n\r\n  /** Cookie Parser */\r\n  await app.register(cookie);\r\n  /** File Upload */\r\n  await app.register(multipart);\r\n  /** JWT */\r\n  await app.register(jwt, {\r\n    secret: process.env.JWT_SECRET,\r\n  });\r\n  /** Security */\r\n  await app.register(helmet);\r\n  /** Trust Proxy */\r\n  app.set("trust proxy", true);\r\n  /** Global Prefix */\r\n  app.setGlobalPrefix("api");\r\n  /** Versioning */\r\n  app.enableVersioning({\r\n    type: VersioningType.URI,\r\n    defaultVersion: "1", // global fallback version \uc124\uc815\r\n  });\r\n  /** Port */\r\n  const port = process.env.SERVER_PORT || 3000;\r\n  /** OpenAPI */\r\n  initOpenAPI(app, port);\r\n  /** Server Listen */\r\n  await app.listen(port);\r\n  winstonLogger.log(`\ud83d\ude80 Application is running on: http://localhost:${port}/api`);\r\n}\r\n\r\nbootstrap();\n'})}),"\n",(0,t.jsx)(r.h2,{id:"loggermiddlewarets",children:"logger.middleware.ts"}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"FastifyRequest, FastifyReply\ub97c \uc0ac\uc6a9"}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",children:'import { Injectable, NestMiddleware } from "@nestjs/common";\r\nimport { FastifyRequest, FastifyReply } from "fastify";\r\n\r\n@Injectable()\r\nexport class LoggerMiddleware implements NestMiddleware {\r\n  use(req: FastifyRequest["raw"], res: FastifyReply["raw"], next: () => void) {\r\n    console.log("Request...");\r\n    next();\r\n  }\r\n}\n'})})]})}function c(n={}){const{wrapper:r}={...(0,i.R)(),...n.components};return r?(0,t.jsx)(r,{...n,children:(0,t.jsx)(m,{...n})}):m(n)}},529087:(n,r,e)=>{e.d(r,{R:()=>a,x:()=>o});var s=e(596363);const t={},i=s.createContext(t);function a(n){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(r):{...r,...n}},[r,n])}function o(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(i.Provider,{value:r},n.children)}}}]);