"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["678033"],{440765:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>i,toc:()=>d,default:()=>m,metadata:()=>o,assets:()=>l,contentTitle:()=>t});var o=JSON.parse('{"id":"go/go nodejs wasm","title":"go nodejs wasm","description":"wasm\uC740 \uAC00\uC0C1\uBA38\uC2E0\uC6A9 \uBC14\uC774\uD2B8 \uCF54\uB4DC, \uBE0C\uB77C\uC6B0\uC800 \uB610\uB294 \uB3C5\uB9BD \uB7F0\uD0C0\uC784 \uD658\uACBD\uC5D0\uC11C \uC2E4\uD589\uD55C\uB2E4.","source":"@site/docs/go/go nodejs wasm.md","sourceDirName":"go","slug":"/go/go nodejs wasm","permalink":"/docs/go/go nodejs wasm","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"go nodejs ffi (Foreign Function Interface)","permalink":"/docs/go/go nodejs ffi"},"next":{"title":"go package CompileDaemon","permalink":"/docs/go/go package CompileDaemon"}}'),a=s(447259),r=s(255511);let i={},t="go nodejs wasm",l={},d=[{value:"main.go",id:"maingo",level:2},{value:"build",id:"build",level:2},{value:"install in nodejs",id:"install-in-nodejs",level:2},{value:"main.js",id:"mainjs",level:2}];function c(n){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"go-nodejs-wasm",children:"go nodejs wasm"})}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"wasm\uC740 \uAC00\uC0C1\uBA38\uC2E0\uC6A9 \uBC14\uC774\uD2B8 \uCF54\uB4DC, \uBE0C\uB77C\uC6B0\uC800 \uB610\uB294 \uB3C5\uB9BD \uB7F0\uD0C0\uC784 \uD658\uACBD\uC5D0\uC11C \uC2E4\uD589\uD55C\uB2E4."}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"\uC800\uC218\uC900\uC758 \uBC14\uC774\uB108\uB9AC & \uBC14\uC774\uD2B8 \uCF54\uB4DC\uC774\uAE30 \uB54C\uBB38\uC5D0 \uBE60\uB974\uAC8C Native Code\uB85C \uBCC0\uD658\uD560 \uC218 \uC788\uACE0"}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"\uAD6C\uC870\uC801\uC73C\uB85C \uB2E8\uC21C, \uD0C0\uC785\uC774 \uC815\uC801, \uBA85\uD655\uD558\uAE30 \uB54C\uBB38\uC5D0 JIT, AOT \uCEF4\uD30C\uC77C\uB7EC\uAC00 \uCD5C\uC801\uD654\uD558\uAE30 \uB9E4\uC6B0 \uC6A9\uC774\uD558\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"maingo",children:"main.go"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-go",children:"package main\r\n\r\n//export add\r\nfunc add(a, b int32) int32 {\r\n	return a + b\r\n}\r\n\r\nfunc main() {}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"build",children:"build"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"# nodejs \uC6A9\r\nGOOS=wasip1 GOARCH=wasm tinygo build -o add.wasm main.go\r\n# browser \uC6A9\r\nGOOS=js GOARCH=wasm tinygo build -o add.wasm main.go\r\n# add.wasm \uC0DD\uC131\uB428\r\n# nodejs \uD504\uB85C\uC81D\uD2B8\uB85C \uBCF5\uC0AC\n"})}),"\n",(0,a.jsx)(e.h2,{id:"install-in-nodejs",children:"install in nodejs"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"npm i wasi # node 20 \uC774\uC0C1\uBD80\uD130\uB294 \uAE30\uBCF8 \uB0B4\uC7A5\uB428\n"})}),"\n",(0,a.jsx)(e.h2,{id:"mainjs",children:"main.js"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:'const fs = require("fs");\r\nconst { WASI } = require("wasi");\r\nconst path = require("path");\r\n\r\nconst wasi = new WASI({\r\n  version: "preview1",\r\n});\r\nconst importObject = { wasi_snapshot_preview1: wasi.wasiImport };\r\n\r\nconst wasmBuffer = fs.readFileSync(path.resolve(__dirname, "add.wasm"));\r\n\r\n(async () => {\r\n  const wasmModule = await WebAssembly.compile(wasmBuffer);\r\n  const instance = await WebAssembly.instantiate(wasmModule, importObject);\r\n  wasi.start(instance);\r\n\r\n  const result = instance.exports.add(5, 7);\r\n  console.log("Result:", result); // \u{1F449} 12\r\n})();\n'})})]})}function m(n={}){let{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(c,{...n})}):c(n)}},255511:function(n,e,s){s.d(e,{R:()=>i,x:()=>t});var o=s(596363);let a={},r=o.createContext(a);function i(n){let e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);