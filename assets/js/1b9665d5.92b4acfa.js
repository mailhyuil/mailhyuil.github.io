"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["318022"],{925545:function(e,r,n){n.r(r),n.d(r,{frontMatter:()=>o,toc:()=>p,default:()=>d,metadata:()=>s,assets:()=>i,contentTitle:()=>a});var s=JSON.parse('{"id":"db-postgres/postgres WAL archive backup","title":"postgres WAL \uC544\uCE74\uC774\uBE0C backup","description":"WAL \uD30C\uC77C\uC744 \uC7AC\uC0AC\uC6A9\uD558\uC9C0 \uC54A\uACE0 \uBCF4\uAD00","source":"@site/docs/db-postgres/postgres WAL archive backup.md","sourceDirName":"db-postgres","slug":"/db-postgres/postgres WAL archive backup","permalink":"/docs/db-postgres/postgres WAL archive backup","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"postgres TLS & SSL","permalink":"/docs/db-postgres/postgres TLS & SSL"},"next":{"title":"postgres WAL restore","permalink":"/docs/db-postgres/postgres WAL archive restore"}}'),c=n(447259),t=n(255511);let o={},a="postgres WAL \uC544\uCE74\uC774\uBE0C backup",i={},p=[{value:"archive",id:"archive",level:2},{value:"pg_basebackup",id:"pg_basebackup",level:2}];function l(e){let r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.header,{children:(0,c.jsx)(r.h1,{id:"postgres-wal-\uC544\uCE74\uC774\uBE0C-backup",children:"postgres WAL \uC544\uCE74\uC774\uBE0C backup"})}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"WAL \uD30C\uC77C\uC744 \uC7AC\uC0AC\uC6A9\uD558\uC9C0 \uC54A\uACE0 \uBCF4\uAD00"}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"\uBCF4\uD1B5 \uC678\uBD80 \uC800\uC7A5\uC18C\uC5D0 WAL \uB85C\uADF8\uB97C \uC800\uC7A5\uD558\uC5EC, \uB370\uC774\uD130\uBCA0\uC774\uC2A4 \uC2DC\uC2A4\uD15C\uC774 \uC190\uC0C1\uB41C \uACBD\uC6B0\uC5D0\uB3C4 \uB85C\uADF8\uB97C \uC0AC\uC6A9\uD558\uC5EC \uB370\uC774\uD130\uB97C \uBCF5\uAD6C\uD560 \uC218 \uC788\uAC8C \uD569\uB2C8\uB2E4."}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"pg_basebackup\uC744 \uC0AC\uC6A9\uD55C \uC774\uD6C4\uBD80\uD130\uC758 WAL \uB85C\uADF8\uB9CC \uBCF4\uAD00\uD558\uBA74 \uB429\uB2C8\uB2E4."}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"pg_basebackup\uC744 \uD55C\uBC88\uC774\uB77C\uB3C4 \uD574\uB194\uC57C point in recovery\uAC00 \uAC00\uB2A5\uD558\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(r.h2,{id:"archive",children:"archive"}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"postgres restart\uC2DC WAL \uD30C\uC77C\uC774 archive_command\uC5D0 \uC124\uC815\uB41C \uBA85\uB839\uC73C\uB85C \uC2E4\uD589\uB41C\uB2E4."}),"\n",(0,c.jsx)(r.p,{children:"/mnt/server/archivedir \uC744 \uC0DD\uC131\uD558\uACE0 \uC4F0\uAE30 \uAD8C\uD55C \uBD80\uC5EC\uD574\uC57C \uD55C\uB2E4."}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"archive_command \uBA85\uB839\uC740 PostgreSQL \uC11C\uBC84\uB97C \uC2E4\uD589\uD588\uB358 \uC2DC\uC2A4\uD15C \uC0AC\uC6A9\uC790 \uAD8C\uD55C\uC73C\uB85C \uC2E4\uD589\uB418\uC5B4\uC57C"}),"\n",(0,c.jsx)(r.p,{children:"\uB610\uD55C \uC131\uACF5\uD55C \uACBD\uC6B0 0, \uC544\uB2CC\uACBD\uC6B0 0 \uC774 \uC544\uB2C8\uAC8C \uBC18\uD658\uB418\uB3C4\uB85D \uD574\uC57C"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-conf",children:"archive_mode = on\r\narchive_command = 'test ! -f /mnt/server/archivedir/%f && cp %p /mnt/server/archivedir/%f'  # Unix\r\narchive_timeout = 1 # 1\uCD08\uB9C8\uB2E4 \uAC15\uC81C\uB85C WAL \uD30C\uC77C\uC744 archive_command\uB85C \uBCF4\uB0C4 (0\uC774\uBA74 16MB \uCC44\uC6CC\uC9C0\uBA74 \uBCF4\uB0C4)\n"})}),"\n",(0,c.jsx)(r.h2,{id:"pg_basebackup",children:"pg_basebackup"}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"pg_basebackup\uC744 \uD558\uBA74 \uC544\uCE74\uC774\uBE0C\uC5D0 000000010000000000000002.00000028.backup \uC774\uB807\uAC8C \uB9C8\uD0B9\uB41C \uD30C\uC77C\uC774 \uC0DD\uC131\uB41C\uB2E4."}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"000000010000000000000002 \uBC11\uC758 \uD30C\uC77C\uC740 \uC9C0\uC6CC\uB3C4 \uB41C\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-sh",children:"pg_basebackup -D /backup/base -Ft -z -X fetch -P -v\r\n# -D : \uBC31\uC5C5\uD30C\uC77C\uC774 \uC800\uC7A5\uB420 \uB514\uB809\uD1A0\uB9AC\r\n# -Ft : tar \uD615\uC2DD\uC73C\uB85C \uBC31\uC5C5\r\n# -z : gzip\uC73C\uB85C \uC555\uCD95\r\n# -X none : WAL \uD30C\uC77C\uC744 \uBCF5\uC0AC\uD558\uC9C0 \uC54A\uC74C\r\n# -X fetch : WAL\uC744 \uBC31\uC5C5\uC774 \uB05D\uB09C \uD6C4, \uBC31\uC5C5\uC774 \uC2DC\uC791\uB41C \uC2DC\uC810\uC758 WAL\uB9CC \uAC00\uC838\uC634\r\n# -X stream : WAL\uC744 \uBC31\uC5C5 \uC911 \uC2A4\uD2B8\uB9AC\uBC0D(\uC2E4\uC2DC\uAC04)\uC73C\uB85C \uBC1B\uC544\uC11C \uD568\uAED8 \uC800\uC7A5\r\n# -P : \uC9C4\uD589\uB960 \uD45C\uC2DC\r\n# -v : \uC790\uC138\uD55C \uC815\uBCF4 \uD45C\uC2DC\n"})})]})}function d(e={}){let{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,c.jsx)(r,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},255511:function(e,r,n){n.d(r,{R:()=>o,x:()=>a});var s=n(596363);let c={},t=s.createContext(c);function o(e){let r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);