"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["771084"],{558382:function(e,s,n){n.r(s),n.d(s,{frontMatter:()=>o,toc:()=>l,default:()=>m,metadata:()=>r,assets:()=>i,contentTitle:()=>c});var r=JSON.parse('{"id":"aws/aws message queue SQS ElasticMQ","title":"aws message queue SQS ElasticMQ","description":"AWS SQS\uC640 \uD638\uD658\uB418\uB294 \uC624\uD508 \uC18C\uC2A4 \uBA54\uC2DC\uC9C0 \uD050 \uC11C\uBC84","source":"@site/docs/aws/aws message queue SQS ElasticMQ.md","sourceDirName":"aws","slug":"/aws/aws message queue SQS ElasticMQ","permalink":"/docs/aws/aws message queue SQS ElasticMQ","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"aws message queue SQS (Simple Queue Service)","permalink":"/docs/aws/aws message queue SQS - simple queue service"},"next":{"title":"aws message queue AmazonMQ","permalink":"/docs/aws/aws message queue amazonMQ"}}'),t=n(447259),a=n(255511);let o={},c="aws message queue SQS ElasticMQ",i={},l=[{value:"docker-compose.yaml",id:"docker-composeyaml",level:2},{value:"queue \uC0DD\uC131",id:"queue-\uC0DD\uC131",level:2},{value:"elasticmq.conf",id:"elasticmqconf",level:2},{value:"server",id:"server",level:2}];function u(e){let s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"aws-message-queue-sqs-elasticmq",children:"aws message queue SQS ElasticMQ"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"AWS SQS\uC640 \uD638\uD658\uB418\uB294 \uC624\uD508 \uC18C\uC2A4 \uBA54\uC2DC\uC9C0 \uD050 \uC11C\uBC84"}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"SQS\uB97C \uC704\uD55C \uD14C\uC2A4\uD2B8/\uAC1C\uBC1C \uC804\uC6A9"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"docker-composeyaml",children:"docker-compose.yaml"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:'version: "3.8"\r\nservices:\r\n  elasticmq:\r\n    image: softwaremill/elasticmq-native\r\n    ports:\r\n      - "9324:9324"\r\n      - "9325:9325"\r\n    volumes:\r\n      - "./elasticmq.conf:/opt/elasticmq.conf"\n'})}),"\n",(0,t.jsx)(s.h2,{id:"queue-\uC0DD\uC131",children:"queue \uC0DD\uC131"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:'curl -X POST "http://localhost:9324/?Action=CreateQueue&QueueName=my-queue"\n'})}),"\n",(0,t.jsx)(s.h2,{id:"elasticmqconf",children:"elasticmq.conf"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-hocon",children:'include classpath("application.conf")\r\n\r\nnode-address {\r\n  protocol = http\r\n  host = "*"\r\n  port = 9324\r\n}\r\n\r\nrest-sqs {\r\n  enabled = true\r\n  bind-port = 9324\r\n  bind-hostname = "0.0.0.0"\r\n  sqs-limits = strict\r\n}\r\n\r\nqueues {\r\n  my-queue {\r\n    defaultVisibilityTimeout = 10 seconds\r\n    delay = 5 seconds\r\n    receiveMessageWait = 0 seconds\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(s.h2,{id:"server",children:"server"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ts",children:'// app.module.ts\r\nimport { Module } from "@nestjs/common";\r\nimport { ConfigModule } from "@nestjs/config";\r\n\r\n@Module({\r\n  imports: [ConfigModule.forRoot()],\r\n})\r\nexport class AppModule {}\r\n\r\n// queue.service.ts\r\nimport { Injectable } from "@nestjs/common";\r\nimport { SQSClient, SendMessageCommand, ReceiveMessageCommand } from "@aws-sdk/client-sqs";\r\n\r\n@Injectable()\r\nexport class QueueService {\r\n  private sqsClient: SQSClient;\r\n  private queueUrl: string;\r\n\r\n  constructor() {\r\n    this.sqsClient = new SQSClient({\r\n      region: process.env.AWS_REGION || "us-east-1",\r\n      endpoint: process.env.SQS_ENDPOINT || "http://localhost:4566",\r\n      credentials: {\r\n        accessKeyId: process.env.AWS_ACCESS_KEY_ID || "test",\r\n        secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY || "test",\r\n      },\r\n    });\r\n    this.queueUrl = process.env.QUEUE_URL || "http://localhost:4566/000000000000/my-queue";\r\n  }\r\n\r\n  async sendMessage(message: any) {\r\n    const command = new SendMessageCommand({\r\n      QueueUrl: this.queueUrl,\r\n      MessageBody: JSON.stringify(message),\r\n    });\r\n    return await this.sqsClient.send(command);\r\n  }\r\n\r\n  async receiveMessages() {\r\n    const command = new ReceiveMessageCommand({\r\n      QueueUrl: this.queueUrl,\r\n      MaxNumberOfMessages: 10,\r\n      WaitTimeSeconds: 5,\r\n    });\r\n    return await this.sqsClient.send(command);\r\n  }\r\n}\n'})})]})}function m(e={}){let{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},255511:function(e,s,n){n.d(s,{R:()=>o,x:()=>c});var r=n(596363);let t={},a=r.createContext(t);function o(e){let s=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(a.Provider,{value:s},e.children)}}}]);