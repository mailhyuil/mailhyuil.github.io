"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[11164],{529087:(r,e,n)=>{n.d(e,{R:()=>o,x:()=>a});var s=n(596363);const l={},t=s.createContext(l);function o(r){const e=s.useContext(t);return s.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function a(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(l):r.components||l:o(r.components),s.createElement(t.Provider,{value:e},r.children)}},984019:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>i,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"graphQL/graphql nestjs code first","title":"nest graphQL","description":"@nestjs/graphql\uc758 \ub370\ucf54\ub808\uc774\ud130\ub85c \ubaa8\ub378\uc744 \uc815\uc758","source":"@site/docs/graphQL/graphql nestjs code first.md","sourceDirName":"graphQL","slug":"/graphQL/graphql nestjs code first","permalink":"/docs/graphQL/graphql nestjs code first","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"graphql naming convention","permalink":"/docs/graphQL/graphql naming convention"},"next":{"title":"graphql nestjs decorator","permalink":"/docs/graphQL/graphql nestjs decorator"}}');var l=n(447259),t=n(529087);const o={},a="nest graphQL",i={},c=[{value:"install",id:"install",level:2},{value:"app.module.ts",id:"appmodulets",level:2},{value:"user.model.ts",id:"usermodelts",level:2},{value:"resolver",id:"resolver",level:2},{value:"client",id:"client",level:2}];function p(r){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...r.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"nest-graphql",children:"nest graphQL"})}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"@nestjs/graphql\uc758 \ub370\ucf54\ub808\uc774\ud130\ub85c \ubaa8\ub378\uc744 \uc815\uc758"}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"\ubaa8\ub378\uc744 resolver\uc5d0\uc11c \uc0ac\uc6a9\ud558\uba74 \uc790\ub3d9\uc73c\ub85c \uc2a4\ud0a4\ub9c8\uac00 \uc0dd\uc131\ub428"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"install",children:"install"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sh",children:"npm i graphql\r\n\r\n# server\r\nnpm i @nestjs/graphql\r\nnpm i @nestjs/apollo\r\nnpm i @apollo/server\r\n\r\n# client\r\nnpm i @apollo/client\r\nnpm i apollo-angular\n"})}),"\n",(0,l.jsx)(e.h2,{id:"appmodulets",children:"app.module.ts"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'import { ApolloDriver, ApolloDriverConfig } from "@nestjs/apollo";\r\nimport { GraphQLModule } from "@nestjs/graphql";\r\n\r\n@Module({\r\n  imports: [\r\n    GraphQLModule.forRoot<ApolloDriverConfig>({\r\n      driver: ApolloDriver,\r\n      autoSchemaFile: join(process.cwd(), "apps/server/src/schema.gql"),\r\n      playground: true,\r\n    }),\r\n    UserModule, // UserResolver \uac00 Provider\ub85c \ub4f1\ub85d\ub418\uc5b4\uc57c \ud568\r\n  ],\r\n  controllers: [],\r\n  providers: [],\r\n})\r\nexport class AppModule {}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"usermodelts",children:"user.model.ts"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'import { Field, ID, ObjectType } from "@nestjs/graphql";\r\n\r\n@Exclude()\r\n@ObjectType()\r\nexport class User {\r\n  @Expose()\r\n  @Field(() => ID)\r\n  id: string;\r\n\r\n  @Expose()\r\n  @Field({ nullable: false })\r\n  username: string;\r\n\r\n  @Expose()\r\n  @Field({ nullable: false })\r\n  email: string;\r\n\r\n  @Expose()\r\n  @Field({ nullable: false })\r\n  password: string;\r\n}\r\n\r\n@InputType()\r\nexport class CreateUserDTO {\r\n  @IsNotEmpty()\r\n  @Field()\r\n  username: string;\r\n\r\n  @IsNotEmpty()\r\n  @Field()\r\n  email: string;\r\n\r\n  @IsNotEmpty()\r\n  @Field()\r\n  password: string;\r\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"resolver",children:"resolver"}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"controller\ub300\uc2e0 resolver \uc0ac\uc6a9"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'import { Args, Mutation, Query, Resolver } from "@nestjs/graphql";\r\nimport { CreateUserDTO, User } from "./user.model";\r\nimport { UserService } from "./user.service";\r\n\r\n@Resolver((of) => User)\r\nexport class UserResolver {\r\n  constructor(private userService: UserService) {}\r\n\r\n  @Query((returns) => User)\r\n  async findById(@Args("id", { type: () => String }) id: string) {\r\n    return await this.userService.findById(id);\r\n  }\r\n\r\n  @Query((returns) => [User])\r\n  async findAll() {\r\n    return await this.userService.findAll();\r\n  }\r\n\r\n  @Mutation((returns) => User)\r\n  async create(@Args("user") user: CreateUserDTO) {\r\n    const createdUser = await this.userService.create(user);\r\n    return createdUser;\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"client",children:"client"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:'// query\r\nthis.apollo\r\n  .watchQuery({\r\n    query: gql`\r\n      {\r\n        findAll {\r\n          username\r\n          email\r\n        }\r\n      }\r\n    `,\r\n  })\r\n  .valueChanges.subscribe((user: any) => {\r\n    console.log(user);\r\n  });\r\n// mutation\r\nthis.apollo\r\n  .watchQuery({\r\n    mutation: gql`\r\n      {\r\n        create(user: { username: "hyuil", email: "hyuil@gmail.com", password: "1234" }) {\r\n          username\r\n        }\r\n      }\r\n    `,\r\n  })\r\n  .valueChanges.subscribe((user: any) => {\r\n    console.log(user);\r\n  });\r\n// subscription\n'})})]})}function d(r={}){const{wrapper:e}={...(0,t.R)(),...r.components};return e?(0,l.jsx)(e,{...r,children:(0,l.jsx)(p,{...r})}):p(r)}}}]);