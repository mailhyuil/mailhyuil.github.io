"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[115447],{356584:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"api/api oauth kakao","title":"oauth-kakao","description":"1. \uc571 \uc0dd\uc131","source":"@site/docs/api/api oauth kakao.md","sourceDirName":"api","slug":"/api/api oauth kakao","permalink":"/docs/api/api oauth kakao","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"api oauth kakao logout","permalink":"/docs/api/api oauth kakao logout"},"next":{"title":"api oauth naver","permalink":"/docs/api/api oauth naver"}}');var t=r(447259),s=r(529087);const o={},l="oauth-kakao",i={},c=[{value:"REST API vs SDK",id:"rest-api-vs-sdk",level:2},{value:"client",id:"client",level:2},{value:"index.html",id:"indexhtml",level:3},{value:"login.page.ts (REST API \uc0ac\uc6a9)",id:"loginpagets-rest-api-\uc0ac\uc6a9",level:3},{value:"login.page.ts (Javascript SDK \uc0ac\uc6a9)",id:"loginpagets-javascript-sdk-\uc0ac\uc6a9",level:3},{value:"app.routes.ts",id:"approutests",level:3},{value:"callback.page.ts",id:"callbackpagets",level:3},{value:"server",id:"server",level:2},{value:"axios \uc124\uc815",id:"axios-\uc124\uc815",level:2},{value:"install",id:"install",level:3},{value:"module",id:"module",level:3},{value:"user/oauth",id:"useroauth",level:3},{value:"\ub85c\uadf8\uc544\uc6c3",id:"\ub85c\uadf8\uc544\uc6c3",level:2}];function d(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"oauth-kakao",children:"oauth-kakao"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\uc571 \uc0dd\uc131"}),"\n",(0,t.jsx)(e.li,{children:"\ub3d9\uc758 \ud56d\ubaa9 \uc124\uc815"}),"\n",(0,t.jsx)(e.li,{children:"\uce74\uce74\uc624 \ub85c\uadf8\uc778 \ud65c\uc131\ud654, OpenID Connect \ud65c\uc131\ud654"}),"\n",(0,t.jsxs)(e.li,{children:["\uc571\ud0a4 -> REST API \ud0a4 \ub610\ub294 Javascript \ud0a4 (\ub124\uc774\ud2f0\ube0c \uc571 \ud0a4) \ud658\uacbd \ubcc0\uc218\ub85c \uc124\uc815","\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"REST API \ud0a4\ub294 \uacf5\uac1c\ub418\uba74 \uc548\ub41c\ub2e4 (REST API\ub85c \uc0ac\uc6a9)"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"Javascript \ud0a4\ub294 \uacf5\uac1c\ub418\uc5b4\ub3c4 \uc0c1\uad00\uc5c6\ub2e4 (Javascript SDK\ub97c \uc0ac\uc6a9\ud560 \ub54c \uc0ac\uc6a9)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["Redirect URL \uc124\uc815","\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:'\uc0ac\uc6a9\uc790\uac00 \ub85c\uadf8\uc778\uc5d0 \uc131\uacf5\ud588\uc744 \ub54c \ub9ac\ub514\ub809\uc158 \uc2dc\ud0ac "\ud074\ub77c\uc774\uc5b8\ud2b8"\uc758 URL'}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"REDIRECT_URL?code=fdhttfdhft6ht \ucf54\ub4dc \ud615\uc2dd\uc73c\ub85c \ub9ac\ub2e4\uc774\ub809\ud2b8 \ub41c\ub2e4."}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"querystring\uc73c\ub85c code\ub97c \ubc1b\uc544\uc11c \uc11c\ubc84\uc5d0 \ub85c\uadf8\uc778 \ub610\ub294 \ud68c\uc6d0\uac00\uc785 \uc694\uccad (REST API \uc0ac\uc6a9)"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\ub610\ub294 SDK\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud68c\uc6d0 \uc815\ubcf4\ub9cc \uc11c\ubc84\uc5d0 \uc694\uccad. (Javascript SDK \uc0ac\uc6a9)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:"\uc11c\ubc84\uc5d0\uc11c \ubc1b\uc740 \ucf54\ub4dc\ub97c \uc774\uc6a9\ud574\uc11c \uce74\uce74\uc624 \uc778\uc99d \uc11c\ubc84\uc5d0 \ud68c\uc6d0 \uc815\ubcf4 \uc694\uccad"}),"\n",(0,t.jsx)(e.li,{children:"\uce74\uce74\uc624 \uc778\uc99d \uc11c\ubc84\uc5d0\uc11c \ud68c\uc6d0 \uc815\ubcf4\ub97c \ubc1b\uc544\uc11c \uc11c\ubc84\uc5d0\uc11c \ub85c\uadf8\uc778 \ub610\ub294 \ud68c\uc6d0\uac00\uc785 \ucc98\ub9ac"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"rest-api-vs-sdk",children:"REST API vs SDK"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"SDK\ub97c \uc0ac\uc6a9\ud574\uc11c \uad6c\ud604\ud558\uba74 \uac04\ud3b8 \ub85c\uadf8\uc778\uc744 \uad6c\ud604\ud560 \uc218 \uc788\uace0"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"REST API\ub97c \uc0ac\uc6a9\ud574\uc11c \uad6c\ud604\ud558\uba74 \ub354 \ub9ce\uc740 \uc815\ubcf4\ub97c \ubc1b\uc544\uc62c \uc218 \uc788\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"client",children:"client"}),"\n",(0,t.jsx)(e.h3,{id:"indexhtml",children:"index.html"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<head>\r\n  <script\r\n    src="https://t1.kakaocdn.net/kakao_js_sdk/2.2.0/kakao.min.js"\r\n    integrity="sha384-x+WG2i7pOR+oWb6O5GV5f1KN2Ko6N7PTGPS7UlasYWNxZMKQA63Cj/B2lbUmUfuC"\r\n    crossorigin="anonymous"\r\n  ><\/script>\r\n  <script>\r\n    Kakao.init(""); // \uc0ac\uc6a9\ud558\ub824\ub294 \uc571\uc758 JavaScript \ud0a4 \uc785\ub825\r\n  <\/script>\r\n</head>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"loginpagets-rest-api-\uc0ac\uc6a9",children:"login.page.ts (REST API \uc0ac\uc6a9)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { CommonModule } from "@angular/common";\r\nimport { Component } from "@angular/core";\r\nimport { IconComponent } from "angular-libs";\r\n\r\ndeclare const Kakao: any; // \uce74\uce74\uc624 \uac1d\uccb4 \ubd88\ub7ec\uc624\uae30\r\n\r\n@Component({\r\n  selector: "app-login",\r\n  standalone: true,\r\n  imports: [CommonModule, IconComponent],\r\n  templateUrl: "./login.page.html",\r\n  styleUrls: ["./login.page.scss"],\r\n})\r\nexport class LoginPage {\r\n  constructor() {}\r\n  login() {\r\n    Kakao.Auth.authorize({\r\n      redirectUri: "http://localhost:3000/auth/kakao/callback",\r\n    });\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"loginpagets-javascript-sdk-\uc0ac\uc6a9",children:"login.page.ts (Javascript SDK \uc0ac\uc6a9)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'export class JoinPage implements OnInit {\r\n  JAVASCRIPT_API_KEY = "50284f7f25fb25ad3f69339c6c605149";\r\n\r\n  ngOnInit(): void {\r\n    Kakao.init(this.JAVASCRIPT_API_KEY);\r\n    console.log(Kakao.isInitialized());\r\n  }\r\n\r\n  KaKaoLoginAPI(): void {\r\n    Kakao.Auth.login({\r\n      success: () => {\r\n        Kakao.API.request({\r\n          url: "/v2/user/me",\r\n          success: (res: any) => {\r\n            console.log("\uc131\uacf5 : ", res);\r\n          },\r\n          fail: (err: any) => {\r\n            alert(`\uac1c\uc778\uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. ${JSON.stringify(err)}`);\r\n          },\r\n        });\r\n      },\r\n      fail: (err: any) => {\r\n        alert(`\ub3c4\uba54\uc778\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694. ${JSON.stringify(err)}`);\r\n      },\r\n    });\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"approutests",children:"app.routes.ts"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"{\r\n    path: '/auth/kakao/callback',\r\n    data: {\r\n    title: '\uce74\uce74\uc624 \ub85c\uadf8\uc778 \ucf5c\ubc31 URL',\r\n    },\r\n    loadComponent: () =>\r\n    import('./pages/login/kakao/callback.page').then((m) => m.CallbackPage),\r\n},\n"})}),"\n",(0,t.jsx)(e.h3,{id:"callbackpagets",children:"callback.page.ts"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"querystring\uc758 code\ub97c \ubc1b\uc544\uc11c \uc11c\ubc84\uc5d0 \uc694\uccad"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"async sendCode(){\r\n    const code = this.route.snapshot.queryParams.code;\r\n    if(!code) return;\r\n    const response = await lastValueFrom(this.httpService.post('http://localhost:4200/api/v1/user/oauth', {code}))\r\n    console.log(response);\r\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"server",children:"server"}),"\n",(0,t.jsx)(e.h2,{id:"axios-\uc124\uc815",children:"axios \uc124\uc815"}),"\n",(0,t.jsx)(e.h3,{id:"install",children:"install"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"npm i --save @nestjs/axios axios\n"})}),"\n",(0,t.jsx)(e.h3,{id:"module",children:"module"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { HttpModule } from "@nestjs/axios";\r\n\r\n@Module({\r\n  imports: [HttpModule],\r\n  providers: [UserService],\r\n})\r\nexport class UserModule {}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"useroauth",children:"user/oauth"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"  constructor(\r\n    private readonly userService: UserService,\r\n    private readonly httpService: HttpService\r\n  ) {}\r\n\r\n  @Get('oauth')\r\n  async oauth(@Query('code') code: string) {\r\n    if (!code || typeof code !== 'string')\r\n      throw new BadRequestException('code is required');\r\n\r\n    const url = 'https://kauth.kakao.com/oauth/token';\r\n\r\n    const data = {\r\n      grant_type: 'authorization_code',\r\n      client_id: '7ce0584576ca0egd07474f14933101b6072', // REST API KEY\r\n      redirect_uri: 'http://localhost:3000/auth/kakao/callback', // Redirect URI \ub611\uac19\uc774\r\n      code,\r\n    };\r\n\r\n    const headers = {\r\n      'Content-type': 'application/x-www-form-urlencoded;charset=utf-8',\r\n    };\r\n\r\n    const response = await lastValueFrom(\r\n      this.httpService.post(url, data, { headers })\r\n    );\r\n\r\n    const { access_token, token_type, refresh_token, expires_in, scope } =\r\n      response.data;\r\n\r\n    const userInfo = await lastValueFrom(\r\n      this.httpService.post('https://kapi.kakao.com/v2/user/me', data, {\r\n        headers: {\r\n          Authorization: `Bearer ${access_token}`,\r\n          'Content-type': 'application/x-www-form-urlencoded;charset=utf-8',\r\n        },\r\n      })\r\n    );\r\n\r\n    console.log(userInfo);\r\n\r\n    const user = this.userService.createOrLogin({\r\n      platform: 'kakao',\r\n      platformUserId: userInfo.data.id,\r\n    });\r\n\r\n    return user;\r\n  }\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\ub85c\uadf8\uc544\uc6c3",children:"\ub85c\uadf8\uc544\uc6c3"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:" kakaoLogout() {\r\n    Kakao.Auth.logout()\r\n      .then(function() {\r\n        alert('logout ok\\naccess token -> ' + Kakao.Auth.getAccessToken());\r\n        deleteCookie();\r\n      })\r\n      .catch(function() {\r\n        alert('Not logged in');\r\n      });\r\n    // \ucfe0\ud0a4\uc0ad\uc81c\r\n  }\n"})})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},529087:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>l});var a=r(596363);const t={},s=a.createContext(t);function o(n){const e=a.useContext(s);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),a.createElement(s.Provider,{value:e},n.children)}}}]);