"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["812317"],{484813:function(r,e,n){n.r(e),n.d(e,{frontMatter:()=>o,toc:()=>l,default:()=>d,metadata:()=>a,assets:()=>c,contentTitle:()=>i});var a=JSON.parse('{"id":"spring/Spring MVC + JPA","title":"SpringMVC + JPA","description":"- pom.xml \uC5D0 \uCD94\uAC00","source":"@site/docs/spring/Spring MVC + JPA.md","sourceDirName":"spring","slug":"/spring/Spring MVC + JPA","permalink":"/docs/spring/Spring MVC + JPA","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"spring-data","permalink":"/docs/spring/Spring Data"},"next":{"title":"Spring Reactor (\uC2A4\uD504\uB9C1 \uB9AC\uC561\uD130)","permalink":"/docs/spring/Spring Reactor"}}'),s=n(447259),t=n(255511);let o={},i="SpringMVC + JPA",c={},l=[];function p(r){let e={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",pre:"pre",ul:"ul",...(0,t.R)(),...r.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"springmvc--jpa",children:"SpringMVC + JPA"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"pom.xml \uC5D0 \uCD94\uAC00"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"\x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-orm --\x3e\r\n<dependency>\r\n    <groupId>org.springframework</groupId>\r\n    <artifactId>spring-orm</artifactId>\r\n    <version>${org.springframework-version}</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/org.apache.commons/commons-dbcp2 --\x3e\r\n<dependency>\r\n    <groupId>org.apache.commons</groupId>\r\n    <artifactId>commons-dbcp2</artifactId>\r\n    <version>2.9.0</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-entitymanager --\x3e\r\n<dependency>\r\n    <groupId>org.hibernate</groupId>\r\n    <artifactId>hibernate-entitymanager</artifactId>\r\n    <version>5.6.10.Final</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/com.oracle.database.jdbc/ojdbc8 --\x3e\r\n<dependency>\r\n    <groupId>com.oracle.database.jdbc</groupId>\r\n    <artifactId>ojdbc8</artifactId>\r\n    <version>21.6.0.0.1</version>\r\n</dependency>\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"servlet-context \uC5D0 \uCD94\uAC00"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<tx:annotation-driven/>\r\n\r\n<bean id="dataSource" class="org.apache.commons.dbcp2.BasicDataSource">\r\n    <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver"/>\r\n    <property name="url" value="jdbc:oracle:thin:@localhost:1521:xe"/>\r\n    <property name="username" value="USER1"/>\r\n    <property name="password" value="12341234"/>\r\n</bean>\r\n\r\n<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">\r\n    <property name="dataSource" ref="dataSource"/>\r\n</bean>\r\n\r\n\x3c!-- JPA \uC608\uC678\uB97C \uC2A4\uD504\uB9C1 \uC608\uC678\uB85C \uBCC0\uD658 --\x3e\r\n<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/>\r\n\r\n<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">\r\n    <property name="dataSource" ref="dataSource"/>\r\n    <property name="packagesToScan" value="com.sb.school.domain"/> \x3c!-- @Entity \uD0D0\uC0C9 \uC2DC\uC791 \uC704\uCE58 --\x3e\r\n    <property name="jpaVendorAdapter">\r\n        \x3c!-- \uD558\uC774\uBC84\uB124\uC774\uD2B8 \uAD6C\uD604\uCCB4 \uC0AC\uC6A9 --\x3e\r\n        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>\r\n    </property>\r\n    <property name="jpaProperties"> \x3c!-- \uD558\uC774\uBC84\uB124\uC774\uD2B8 \uC0C1\uC138 \uC124\uC815 --\x3e\r\n        <props>\r\n            <prop key="hibernate.dialect">org.hibernate.dialect.OracleDialect</prop> \x3c!-- \uBC29\uC5B8 --\x3e\r\n            <prop key="hibernate.show_sql">true</prop>                   \x3c!-- SQL \uBCF4\uAE30 --\x3e\r\n            <prop key="hibernate.format_sql">true</prop>                 \x3c!-- SQL \uC815\uB82C\uD574\uC11C \uBCF4\uAE30 --\x3e\r\n            <prop key="hibernate.use_sql_comments">true</prop>           \x3c!-- SQL \uCF54\uBA58\uD2B8 \uBCF4\uAE30 --\x3e\r\n            <prop key="hibernate.id.new_generator_mappings">true</prop>  \x3c!-- \uC0C8 \uBC84\uC804\uC758 ID \uC0DD\uC131 \uC635\uC158 --\x3e\r\n            <prop key="hibernate.hbm2ddl.auto">create</prop>             \x3c!-- DDL \uC790\uB3D9 \uC0DD\uC131 --\x3e\r\n        </props>\r\n    </property>\r\n</bean>\r\n\r\n<default-servlet-handler/>\r\n\r\n<interceptors>\r\n    <beans:bean class="org.springframework.orm.jpa.support.OpenEntityManagerInViewInterceptor">\r\n        <beans:property name="entityManagerFactory" ref="entityManagerFactory" />\r\n    </beans:bean>\r\n</interceptors>\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"domain (vo)"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'@Entity\r\n@Table(name = "TBL_USER")\r\npublic class User {\r\n    @Id\r\n    @Column(name = "USERNAME")\r\n	private String username;\r\n	private String password;\r\n	private String name;\r\n	private String role;\r\n	private String email;\r\n}\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"repository (dao)"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"@Repository\r\npublic class UserRepository {\r\n\r\n    @PersistenceContext\r\n    EntityManager em;\r\n\r\n    public void save(User user) {\r\n    	em.persist(user);\r\n    }\r\n\r\n    public User findById(String username) {\r\n    	return em.find(User.class, username);\r\n    }\r\n}\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"service"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"@Service\r\npublic class UserService {\r\n	@Autowired\r\n	private UserRepository userRepository;\r\n\r\n	@Transactional // transaction \uCC98\uB9AC \uC548\uD558\uBA74 \uC5D0\uB7EC\r\n    public String join(User user) {\r\n        userRepository.save(user);\r\n        return user.getUsername();\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(e.h1,{id:"jpql",children:"JPQL"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'	Query query1 = em.createQuery("select u from User u where u.username = :username", User.class);\r\n	query1.setParameter("username", "sb"); // \uC120\uD0DD\uC774 \uC544\uB2CC \uD544\uC218\r\n	System.out.println("result1 : " + query1.getSingleResult());\r\n\r\n//	Query query2 = em.createQuery("select u from User u", User.class);\r\n//	System.out.println("result2 : " + query2.getResultList());\n'})}),"\n",(0,s.jsx)(e.h1,{id:"querydsl",children:"QueryDSL"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"pom.xml"}),"\n"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"dependency \uCD94\uAC00"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"\x3c!-- https://mvnrepository.com/artifact/com.querydsl/querydsl-jpa --\x3e\r\n<dependency>\r\n    <groupId>com.querydsl</groupId>\r\n    <artifactId>querydsl-jpa</artifactId>\r\n    <version>5.0.0</version>\r\n</dependency>\r\n\r\n\x3c!-- https://mvnrepository.com/artifact/com.querydsl/querydsl-apt --\x3e\r\n<dependency>\r\n    <groupId>com.querydsl</groupId>\r\n    <artifactId>querydsl-apt</artifactId>\r\n    <version>5.0.0</version>\r\n</dependency>\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"plugin \uCD94\uAC00"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"<plugin>\r\n    <groupId>com.mysema.maven</groupId>\r\n    <artifactId>apt-maven-plugin</artifactId>\r\n    <version>1.1.3</version>\r\n    <executions>\r\n        <execution>\r\n            <goals>\r\n                <goal>process</goal>\r\n            </goals>\r\n            <configuration>\r\n                <outputDirectory>target/generated-sources/java</outputDirectory>\r\n                <processor>com.querydsl.apt.jpa.JPAAnnotationProcessor</processor>\r\n            </configuration>\r\n        </execution>\r\n    </executions>\r\n</plugin>\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"build.gradle"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-groovy",children:'buildscript { // \uB9E8\uC704\uC5D0 \uC704\uCE58\r\n    dependencies {\r\n        classpath("gradle.plugin.com.ewerk.gradle.plugins:querydsl-plugin:1.0.10")\r\n    }\r\n}\r\n\r\napply plugin: "com.ewerk.gradle.plugins.querydsl"\r\n\r\ndependencies {\r\n    //querydsl \uCD94\uAC00\r\n    implementation \'com.querydsl:querydsl-jpa\'\r\n    //querydsl \uCD94\uAC00\r\n    implementation \'com.querydsl:querydsl-apt\'\r\n}\r\n\r\ndef querydslDir = "$buildDir/generated/querydsl"\r\n\r\nquerydsl {\r\n    library = "com.querydsl:querydsl-apt"\r\n    jpa = true\r\n    querydslSourcesDir = querydslDir\r\n}\r\n\r\nsourceSets {\r\n    main {\r\n        java {\r\n            srcDirs = [\'src/main/java\', querydslDir]\r\n        }\r\n    }\r\n}\r\n\r\ncompileQuerydsl{\r\n    options.annotationProcessorPath = configurations.querydsl\r\n}\r\n\r\nconfigurations {\r\n    querydsl.extendsFrom compileClasspath\r\n}\n'})}),"\n",(0,s.jsxs)(e.ol,{start:"2",children:["\n",(0,s.jsx)(e.li,{children:"\uAE30\uBCF8 \uBB38\uBC95"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'//	JPAQuery<EntityManager> query = new JPAQuery<>(em);\r\n    JPAQueryFactory queryFactory = new JPAQueryFactory(em);\r\n\r\n//	QUser user = new QUser("u");\r\n	QUser user = QUser.user;\r\n\r\n	User foundUser = (User) queryFactory\r\n//				  .selectFrom(qUser) // select + from\r\n				  .from(user)\r\n				  .where(user.username.eq("sb"))\r\n				  .orderBy(user.username.desc())\r\n				  .fetchOne();\r\n\r\n	System.out.println("result : " + foundUser);\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"java config (QueryDSL-JPAQueryFactory)"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"@PersistenceContext\r\nprivate EntityManager entityManager;\r\n\r\n@Bean\r\npublic JPAQueryFactory jpaQueryFactory() {\r\n    return new JPAQueryFactory(entityManager);\r\n}\n"})})]})}function d(r={}){let{wrapper:e}={...(0,t.R)(),...r.components};return e?(0,s.jsx)(e,{...r,children:(0,s.jsx)(p,{...r})}):p(r)}},255511:function(r,e,n){n.d(e,{R:()=>o,x:()=>i});var a=n(596363);let s={},t=a.createContext(s);function o(r){let e=a.useContext(t);return a.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function i(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(s):r.components||s:o(r.components),a.createElement(t.Provider,{value:e},r.children)}}}]);