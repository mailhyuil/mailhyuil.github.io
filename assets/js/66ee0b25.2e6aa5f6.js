"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["647577"],{457776:function(e,n,l){l.r(n),l.d(n,{frontMatter:()=>i,toc:()=>t,default:()=>k,metadata:()=>r,assets:()=>s,contentTitle:()=>a});var r=JSON.parse('{"id":"cloud/keycloak","title":"keycloak","description":"SSO \uAD6C\uD604\uC744 \uC704\uD55C API","source":"@site/docs/cloud/keycloak.md","sourceDirName":"cloud","slug":"/cloud/keycloak","permalink":"/docs/cloud/keycloak","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"jsdelivr cdn","permalink":"/docs/cloud/jsdelivr cdn"},"next":{"title":"ngrok","permalink":"/docs/cloud/ngrok"}}'),o=l(447259),c=l(255511);let i={},a="keycloak",s={},t=[{value:"docker-keycloak",id:"docker-keycloak",level:2},{value:"keycloak console",id:"keycloak-console",level:2},{value:"dependency",id:"dependency",level:2},{value:"application.properties",id:"applicationproperties",level:2},{value:"keycloak config in application.properties resolving",id:"keycloak-config-in-applicationproperties-resolving",level:2},{value:"logout",id:"logout",level:2},{value:"SPI (Service Provider Interface)",id:"spi-service-provider-interface",level:2},{value:"DB \uC5F0\uB3D9",id:"db-\uC5F0\uB3D9",level:3}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"keycloak",children:"keycloak"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"SSO \uAD6C\uD604\uC744 \uC704\uD55C API"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"docker-keycloak",children:"docker-keycloak"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"pull & run"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker run --name keycloak -d -p 8080:8080 -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin jboss/keycloak:latest\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:"addUser"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker exec keycloak /opt/jboss/keycloak/bin/add-user-keycloak.sh -u <USERNAME> -p <PASSWORD>\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsx)(n.li,{children:"restart"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker restart keycloak\n"})}),"\n",(0,o.jsx)(n.h2,{id:"keycloak-console",children:"keycloak console"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"realm \uC0DD\uC131"}),"\n",(0,o.jsx)(n.li,{children:"clients \uC0DD\uC131 -> Valid Redirect = \uC2A4\uD504\uB9C1\uBD80\uD2B8url/*"}),"\n",(0,o.jsx)(n.li,{children:"roles -> role \uC0DD\uC131 (e.g. user)"}),"\n",(0,o.jsx)(n.li,{children:"Manage Users -> user\uC0DD\uC131 -> Role Mappings\uC5D0\uC11C role \uCD94\uAC00"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"dependency",children:"dependency"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:"<dependency>\r\n	<groupId>org.keycloak</groupId>\r\n	<artifactId>keycloak-spring-boot-starter</artifactId>\r\n	<version>16.1.1</version>\r\n</dependency>\n"})}),"\n",(0,o.jsx)(n.h2,{id:"applicationproperties",children:"application.properties"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"keycloak.auth-server-url=http://localhost:8080/auth\r\nkeycloak.realm=springboot-test\r\nkeycloak.resource=login-app\r\nkeycloak.public-client=true\r\nkeycloak.security-constraints[0].authRoles[0]=user\r\nkeycloak.security-constraints[0].securityCollections[0].patterns[0]=/main/*\r\nkeycloak.principal-attribute=preferred_username\n"})}),"\n",(0,o.jsx)(n.h2,{id:"keycloak-config-in-applicationproperties-resolving",children:"keycloak config in application.properties resolving"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:"@Configuration\r\npublic class KeycloakConfig {\r\n	@Bean\r\n	public KeycloakConfigResolver KeycloakConfigResolver() {\r\n		return new KeycloakSpringBootConfigResolver();\r\n	}\r\n\r\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"logout",children:"logout"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",children:'<a href="http://localhost:8080/auth/realms/springboot-test/protocol/openid-connect/logout?redirect_uri=http://localhost:8081/">logout</a>\n'})}),"\n",(0,o.jsx)(n.h2,{id:"spi-service-provider-interface",children:"SPI (Service Provider Interface)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:"<dependency>\r\n    <groupId>org.keycloak</groupId>\r\n    <artifactId>keycloak-server-spi</artifactId>\r\n    <version>16.1.1</version>\r\n</dependency>\n"})}),"\n",(0,o.jsx)(n.h3,{id:"db-\uC5F0\uB3D9",children:"DB \uC5F0\uB3D9"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker run --name db-keycloak -p 8080:8080 -e DB_VENDOR=mssql -e DB_USER=tia -e DB_PASSWORD=kkk123#### -e DB_ADDR=activeblackbox.co.kr -e DB_PORT=21433 -e DB_DATABASE=PANTOS -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin jboss/keycloak\n"})})]})}function k(e={}){let{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},255511:function(e,n,l){l.d(n,{R:()=>i,x:()=>a});var r=l(596363);let o={},c=r.createContext(o);function i(e){let n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);