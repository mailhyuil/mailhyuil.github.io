"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["110684"],{670803:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>a,toc:()=>c,default:()=>u,metadata:()=>r,assets:()=>l,contentTitle:()=>i});var r=JSON.parse('{"id":"nodejs/nodejs race condition example","title":"nodejs race condition example","description":"nodejs\uB294 \uC790\uBC14\uC2A4\uD06C\uB9BD\uD2B8(cpu)\uB97C \uC2F1\uAE00 \uC2A4\uB808\uB4DC\uC5D0\uC11C \uB3CC\uB9AC\uAE30 \uB54C\uBB38\uC5D0 \uC5F0\uC0B0\uC73C\uB85C \uC778\uD55C race condition \uBC84\uADF8\uB294 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uB294\uB2E4.","source":"@site/docs/nodejs/nodejs race condition example.md","sourceDirName":"nodejs","slug":"/nodejs/nodejs race condition example","permalink":"/docs/nodejs/nodejs race condition example","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nodejs profiling","permalink":"/docs/nodejs/nodejs profiling"},"next":{"title":"nodejs Mutex & Semaphore","permalink":"/docs/nodejs/nodejs race condition mutex & semaphore"}}'),s=t(447259),o=t(255511);let a={},i="nodejs race condition example",l={},c=[{value:"problem",id:"problem",level:2},{value:"solution1",id:"solution1",level:2},{value:"solution2",id:"solution2",level:2},{value:"install",id:"install",level:3}];function d(n){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"nodejs-race-condition-example",children:"nodejs race condition example"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"nodejs\uB294 \uC790\uBC14\uC2A4\uD06C\uB9BD\uD2B8(cpu)\uB97C \uC2F1\uAE00 \uC2A4\uB808\uB4DC\uC5D0\uC11C \uB3CC\uB9AC\uAE30 \uB54C\uBB38\uC5D0 \uC5F0\uC0B0\uC73C\uB85C \uC778\uD55C race condition \uBC84\uADF8\uB294 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uB294\uB2E4."}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"\uD558\uC9C0\uB9CC \uBE44\uB3D9\uAE30 task(I/O)\uB97C \uBC31\uADF8\uB77C\uC6B4\uB4DC \uBA40\uD2F0 \uC2A4\uB808\uB4DC\uC5D0\uC11C \uB3CC\uB9AC\uAE30 \uB54C\uBB38\uC5D0 \uC21C\uC11C\uB85C \uC778\uD55C race condition \uBC84\uADF8\uAC00 \uBC1C\uC0DD\uD560 \uC218 \uC788\uB2E4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"problem",children:"problem"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'async function task1() {\r\n  console.log("task1 start");\r\n  await delay(1500);\r\n  console.log("task1 end");\r\n}\r\n\r\nasync function task2() {\r\n  console.log("task2 start");\r\n  await delay(1000);\r\n  console.log("task2 end");\r\n}\r\n\r\nfunction delay(ms: number) {\r\n  return new Promise<void>((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nasync function main() {\r\n  const temp1 = task1();\r\n  const temp2 = task2();\r\n  await temp1;\r\n  await temp2;\r\n}\r\nmain();\r\n\r\n// task1 start\r\n// task2 start\r\n// task2 end\r\n// task1 end\n'})}),"\n",(0,s.jsx)(e.h2,{id:"solution1",children:"solution1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:"async function main() {\r\n  await task1();\r\n  await task2();\r\n}\r\n// task1 start\r\n// task1 end\r\n// task2 start\r\n// task2 end\n"})}),"\n",(0,s.jsx)(e.h2,{id:"solution2",children:"solution2"}),"\n",(0,s.jsx)(e.h3,{id:"install",children:"install"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:"npm i async-mutex\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'import { Mutex } from "async-mutex";\r\n\r\nconst mutex = new Mutex();\r\n\r\nasync function task1() {\r\n  const release = await mutex.acquire();\r\n  try {\r\n    console.log("task1 start");\r\n    await delay(1500);\r\n    console.log("task1 end");\r\n  } finally {\r\n    release();\r\n  }\r\n}\r\n\r\nasync function task2() {\r\n  const release = await mutex.acquire();\r\n  try {\r\n    console.log("task2 start");\r\n    await delay(1000);\r\n    console.log("task2 end");\r\n  } finally {\r\n    release();\r\n  }\r\n}\r\n\r\nfunction delay(ms: number) {\r\n  return new Promise<void>((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nasync function main() {\r\n  const temp1 = task1();\r\n  const temp2 = task2();\r\n  await temp1;\r\n  await temp2;\r\n}\r\nmain();\r\n// task1 start\r\n// task1 end\r\n// task2 start\r\n// task2 end\n'})})]})}function u(n={}){let{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},255511:function(n,e,t){t.d(e,{R:()=>a,x:()=>i});var r=t(596363);let s={},o=r.createContext(s);function a(n){let e=r.useContext(o);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),r.createElement(o.Provider,{value:e},n.children)}}}]);