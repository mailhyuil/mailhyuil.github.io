"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[139880],{529087:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>t});var o=s(596363);const a={},r=o.createContext(a);function i(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),o.createElement(r.Provider,{value:e},n.children)}},947805:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"go/go nodejs wasm","title":"go nodejs wasm","description":"wasm\uc740 \uac00\uc0c1\uba38\uc2e0\uc6a9 \ubc14\uc774\ud2b8 \ucf54\ub4dc, \ube0c\ub77c\uc6b0\uc800 \ub610\ub294 \ub3c5\ub9bd \ub7f0\ud0c0\uc784 \ud658\uacbd\uc5d0\uc11c \uc2e4\ud589\ud55c\ub2e4.","source":"@site/docs/go/go nodejs wasm.md","sourceDirName":"go","slug":"/go/go nodejs wasm","permalink":"/docs/go/go nodejs wasm","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"go nodejs ffi (Foreign Function Interface)","permalink":"/docs/go/go nodejs ffi"},"next":{"title":"go package CompileDaemon","permalink":"/docs/go/go package CompileDaemon"}}');var a=s(447259),r=s(529087);const i={},t="go nodejs wasm",d={},l=[{value:"main.go",id:"maingo",level:2},{value:"build",id:"build",level:2},{value:"install in nodejs",id:"install-in-nodejs",level:2},{value:"main.js",id:"mainjs",level:2}];function c(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"go-nodejs-wasm",children:"go nodejs wasm"})}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"wasm\uc740 \uac00\uc0c1\uba38\uc2e0\uc6a9 \ubc14\uc774\ud2b8 \ucf54\ub4dc, \ube0c\ub77c\uc6b0\uc800 \ub610\ub294 \ub3c5\ub9bd \ub7f0\ud0c0\uc784 \ud658\uacbd\uc5d0\uc11c \uc2e4\ud589\ud55c\ub2e4."}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"\uc800\uc218\uc900\uc758 \ubc14\uc774\ub108\ub9ac & \ubc14\uc774\ud2b8 \ucf54\ub4dc\uc774\uae30 \ub54c\ubb38\uc5d0 \ube60\ub974\uac8c Native Code\ub85c \ubcc0\ud658\ud560 \uc218 \uc788\uace0"}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"\uad6c\uc870\uc801\uc73c\ub85c \ub2e8\uc21c, \ud0c0\uc785\uc774 \uc815\uc801, \uba85\ud655\ud558\uae30 \ub54c\ubb38\uc5d0 JIT, AOT \ucef4\ud30c\uc77c\ub7ec\uac00 \ucd5c\uc801\ud654\ud558\uae30 \ub9e4\uc6b0 \uc6a9\uc774\ud558\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"maingo",children:"main.go"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-go",children:"package main\r\n\r\n//export add\r\nfunc add(a, b int32) int32 {\r\n\treturn a + b\r\n}\r\n\r\nfunc main() {}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"build",children:"build"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"# nodejs \uc6a9\r\nGOOS=wasip1 GOARCH=wasm tinygo build -o add.wasm main.go\r\n# browser \uc6a9\r\nGOOS=js GOARCH=wasm tinygo build -o add.wasm main.go\r\n# add.wasm \uc0dd\uc131\ub428\r\n# nodejs \ud504\ub85c\uc81d\ud2b8\ub85c \ubcf5\uc0ac\n"})}),"\n",(0,a.jsx)(e.h2,{id:"install-in-nodejs",children:"install in nodejs"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"npm i wasi # node 20 \uc774\uc0c1\ubd80\ud130\ub294 \uae30\ubcf8 \ub0b4\uc7a5\ub428\n"})}),"\n",(0,a.jsx)(e.h2,{id:"mainjs",children:"main.js"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:'const fs = require("fs");\r\nconst { WASI } = require("wasi");\r\nconst path = require("path");\r\n\r\nconst wasi = new WASI({\r\n  version: "preview1",\r\n});\r\nconst importObject = { wasi_snapshot_preview1: wasi.wasiImport };\r\n\r\nconst wasmBuffer = fs.readFileSync(path.resolve(__dirname, "add.wasm"));\r\n\r\n(async () => {\r\n  const wasmModule = await WebAssembly.compile(wasmBuffer);\r\n  const instance = await WebAssembly.instantiate(wasmModule, importObject);\r\n  wasi.start(instance);\r\n\r\n  const result = instance.exports.add(5, 7);\r\n  console.log("Result:", result); // \ud83d\udc49 12\r\n})();\n'})})]})}function m(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(c,{...n})}):c(n)}}}]);