"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[914796],{446589:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"aws/aws Lambda SAM","title":"aws Lambda SAM (Serverless Application Model)","description":"AWS Lambda \ud568\uc218\uc640 \uad00\ub828 \ub9ac\uc18c\uc2a4\ub97c \uc815\uc758\ud558\uace0 \ubc30\ud3ec\ud558\uae30 \uc704\ud55c \uc624\ud508 \uc18c\uc2a4 \ud504\ub808\uc784\uc6cc\ud06c","source":"@site/docs/aws/aws Lambda SAM.md","sourceDirName":"aws","slug":"/aws/aws Lambda SAM","permalink":"/docs/aws/aws Lambda SAM","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"aws S3 Object Lambda","permalink":"/docs/aws/aws Lambda S3 Object Lambda"},"next":{"title":"Lambda layer","permalink":"/docs/aws/aws Lambda layer"}}');var s=r(447259),t=r(529087);const l={},o="aws Lambda SAM (Serverless Application Model)",i={},c=[{value:"cli",id:"cli",level:2},{value:"template.yaml",id:"templateyaml",level:2},{value:"samconfig.toml",id:"samconfigtoml",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"aws-lambda-sam-serverless-application-model",children:"aws Lambda SAM (Serverless Application Model)"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"AWS Lambda \ud568\uc218\uc640 \uad00\ub828 \ub9ac\uc18c\uc2a4\ub97c \uc815\uc758\ud558\uace0 \ubc30\ud3ec\ud558\uae30 \uc704\ud55c \uc624\ud508 \uc18c\uc2a4 \ud504\ub808\uc784\uc6cc\ud06c"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"SAM\uc740 \ub0b4\ubd80\uc801\uc73c\ub85c CloudFormation\uc744 \uc0ac\uc6a9\ud574\uc11c \uc2e4\uc81c \ubc30\ud3ec\ub97c \uc218\ud589"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"cli",children:"cli"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sam init # SAM \ud504\ub85c\uc81d\ud2b8 \ucd08\uae30\ud654\r\nsam build # \ube4c\ub4dc (\ucf54\ub4dc \ubcc0\uacbd \uc2dc \ubc18\ub4dc\uc2dc \uc218\ud589)\r\nsam deploy --guided # \ubc30\ud3ec (\ucd5c\ucd08 \ubc30\ud3ec \uc2dc --guided \uc635\uc158 \uc0ac\uc6a9)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"templateyaml",children:"template.yaml"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'AWSTemplateFormatVersion: "2010-09-09"\r\nTransform: AWS::Serverless-2016-10-31\r\nDescription: Schedule App with EventBridge\r\n\r\nGlobals:\r\n  Function:\r\n    Timeout: 30\r\n    Runtime: nodejs22.x\r\n    Architectures:\r\n      - x86_64\r\n    Environment:\r\n      Variables:\r\n        DATABASE_URL: !Ref DatabaseUrl\r\n\r\nResources:\r\n  # Prisma Layer\r\n  PrismaLayer:\r\n    Type: AWS::Serverless::LayerVersion\r\n    Properties:\r\n      LayerName: prisma-client\r\n      Description: Prisma Client Layer\r\n      ContentUri: prisma-layer/\r\n      CompatibleRuntimes:\r\n        - nodejs22.x\r\n      RetentionPolicy: Delete\r\n\r\n  # Lambda \ud568\uc218 1: Open Class\r\n  OpenClassFunction:\r\n    Type: AWS::Serverless::Function\r\n    Properties:\r\n      FunctionName: open-class\r\n      CodeUri: open-class/\r\n      Handler: app.lambdaHandler\r\n      Description: Open a class when scheduled\r\n      Layers:\r\n        - !Ref PrismaLayer\r\n    Metadata:\r\n      BuildMethod: esbuild\r\n      BuildProperties:\r\n        Minify: true\r\n        Target: es2020\r\n        Sourcemap: true\r\n        EntryPoints:\r\n          - app.ts\r\n        External:\r\n          - ".prisma/client"\r\n\r\n  # Lambda \ud568\uc218 2: Close Class\r\n  CloseClassFunction:\r\n    Type: AWS::Serverless::Function\r\n    Properties:\r\n      FunctionName: close-class\r\n      CodeUri: close-class/\r\n      Handler: app.lambdaHandler\r\n      Description: Close a class when scheduled\r\n      Layers:\r\n        - !Ref PrismaLayer\r\n    Metadata:\r\n      BuildMethod: esbuild\r\n      BuildProperties:\r\n        Minify: true\r\n        Target: es2020\r\n        Sourcemap: true\r\n        EntryPoints:\r\n          - app.ts\r\n        External:\r\n          - ".prisma/client"\r\n\r\n  # EventBridge Scheduler \uc2e4\ud589 \uc5ed\ud560 (\ub450 Lambda \ubaa8\ub450 \ud3ec\ud568)\r\n  SchedulerExecutionRole:\r\n    Type: AWS::IAM::Role\r\n    Properties:\r\n      AssumeRolePolicyDocument:\r\n        Version: "2012-10-17"\r\n        Statement:\r\n          - Effect: Allow\r\n            Principal:\r\n              Service: scheduler.amazonaws.com\r\n            Action: sts:AssumeRole\r\n      Policies:\r\n        - PolicyName: InvokeLambdaFunctions\r\n          PolicyDocument:\r\n            Version: "2012-10-17"\r\n            Statement:\r\n              - Effect: Allow\r\n                Action: lambda:InvokeFunction\r\n                Resource:\r\n                  - !GetAtt OpenClassFunction.Arn\r\n                  - !GetAtt CloseClassFunction.Arn\r\n\r\nParameters:\r\n  DatabaseUrl:\r\n    Type: String\r\n    Description: Database connection URL\r\n    NoEcho: true\r\n\r\nOutputs:\r\n  OpenClassFunctionArn:\r\n    Description: Lambda Function ARN for EventBridge (Open)\r\n    Value: !GetAtt OpenClassFunction.Arn\r\n    Export:\r\n      Name: !Sub "${AWS::StackName}-OpenClassFunctionArn"\r\n\r\n  CloseClassFunctionArn:\r\n    Description: Lambda Function ARN for EventBridge (Close)\r\n    Value: !GetAtt CloseClassFunction.Arn\r\n    Export:\r\n      Name: !Sub "${AWS::StackName}-CloseClassFunctionArn"\r\n\r\n  SchedulerRoleArn:\r\n    Description: IAM Role ARN for EventBridge Scheduler\r\n    Value: !GetAtt SchedulerExecutionRole.Arn\r\n    Export:\r\n      Name: !Sub "${AWS::StackName}-SchedulerRoleArn"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"samconfigtoml",children:"samconfig.toml"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"sam cli \uba85\ub839\uc5b4\uc758 \uae30\ubcf8 \uc635\uc158 \uc124\uc815 \ud30c\uc77c"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'# More information about the configuration file can be found here:\r\n# https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-config.html\r\nversion = 0.1\r\n\r\n[default.global.parameters]\r\nstack_name = "schedule-app"\r\n\r\n[default.build.parameters]\r\ncached = true\r\nparallel = true\r\n\r\n[default.validate.parameters]\r\nlint = true\r\n\r\n[default.deploy.parameters]\r\ncapabilities = "CAPABILITY_IAM"\r\nconfirm_changeset = true\r\nresolve_s3 = true\r\nstack_name = "class-scheduler"\r\ns3_prefix = "class-scheduler"\r\nregion = "ap-northeast-2"\r\ndisable_rollback = true\r\nimage_repositories = []\r\n\r\n[default.package.parameters]\r\nresolve_s3 = true\r\n\r\n[default.sync.parameters]\r\nwatch = true\r\n\r\n[default.local_start_api.parameters]\r\nwarm_containers = "EAGER"\r\n\r\n[default.local_start_lambda.parameters]\r\nwarm_containers = "EAGER"\n'})})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},529087:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var a=r(596363);const s={},t=a.createContext(s);function l(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);