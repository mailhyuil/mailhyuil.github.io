"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[635251],{307195:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"nestjs/nest email @react-email","title":"nest email @react-email","description":"install","source":"@site/docs/nestjs/nest email @react-email.md","sourceDirName":"nestjs","slug":"/nestjs/nest email @react-email","permalink":"/docs/nestjs/nest email @react-email","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nest dotenv","permalink":"/docs/nestjs/nest dotenv"},"next":{"title":"nest mailer nestmailer","permalink":"/docs/nestjs/nest email nestmailer"}}');var s=r(447259),a=r(529087);const i={},l="nest email @react-email",o={},c=[{value:"install",id:"install",level:2},{value:"tsconfig.json",id:"tsconfigjson",level:2},{value:"email.template.tsx",id:"emailtemplatetsx",level:2},{value:"email.service.ts",id:"emailservicets",level:2}];function m(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"nest-email-react-email",children:"nest email @react-email"})}),"\n",(0,s.jsx)(n.h2,{id:"install",children:"install"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"npm i -D @types/react\r\nnpm i react-email\r\nnpm i @react-email/components\n"})}),"\n",(0,s.jsx)(n.h2,{id:"tsconfigjson",children:"tsconfig.json"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'  "compilerOptions": {\r\n    "jsx": "react-jsx"\r\n  },\n'})}),"\n",(0,s.jsx)(n.h2,{id:"emailtemplatetsx",children:"email.template.tsx"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import {\r\n  Body,\r\n  Container,\r\n  Head,\r\n  Heading,\r\n  Hr,\r\n  Html,\r\n  Preview,\r\n  Section,\r\n  Tailwind,\r\n  Text,\r\n  Link,\r\n} from "@react-email/components";\r\nimport * as React from "react";\r\n\r\nexport const EmailAuthEmail = ({ password }): React.ReactElement => {\r\n  return (\r\n    <Html lang="ko">\r\n      <Head />\r\n      <Preview>\uc774\uba54\uc77c \uc778\uc99d \uc548\ub0b4</Preview>\r\n      <Tailwind>\r\n        <Body className="mx-auto my-auto font-sans bg-white text-neutral-900">\r\n          <Container>\r\n            <Hr />\r\n            <Heading> \uc774\uba54\uc77c \uc778\uc99d \uc548\ub0b4</Heading>\r\n            <Text>\uc548\ub155\ud558\uc138\uc694. oooo\uc785\ub2c8\ub2e4.</Text>\r\n            <Text>\uc774\uba54\uc77c \uc778\uc99d\uc744 \uc704\ud574 \uc544\ub798 \ub9c1\ud06c\ub97c \ud074\ub9ad\ud574\uc8fc\uc138\uc694</Text>\r\n            <Hr />\r\n            <Section className="bg-neutral-100">\r\n              <Link className="text-xl font-extrabold text-center" href={url}>\r\n                \uc778\uc99d\ud558\uae30\r\n              </Link>\r\n            </Section>\r\n          </Container>\r\n        </Body>\r\n      </Tailwind>\r\n    </Html>\r\n  );\r\n};\n'})}),"\n",(0,s.jsx)(n.h2,{id:"emailservicets",children:"email.service.ts"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { HttpService } from "@nestjs/axios";\r\nimport { EmailAuthEmail } from "./email-auth.template";\r\nimport { Injectable, Logger } from "@nestjs/common";\r\nimport { render } from "@react-email/render";\r\n\r\n@Injectable()\r\nexport class EmailService {\r\n  logger = new Logger(EmailService.name);\r\n  constructor(private readonly httpService: HttpService) {}\r\n  async sendEmail({ email, password }: { email: string; password: string }) {\r\n    this.logger.log(`Send email with password ${password}`);\r\n    const endpoint = process.env["NHN_CLOUD_EMAIL_ENDPOINT"];\r\n    const appKey = process.env["NHN_CLOUD_EMAIL_APP_KEY"];\r\n    const secretKey = process.env["NHN_CLOUD_EMAIL_SECRET_KEY"];\r\n    const baseUrl = `${endpoint}/appKeys/${appKey}`;\r\n    const headers = {\r\n      "Content-Type": "application/json;charset=UTF-8",\r\n      "X-Secret-Key": secretKey,\r\n    };\r\n\r\n    const data = {\r\n      senderAddress: "help@lepisode.team",\r\n      receiverList: [{ receiveMailAddr: email, receiveType: "MRT0" }],\r\n      title: `\uc0ac\uc774\ub2c8\uc9c0 \ud1b5\ud569 \uad00\ub9ac \uc2dc\uc2a4\ud15c \uc774\uba54\uc77c \uc778\uc99d \uc548\ub0b4`,\r\n      body: render(EmailAuthEmail({ password })),\r\n    };\r\n\r\n    return new Promise<void>((resolve, reject) => {\r\n      this.httpService\r\n        .post(`${baseUrl}/sender/mail`, data, {\r\n          headers,\r\n        })\r\n        .subscribe({\r\n          next: res => {\r\n            if (res.data.header.isSuccessful) {\r\n              console.log(`\u2705 \uc778\uc99d\uc6a9 \uc774\uba54\uc77c \ubc1c\uc1a1\uc5d0 \uc131\uacf5\ud588\uc2b5\ub2c8\ub2e4.`);\r\n              resolve();\r\n            } else {\r\n              console.error(`\u26d4\ufe0f \uc778\uc99d\uc6a9 \uc774\uba54\uc77c \ubc1c\uc1a1\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.`, res.data.header.resultMessage);\r\n              reject(res.data.header.resultMessage);\r\n            }\r\n          },\r\n        });\r\n    });\r\n  }\r\n}\n'})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},529087:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var t=r(596363);const s={},a=t.createContext(s);function i(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);