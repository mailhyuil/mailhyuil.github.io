"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([["69142"],{71602:function(n,e,r){r.r(e),r.d(e,{frontMatter:()=>s,toc:()=>a,default:()=>d,metadata:()=>t,assets:()=>c,contentTitle:()=>l});var t=JSON.parse('{"id":"logging & monitoring & profiling & tracing/sentry nestjs","title":"nest sentry","description":"\uC5D0\uB7EC \uB85C\uADF8\uB97C slack\uC73C\uB85C \uC804\uC1A1\uD558\uB294 \uBC29\uBC95","source":"@site/docs/logging & monitoring & profiling & tracing/sentry nestjs.md","sourceDirName":"logging & monitoring & profiling & tracing","slug":"/logging & monitoring & profiling & tracing/sentry nestjs","permalink":"/docs/logging & monitoring & profiling & tracing/sentry nestjs","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"sentry integration","permalink":"/docs/logging & monitoring & profiling & tracing/sentry integration"},"next":{"title":"sentry","permalink":"/docs/logging & monitoring & profiling & tracing/sentry"}}'),o=r(447259),i=r(255511);let s={},l="nest sentry",c={},a=[{value:"install",id:"install",level:2},{value:"main.ts",id:"maints",level:2},{value:"error interceptor",id:"error-interceptor",level:2}];function p(n){let e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"nest-sentry",children:"nest sentry"})}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\uC5D0\uB7EC \uB85C\uADF8\uB97C slack\uC73C\uB85C \uC804\uC1A1\uD558\uB294 \uBC29\uBC95"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"install",children:"install"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sh",children:"npm i @sentry/node\r\n# npm i nest-raven\r\nnpm i @slack/client\n"})}),"\n",(0,o.jsx)(e.h2,{id:"maints",children:"main.ts"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:'import { NestFactory } from "@nestjs/core";\r\nimport { AppModule } from "./app.module";\r\nimport * as Sentry from "@sentry/node";\r\nimport { WebhookInterceptor } from "./common/webhook.interceptor";\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create(AppModule);\r\n  // sentry init\r\n  Sentry.init({\r\n    dsn: process.env.SENTRY_DSN,\r\n  });\r\n  await app.listen(3000);\r\n}\r\nbootstrap();\n'})}),"\n",(0,o.jsx)(e.h2,{id:"error-interceptor",children:"error interceptor"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"Sentry.captureException(error)\uB97C \uD1B5\uD574 \uC5D0\uB7EC\uB97C sentry\uB85C \uC804\uC1A1"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:'import { ExecutionContext, Injectable, NestInterceptor, CallHandler } from "@nestjs/common";\r\nimport { Observable } from "rxjs";\r\nimport { catchError } from "rxjs/operators";\r\nimport * as Sentry from "@sentry/minimal";\r\n\r\n@Injectable()\r\nexport class SentryInterceptor implements NestInterceptor {\r\n  intercept(_: ExecutionContext, next: CallHandler): Observable<any> {\r\n    return next.handle().pipe(\r\n      catchError(error => {\r\n        Sentry.captureException(error);\r\n        return null;\r\n      }),\r\n    );\r\n  }\r\n}\n'})})]})}function d(n={}){let{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(p,{...n})}):p(n)}},255511:function(n,e,r){r.d(e,{R:()=>s,x:()=>l});var t=r(596363);let o={},i=t.createContext(o);function s(n){let e=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);